if("undefined"==typeof g_all_modules)g_all_modules={};g_all_modules["SP.UI.MicroFeed.js"]={version:{rmj:16,rmm:0,rup:7723,rpr:1204}};typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkBegin_SP.UI.MicroFeed.js");Type.registerNamespace("SP.UI.MicroFeed");SP.UI.MicroFeed.HandlingMode=function(){};SP.UI.MicroFeed.HandlingMode.prototype={notHandling:0,handlingMention:1,handlingTag:2,handlingLink:3};SP.UI.MicroFeed.HandlingMode.registerEnum("SP.UI.MicroFeed.HandlingMode",false);SP.UI.MicroFeed.TextBoxElementType=function(){};SP.UI.MicroFeed.TextBoxElementType.prototype={mention:0,tag:1,link:2};SP.UI.MicroFeed.TextBoxElementType.registerEnum("SP.UI.MicroFeed.TextBoxElementType",false);SP.UI.MicroFeed.WebPartFeedType=function(){};SP.UI.MicroFeed.WebPartFeedType.prototype={publishedFeed:0,whatsNew:1,siteFeed:2};SP.UI.MicroFeed.WebPartFeedType.registerEnum("SP.UI.MicroFeed.WebPartFeedType",false);SP.UI.MicroFeed.keyCode=function(){};SP.UI.MicroFeed.keyCode.prototype={none:0,backspace:8,enter:13,escape:27,space:32,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40,zero:48,nine:57,a:65,z:90,numPadZero:96,numPadNine:105,deleteKey:127};SP.UI.MicroFeed.keyCode.registerEnum("SP.UI.MicroFeed.keyCode",false);SP.UI.MicroFeed.PostType=function(){};SP.UI.MicroFeed.PostType.prototype={unknown:0,rootRepliable:1,reply:2,rootPreview:3,replyPreview:4,newRoot:6,newReply:7,replyForRef:8,refPost:9,refMention:10,minimalRoot:11,errorPost:12};SP.UI.MicroFeed.PostType.registerEnum("SP.UI.MicroFeed.PostType",false);SP.UI.MicroFeed.FeedType=function(){};SP.UI.MicroFeed.FeedType.prototype={published:0,consolidated:1,categorical:2,custom:3,company:4,mentions:5,likes:6};SP.UI.MicroFeed.FeedType.registerEnum("SP.UI.MicroFeed.FeedType",false);SP.UI.MicroFeed.NewReplyDivType=function(){};SP.UI.MicroFeed.NewReplyDivType.prototype={empty:0,newReply:1,maxRepliesReached:2};SP.UI.MicroFeed.NewReplyDivType.registerEnum("SP.UI.MicroFeed.NewReplyDivType",false);SP.UI.MicroFeed.UpdateType=function(){};SP.UI.MicroFeed.UpdateType.prototype={noUpdate:0,older:1,newer:2};SP.UI.MicroFeed.UpdateType.registerEnum("SP.UI.MicroFeed.UpdateType",false);SP.UI.MicroFeed.PictureSize=function(){};SP.UI.MicroFeed.PictureSize.prototype={normal:0,small:1,icon:2};SP.UI.MicroFeed.PictureSize.registerEnum("SP.UI.MicroFeed.PictureSize",false);SP.UI.MicroFeed.AtMention=function(a,b,d,e){this.$$d_$9c_1=Function.createDelegate(this,this.$9c_1);this.$$d_$9g_1=Function.createDelegate(this,this.$9g_1);this.$3g_1={};this.$2d_1=[];this.$2g_1={};this.$Z_1=[];this.$1G_1={};this.$p_1=[];SP.UI.MicroFeed.AtMention.initializeBase(this,[b]);this.setLimits(b,d);this.$1_1=a;this.$3a_1=e;$addHandler(a,"keyup",this.$$d_typeAheadKeyUpHandler);var c=this;$addHandler(a,"click",function(){c.correctDropdownState()});$addHandler(a,"paste",this.$$d_$9g_1)};SP.UI.MicroFeed.AtMention.$9X=function(b){var e=b.lastIndexOf("http://"),f=b.lastIndexOf("https://"),d=b.lastIndexOf("www."),a=Math.max(e,f,d);while(a>-1){if(!a)return 0;var c=b.charCodeAt(a-1);if(c>=65&&c<=90||c>=97&&c<=122||a===d&&c===47||c===60){b=b.substr(0,a);if(a===e)e=b.lastIndexOf("http://");if(a===f)f=b.lastIndexOf("https://");if(a===d)d=b.lastIndexOf("www.");a=Math.max(e,f,d)}else return a}return a};SP.UI.MicroFeed.AtMention.$4k=function(a){var b=a;if(window.browseris.ie8standard&&!SP.ScriptUtility.isNullOrEmptyString(a))b=a.replace(SP.UI.MicroFeed.AtMention.$7X,"\n");return b};SP.UI.MicroFeed.AtMention.$4O=function(d){var a="";if(d)for(var b=0;b<d.length;b++){var c=d.charAt(b);if(c==="{")a+="{{";else if(c==="}")a+="}}";else a+=c}return a};SP.UI.MicroFeed.AtMention.prototype={$1_1:null,$3d_1:null,$3a_1:null,get_ownerControlId:function(){return this.$1_1.id},get_isHandlingLinkEntry:function(){return this.m_handlingMode===3},get_$5C_1:function(){var a=this.$1_1.value.substring(0,SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$1_1)),b=-1,c=a.substr(Math.max(a.lastIndexOf(" "),a.lastIndexOf("\n"),a.lastIndexOf("\t"),a.lastIndexOf("\r"))+1),d=SP.UI.MicroFeed.AtMention.$9X(c);if(d>-1){b=a.lastIndexOf(c)+d;this.m_handlingMode=3}else{var e=a.lastIndexOf("@"),f=a.lastIndexOf("#");b=Math.max(e,f);if(b>-1)if(b===e)this.m_handlingMode=1;else if(b===f)this.m_handlingMode=2;else this.m_handlingMode=3;else this.m_handlingMode=0}return b},get_shouldDisplayTooManyWarning:function(){for(var a=0,b=0,c=this.get_$30_1(),b=0;b<c.length;b++)if(this.$1_1.value.indexOf(c[b])>=0)a++;return this.m_handlingMode===2?a>=this.m_MaxTagsToResolve:a>=this.m_MaxToResolve},get_$9q_1:function(){for(var b=0,a=0,a=0;a<this.$Z_1.length;a++)if(this.$1_1.value.indexOf(this.$Z_1[a])>=0)b++;return b<=this.m_MaxTagsToResolve},get_shouldProvideSuggestions:function(){var b=this.get_$5C_1(),d=this.get_$30_1(),a=0;if(b===-1)return false;var c=-1;for(a=0;a<d.length;a++){var e=d[a];if(this.$1_1.value.substr(b).startsWith(e)){if(this.m_handlingMode===2){if(c===-1)c=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$1_1);if(c===b+e.length)return true}return false}}return true},get_$30_1:function(){return this.m_handlingMode===1?this.$2d_1:this.m_handlingMode===2?this.$Z_1:this.m_handlingMode===3?this.$p_1:[]},get_linkToEdit:function(){for(var d=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$1_1),a=0;a<this.$p_1.length;a++){var b=this.$p_1[a],c=this.$1_1.value.indexOf(b);if(c>=0&&c<d&&c+b.length>=d)return b}return null},typeAheadKeyDownHandler:function(a){if(this.m_handlingMode===3){this.$9y_1(a);return}SP.UI.MicroFeed.BaseAtMention.prototype.typeAheadKeyDownHandler.call(this,a)},$9g_1:function(){var b=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$1_1),a=this;window.setTimeout(function(){var d=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(a.$1_1),e=a.$5x_1(b,d),c=e.toLowerCase();if(c.startsWith("www.")||c.startsWith("http://")||c.startsWith("https://")){a.m_handlingMode=3;a.$86_1(e,b,d)}},10)},$9y_1:function(a){if(this.m_handlingMode!==3)return;var b=this.get_$5C_1(),c=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$1_1);if(a.keyCode===32||a.keyCode===13){this.$86_1(this.$5x_1(b,c),b,c);a.keyCode===13&&!a.shiftKey&&a.preventDefault()}},$86_1:function(a,c,d){this.$57_1(a.length,c,false,a,a,true,d-c-a.length);var b=SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(this.$1_1.id);if(b===this.$1_1.id)b=null;SP.UI.MicroFeed.SPMicroFeed.$8R(a,b)},linkUrlFromDisplayText:function(b){if(!b)return null;var a=this.$1G_1["<"+b+">"];return!a?null:a.$2_0},$9c_1:function(c,d){var b=this.$1_1.value.indexOf(c),a=this.$1_1.value.indexOf(d);return b<0?a<0?0:1:b<a||a<0?-1:b>a?1:0},setPostContentAndDataLinks:function(a){this.$6P_1(a,null)},setElementHighlights:function(a){this.$6P_1(null,a)},$6P_1:function(a,c){var b="",d=-1,e=-1,g=0,h=0,i=false,p={},q={},r={},f=[];this.$2d_1.sort(this.$$d_$9c_1);a&&a.set_contentText("");if(c)c.innerHTML="";for(g=0;g<this.$Z_1.length;g++){Array.remove(this.$Z_1,this.$Z_1[g]);g--}while((e=this.$9H_1(d+1))>=0){b=this.$1_1.value.substring(d+1,e);c&&b!==""&&c.appendChild(document.createTextNode(SP.UI.MicroFeed.AtMention.$4k(b)));a&&a.set_contentText(a.get_contentText()+SP.UI.MicroFeed.AtMention.$4O(b));d=e;if(this.$1_1.value.charAt(e)==="@"){var j,k;i=(k=this.$58_1(0,j={val:d},c,a,q,true,f),d=j.val,k)}else if(this.$1_1.value.charAt(e)==="#"){var l,m;i=(m=this.$58_1(1,l={val:d},c,a,p,true,f),d=l.val,m)}else if(this.$1_1.value.charAt(e)==="<"){var n,o;i=(o=this.$58_1(2,n={val:d},c,a,r,false,f),d=n.val,o)}if(!i){b=this.$1_1.value.charAt(e).toString();c&&c.appendChild(document.createTextNode(SP.UI.MicroFeed.AtMention.$4k(b)));a&&a.set_contentText(a.get_contentText()+SP.UI.MicroFeed.AtMention.$4O(b))}}b=this.$1_1.value.substr(d+1);c&&b!==""&&c.appendChild(document.createTextNode(SP.UI.MicroFeed.AtMention.$4k(b)));if(a){a.set_contentText(a.get_contentText()+SP.UI.MicroFeed.AtMention.$4O(b));a.set_contentItems(new Array(f.length));for(h=0;h<f.length;h++)a.get_contentItems()[h]=f[h]}},$58_1:function(d,b,m,e,f,s,q){var j=0,n="",o="",a="",g=[],h={};this.$3d_1=m;var k="";switch(d){case 0:g=this.$2d_1;h=this.$3g_1;break;case 1:g=this.$Z_1;h=this.$2g_1;break;case 2:g=this.$p_1;h=this.$1G_1}var i=g.length;if(d===1)i=Math.min(i,this.m_MaxTagsToResolve);else if(d!==2)i=Math.min(i,this.m_MaxToResolve);for(j=0;j<i;j++){a=g[j];if(this.$1_1.value.substr(b.val).startsWith(a)&&(s||!f[a])){if(d===1){var p=this.$1_1.value.substr(b.val+a.length,1);if(!SP.ScriptHelpers.isNullOrEmptyString(p)&&p.search(SP.UI.MicroFeed.BaseAtMention.disallowedHashTagCharsRegex)===-1)continue}n=h[a].$Y_0;o=h[a].$2_0;if(e){switch(d){case 0:e.set_contentText(e.get_contentText()+"@")}if(f&&f[a])k=f[a];else k=this.$6C_1(d,n,o,q);e.set_contentText(e.get_contentText()+k)}this.$7Q_1(m,a,b.val);b.val+=a.length-1;if(f)f[a]=k;return true}}if(d===1){var r=this.$1_1.value.substr(b.val+1),l=SP.UI.MicroFeed.BaseAtMention.getTagEndIndex(r,!!e);if(l>0)l+=b.val+1;if(l>b.val){var c=this.$1_1.value.substr(b.val,l-b.val);if(c!==""){if(!Array.contains(this.$Z_1,c)){Array.add(this.$Z_1,c);this.$2g_1[c]=new SP.UI.MicroFeed.TextBoxElement(c,"00000000-0000-0000-0000-000000000000",1)}if(!this.get_$9q_1()){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return false}this.$9O_1(c,e,f,q);this.$7Q_1(m,c,b.val);b.val+=c.length-1;return true}}}return false},$6C_1:function(d,e,b,c){var a=new SP.Social.SocialDataItem;switch(d){case 0:a.set_itemType(0);a.set_accountName(b);break;case 1:a.set_itemType(3);!SP.ScriptHelpers.isNullOrEmptyString(b)&&a.set_tagGuid(new SP.Guid(b));break;case 2:if(b.toLowerCase().startsWith("www."))b="http://"+b;a.set_uri(b);a.set_itemType(4)}a.set_text(e);Array.add(c,a);return"{"+(c.length-1).toString()+"}"},$7Q_1:function(b,c,d){if(b){var a=null;a=document.createElement("span");a.className="ms-microfeed-highlightedTextBoxElement";a.iStart=d;a.iEnd=d+c.length;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,c);b.appendChild(a)}},shouldCreateSuggestionDropdown:function(a){return this.m_handlingMode===2&&this.$9V_1(a)?false:true},$9V_1:function(c){if(this.m_handlingMode===2&&this.$3d_1){var a=this.$3d_1.firstChild;while(a){if(a.nodeType===1){var b=a.iStart,d=a.iEnd,e=c.prefix.length;if(c.triggerPosition===b&&b+e<d)return true}a=a.nextSibling}}return false},$9O_1:function(c,a,d,e){if(a){var b=this.$6C_1(1,c,"",e);a.set_contentText(a.get_contentText()+b);if(d)d[c]=b}},$9H_1:function(e){var a=-1,c=-1,d=-1,b=-1;d=this.$1_1.value.indexOf("#",e);c=this.$1_1.value.indexOf("@",e);b=this.$1_1.value.indexOf("<",e);if(d<0)a=c;else if(c<0)a=d;else a=Math.min(c,d);if(b>=0&&a<0)a=b;else if(b>=0)a=Math.min(b,a);return a},reset:function(){SP.UI.MicroFeed.BaseAtMention.prototype.reset.call(this);this.$3g_1={};this.$2d_1=[];this.$2g_1={};this.$Z_1=[];this.$1G_1={};this.$p_1=[]},onElementSelected:function(a,b,c){this.$57_1(a.prefix.length,a.triggerPosition,c,b.displayName,b.alias,true,0)},sendFocusBackToOwnerControl:function(a){SP.UI.MySiteCommon.CommonUIElements.setCursorPosition(this.$1_1,a.triggerPosition+a.prefix.length+1)},addTextAreaElement:function(a,b,c,d){this.m_handlingMode=a;this.$57_1(0,this.$1_1.value.length,false,b,c,d,0)},$57_1:function(d,e,f,b,c,g,h){var a="";if(this.m_handlingMode===1)a="@["+b+"]";else if(this.m_handlingMode===2)a=b;else if(this.m_handlingMode===3&&!this.hasLinkWithDisplayText(b))a="<"+b+">";else return;if(!Array.contains(this.get_$30_1(),a)){Array.add(this.get_$30_1(),a);if(this.m_handlingMode===1)this.$3g_1[a]=new SP.UI.MicroFeed.TextBoxElement(b,c,0);else if(this.m_handlingMode===2)this.$2g_1[a]=new SP.UI.MicroFeed.TextBoxElement(b,c,1);else if(this.m_handlingMode===3)this.$1G_1[a]=new SP.UI.MicroFeed.TextBoxElement(b,c,2)}if(f)a+=" ";this.$8H_1(a,e,d,g,h);SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector()},hasLinkWithDisplayText:function(a){return!!this.getLinkWithDisplayText(a)},getLinkWithDisplayText:function(c){var a="<"+c+">";if(this.$1_1.value.indexOf(a)>=0&&Array.contains(this.$p_1,a)){var b=this.$1G_1[a];if(b)return b.$2_0}return null},updateLinkSelection:function(d,c,e){var b="<"+d+">",a="<"+c+">";if(!Array.contains(this.$p_1,b))return;this.$1G_1[a]=new SP.UI.MicroFeed.TextBoxElement(c,e,2);if(b!==a){Array.remove(this.$p_1,b);Array.add(this.$p_1,a);this.$1G_1[b]=null;this.$1_1.value=this.$1_1.value.replace(b,a);this.$3a_1()}SP.UI.MySiteCommon.CommonUIElements.setCursorPosition(this.$1_1,this.$1_1.value.indexOf(a)+a.length)},updateOwnerControlWithNewText:function(b,a){this.$8H_1(b,a.triggerPosition,a.prefix.length,true,0)},$8H_1:function(b,a,c,d,e){this.$1_1.value=this.$1_1.value.substring(0,a)+b+this.$1_1.value.substr(a+c+(this.m_handlingMode===3?0:1));this.$3a_1();d&&SP.UI.MySiteCommon.CommonUIElements.setCursorPosition(this.$1_1,Math.min(a+b.length+e,this.$1_1.value.length))},$8f_1:function(a,b){return this.m_handlingMode===2?this.$1_1.value.substring(a,b):this.$1_1.value.substring(a+1,b)},$5x_1:function(d,e){for(var c=this.$1_1.value.substring(d,e),b=c.length;b>=0;b--){var a=c.charAt(b-1);if(a!=="."&&a!=="!"&&a!=="?"&&a!==","&&a!==";"&&a!==":"&&a!=='"'&&a!=="'"&&a!=="<"&&a!==">"&&a!=="("&&a!==")"&&a!=="["&&a!=="]"&&a!=="{"&&a!=="}"&&a!==" "&&a!=="\n"&&a!=="\r"&&a!=="\t")break}return c.substr(0,b>=0?b:0)},get_dropDownBeforeSibling:function(){return this.$1_1},addAdditionalWarningMessages:function(c,b){if(this.m_handlingMode===1){var a=STSHtmlDecode(this.$1_1.getAttribute("targetDisplayName"));!SP.ScriptHelpers.isNullOrEmptyString(a)&&this.addMentionsWarningTextWhenTargetting(b,a)}return true},calculateCurrentState:function(){var b=this.get_$5C_1(),c=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$1_1),a=new SP.UI.MicroFeed.OwnerControlState;a.triggerPosition=b;a.prefix=this.$8f_1(b,c);return a}};SP.UI.MicroFeed.TextBoxElement=function(a,b,c){this.$Y_0=a;this.$2_0=b;this.$t_0=c;this.$1u_0=""};SP.UI.MicroFeed.TextBoxElement.$8g=function(f,g){var c=f,d=g,a=c.$Y_0.toLowerCase(),b=d.$Y_0.toLowerCase(),e=a.localeCompare(b);if(e)return e;a=c.$2_0.toLowerCase();b=d.$2_0.toLowerCase();return a.localeCompare(b)};SP.UI.MicroFeed.TextBoxElement.prototype={$Y_0:null,$2_0:null,$t_0:0,$1u_0:null,get_displayName:function(){return this.$Y_0},get_identifier:function(){return this.$2_0},get_elementType:function(){return this.$t_0},get_description:function(){return this.$1u_0},set_description:function(a){this.$1u_0=a;return a},insertIntoSortedArray:function(a){var b=0;if(!a)a=[];else if(a.length>0)b=this.$2x_0(a,0,a.length);Array.insert(a,b,this);return a},removeFromSortedArray:function(a){var b=0;if(!a)a=[];else if(a.length>0)b=this.$2x_0(a,0,a.length);if(b>-1&&b<a.length){var c=a[b];c.$t_0===this.$t_0&&c.$2_0===this.$2_0&&Array.removeAt(a,b)}return a},$2x_0:function(c,b,d){if(b===d)return b;var a=Math.floor((b+d)/2),e=SP.UI.MicroFeed.TextBoxElement.$8g(c[a],this);return e<0?this.$2x_0(c,a+1,d):e>0?this.$2x_0(c,b,a):a}};SP.UI.MicroFeed.BaseAtMention=function(a){this.$$d_$9e_0=Function.createDelegate(this,this.$9e_0);this.$$d_$7s_0=Function.createDelegate(this,this.$7s_0);this.$$d_$9d_0=Function.createDelegate(this,this.$9d_0);this.$$d_$9f_0=Function.createDelegate(this,this.$9f_0);this.$$d_$9w_0=Function.createDelegate(this,this.$9w_0);this.$$d_typeAheadKeyUpHandler=Function.createDelegate(this,this.typeAheadKeyUpHandler);this.m_MaxToResolve=a};SP.UI.MicroFeed.BaseAtMention.get_$1i=function(){if(!SP.UI.MicroFeed.BaseAtMention.$40)SP.UI.MicroFeed.BaseAtMention.$40=new SP.UI.MicroFeed.AllUsersSuggestionManager(SP.UI.MicroFeed.BaseAtMention.$2h);return SP.UI.MicroFeed.BaseAtMention.$40};SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector=function(){SP.UI.MicroFeed.BaseAtMention.$82();SP.UI.MicroFeed.BaseAtMention.$83()};SP.UI.MicroFeed.BaseAtMention.$82=function(){var a=$get(SP.UI.MicroFeed.BaseAtMention.$1q);a&&a.parentNode&&a.parentNode.removeChild(a)};SP.UI.MicroFeed.BaseAtMention.$83=function(){SP.UI.MicroFeed.BaseAtMention.tagSuggestions&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.hidePanel()};SP.UI.MicroFeed.BaseAtMention.$9S=function(e){var c=$get(SP.UI.MicroFeed.BaseAtMention.$1q),a=null;if(c)a=c.getAttribute(SP.UI.MicroFeed.BaseAtMention.$1h);else if(SP.UI.MicroFeed.BaseAtMention.tagSuggestions)a=SP.UI.MicroFeed.BaseAtMention.tagSuggestions[SP.UI.MicroFeed.BaseAtMention.$1h];if(a)if(!SP.ScriptHelpers.isNullOrEmptyString(a)){var d=$get(a);if(d){var b=e;while(b){if(b===d)return true;b=b.parentNode}}}return false};SP.UI.MicroFeed.BaseAtMention.$7U=function(){return!!$get(SP.UI.MicroFeed.BaseAtMention.$5D)||!!$get(SP.UI.MicroFeed.BaseAtMention.get_$1i().m_loadingAnimationIDForRequest)};SP.UI.MicroFeed.BaseAtMention.setFollowedPeople=function(b){if(b.get_areItemsAvailable()){SP.UI.MicroFeed.BaseAtMention.$1M=[];var c=b.getEnumerator();while(c.moveNext()){var a=c.get_current();SP.UI.People.PersonManager.addPerson(a);SP.UI.MicroFeed.BaseAtMention.addFollowedPerson(a.get_accountName(),a.get_displayName())}}};SP.UI.MicroFeed.BaseAtMention.addFollowedPerson=function(a,b){new SP.UI.MicroFeed.TextBoxElement(b,a,0).insertIntoSortedArray(SP.UI.MicroFeed.BaseAtMention.$1M)};SP.UI.MicroFeed.BaseAtMention.removeFollowedPerson=function(a,b){new SP.UI.MicroFeed.TextBoxElement(b,a,0).removeFromSortedArray(SP.UI.MicroFeed.BaseAtMention.$1M)};SP.UI.MicroFeed.BaseAtMention.$8K=function(a){if(a.indexOf(";")!==-1||a.indexOf("<")!==-1||a.indexOf(">")!==-1||a.indexOf("|")!==-1||a.indexOf("\t")!==-1||a.indexOf("\n")!==-1||a.indexOf("\r")!==-1||a.startsWith(" "))return false;var b=a.split(" ");return b.length>3?false:true};SP.UI.MicroFeed.BaseAtMention.$A6=function(a){return a.indexOf("\n")!==-1||a.indexOf("\r")!==-1||a.startsWith("\t")||a.startsWith(" ")?false:true};SP.UI.MicroFeed.BaseAtMention.$9K=function(){var b=window._spPageContextInfo;if(b){var a=b.webServerRelativeUrl;if(!a.endsWith("/"))a+="/";return a+"_vti_bin/taxonomyinternalservice.json"}else return""};SP.UI.MicroFeed.BaseAtMention.$9D=function(){var a=1033,b=window._spPageContextInfo;if(b)a=b.currentLanguage;return a};SP.UI.MicroFeed.BaseAtMention.getTagEndIndex=function(b,c){var a=b.search(SP.UI.MicroFeed.BaseAtMention.disallowedHashTagCharsRegex);if(a===-1&&c)a=b.length;return a};SP.UI.MicroFeed.BaseAtMention.prototype={$o_0:0,m_MaxToResolve:6,m_MaxTagsToResolve:6,m_LastGetTaxonomyFailed:false,m_handlingMode:0,setLimits:function(a,b){this.m_MaxToResolve=a;this.m_MaxTagsToResolve=b},get_isSuggestionMenuOpen:function(){var a=$get(SP.UI.MicroFeed.BaseAtMention.$1q);return!!a&&a.getAttribute(SP.UI.MicroFeed.BaseAtMention.$1h)===this.get_ownerControlId()||!!SP.UI.MicroFeed.BaseAtMention.tagSuggestions&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.get_isShowing()},reset:function(){this.$o_0=0},get_currentSelection:function(){if($get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$W+1))if(this.$o_0>0)return this.getElementAt(this.$o_0);return null},getElementAt:function(c){var a=null;a=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$W+c);if(a){var b=new SP.UI.MicroFeed.AtMentionMenuOption;b.displayName=a.getAttribute(SP.UI.MicroFeed.BaseAtMention.$2D);b.alias=a.getAttribute(SP.UI.MicroFeed.BaseAtMention.$4E);return b}return null},highlightElementFromDropDown:function(c){var a=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$W+this.$o_0),b=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$W+c);if(a&&b){a.className=a.className.replace(SP.UI.MicroFeed.BaseAtMention.$49,SP.UI.MicroFeed.BaseAtMention.$2F);a.removeAttribute("role");b.className=b.className.replace(SP.UI.MicroFeed.BaseAtMention.$2F,SP.UI.MicroFeed.BaseAtMention.$49);b.setAttribute("role","alert");this.$o_0=c}},shouldCreateSuggestionDropdown:function(){return true},moveSuggestionDropDownToCurrentOwner:function(){var a=$get(SP.UI.MicroFeed.BaseAtMention.$1q),b=null;if(a&&a.parentNode)if(a.getAttribute(SP.UI.MicroFeed.BaseAtMention.$1h)===this.get_ownerControlId())b=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$5d);else{a.parentNode.removeChild(a);a=null}if(!a){a=document.createElement("div");a.id=SP.UI.MicroFeed.BaseAtMention.$1q;a.className="ms-microfeed-mentionContainer";a.setAttribute(SP.UI.MicroFeed.BaseAtMention.$1h,this.get_ownerControlId());this.$7T_0(a)}if(!b){b=document.createElement("div");b.id=this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$5d;b.className="ms-microfeed-typeAheadSelectorsDiv";b.setAttribute("aria-live","polite");b.setAttribute("aria-relevant","all");a.appendChild(b)}this.fullContainerChanged(a);return b},$7T_0:function(a){this.get_dropDownBeforeSibling()&&this.get_dropDownBeforeSibling().parentNode&&this.get_dropDownBeforeSibling().parentNode.insertBefore(a,this.get_dropDownBeforeSibling().nextSibling)},fullContainerChanged:function(){},buildSuggestionDropDown:function(a){var e=this.get_shouldDisplayTooManyWarning();if(this.m_handlingMode===2&&SP.UI.MicroFeed.BaseAtMention.$8K(a.prefix)&&!e){SP.UI.MicroFeed.BaseAtMention.$82();if(this.addAdditionalWarningMessages(a,null)){this.$97_0();this.$7T_0(SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv);this.$9u_0(a.prefix);SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.elementPrefix=a.prefix;SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.triggerPosition=a.triggerPosition}return}SP.UI.MicroFeed.BaseAtMention.$83();var b=this.moveSuggestionDropDownToCurrentOwner(),c=null;if(!b){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}this.m_handlingMode===1&&!SP.UI.MicroFeed.SPMicroFeed.$1d&&SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(true);b.innerHTML="";if(e){var d=null;if(this.m_handlingMode===1)d=String.format(SpsClient.ScriptResources.configurableMentionsWarningText,this.m_MaxToResolve);else if(this.m_handlingMode===2)d=String.format(SpsClient.ScriptResources.tooManyTagsWarning,this.m_MaxTagsToResolve);d&&this.appendDropdownWarning(b,d,"_toomanymentionwarning","ms-microfeed-tooManyElementsWarning");if(this.m_handlingMode===2)return}if(this.m_handlingMode===1&&SP.UI.MicroFeed.BaseAtMention.$A6(a.prefix))this.addAdditionalWarningMessages(a,b)&&this.$8a_0(a,b);c=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$W+"1");if(c){c.className=c.className.replace(SP.UI.MicroFeed.BaseAtMention.$2F,SP.UI.MicroFeed.BaseAtMention.$49);this.$o_0=1;var f=this;$addHandler(b,"click",function(a){a.stopPropagation()})}else!$get(this.get_ownerControlId()+"_taxonomynotavailablewarning")&&!SP.UI.MicroFeed.BaseAtMention.$7U()&&SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector()},$8a_0:function(i,c){var a=0,b=false,e=i.prefix;if(SP.UI.MicroFeed.BaseAtMention.$1M&&SP.UI.MicroFeed.BaseAtMention.$1M.length)for(var j=SP.UI.MicroFeed.BaseAtMention.$1M,l=j.length,g=0;g<l;++g){var h=j[g];if(!h.$Y_0.toLowerCase().startsWith(e.toLowerCase()))continue;a++;if(!b){c.appendChild(this.$2z_0(SpsClient.ScriptResources.peopleFollowingLabel,"_FollowingHeadingDiv",null,null));b=true}c.appendChild(this.$4H_0(i,a,h.$Y_0,h.$2_0,""));if(a>=SP.UI.MicroFeed.BaseAtMention.$2h)break}else!SP.UI.MicroFeed.BaseAtMention.$1M&&c.appendChild(this.$2z_0(SpsClient.ScriptResources.peopleFollowingLabel,"_FollowingHeadingDiv",SP.UI.MicroFeed.BaseAtMention.$5D,SpsClient.ScriptResources.loadingPeopleTitle));b=false;if(a<SP.UI.MicroFeed.BaseAtMention.$2h){var f=0,d=null;if(SP.UI.MicroFeed.BaseAtMention.get_$1i().$1b_0){c.appendChild(this.$2z_0(SpsClient.ScriptResources.allPeopleLabel,"_CompanyHeadingDiv",SP.UI.MicroFeed.BaseAtMention.get_$1i().m_loadingAnimationIDForRequest,SpsClient.ScriptResources.loadingPeopleTitle));b=true}if(!SP.UI.MicroFeed.BaseAtMention.get_$1i().$9U_1(e)){var k=SP.UI.MicroFeed.BaseAtMention.get_$1i().$9J_0(e.substr(0,1));for(f=0;f<k.length;f++){d=k[f];if(!d.$Y_0.toLowerCase().startsWith(e.toLowerCase()))continue;a++;if(!b){c.appendChild(this.$2z_0(SpsClient.ScriptResources.allPeopleLabel,"_CompanyHeadingDiv",null,null));b=true}c.appendChild(this.$4H_0(i,a,d.$Y_0,d.$2_0,d.$1u_0));if(a>=SP.UI.MicroFeed.BaseAtMention.$2h)break}}}},createLinkElement:function(g,f,c,e,d){var b=this.$4H_0(g,f,"","","");b.setAttribute(SP.UI.MicroFeed.BaseAtMention.$2D,c);b.className+=" ms-linkOptionDiv";var a=document.createElement("a");a.id=e;a.href="#";a.className="ms-commandLink";a.setAttribute("onclick","return false;");a.innerHTML=STSHtmlEncode(d);b.appendChild(a);return b},appendDropdownWarning:function(d,e,g,f){var a=document.createElement("div");a.id=this.get_ownerControlId()+g;a.className=f;a.style.height="auto";var c=document.createElement("span");c.className="ms-microfeed-warningImage";c.id="ms-DropdownWarningImage";var b=document.createElement("div");b.id="ms-microfeed-warningText";b.className="ms-microfeed-warningText";b.appendChild(document.createTextNode(e));a.appendChild(c);a.appendChild(b);d.appendChild(a)},$2z_0:function(e,f,d,b){var a=document.createElement("div");a.id=this.get_ownerControlId()+f;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,e);a.className="ms-microfeed-followingHeadingDiv ms-soften";if(d){var c=SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon(d,"ms-microfeed-loadingSuggestionImage");b=b||"";c.alt=b;c.title=b;a.appendChild(c)}return a},$5A_0:function(b,a,c){if(a)this.onElementSelected(b,a,c)},$4H_0:function(j,h,c,d,i){var a=document.createElement("div");a.id=this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$W+h;a.className="ms-microfeed-mentionUserDiv "+SP.UI.MicroFeed.BaseAtMention.$2F;var e=this;$addHandler(a,"click",function(){e.$5A_0(j,e.getElementAt(h),false)});a.setAttribute(SP.UI.MicroFeed.BaseAtMention.$4E,d);if(!SP.ScriptHelpers.isNullOrEmptyString(d)){var b=d,g=b.lastIndexOf("|");if(g>0)b=b.substring(g+1,b.length);a.setAttribute("title",b)}a.setAttribute(SP.UI.MicroFeed.BaseAtMention.$2D,c);var f=c;if(!SP.ScriptHelpers.isNullOrEmptyString(i))f=String.format(SpsClient.ScriptResources.nameAndDescriptionFormatString,c,i);SP.UI.MySiteCommon.CommonUIElements.setElementText(a,f);$addHandler(a,"mouseover",this.$$d_$9w_0);return a},$9w_0:function(b){var a=b.target.id;this.highlightElementFromDropDown(parseInt(a.substr(a.lastIndexOf("_")+1)))},correctDropdownState:function(){if(this.get_shouldProvideSuggestions()){var a=this.calculateCurrentState();this.shouldCreateSuggestionDropdown(a)&&this.buildSuggestionDropDown(a)}else SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector()},$80_0:function(b,c){var a=this;b.$9b_0(c.prefix,function(){if(a.get_shouldProvideSuggestions()){var c=a.calculateCurrentState();a.$80_0(b,c)}a.correctDropdownState()})},typeAheadKeyDownHandler:function(a){if(!this.get_isSuggestionMenuOpen())return;if(!this.get_shouldProvideSuggestions()){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}if(a.keyCode===27){a.preventDefault();SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}if(a.keyCode===38||a.keyCode===40){this.$8d_0(a.keyCode===38);a.preventDefault();return}if(a.keyCode===13&&!a.shiftKey){SP.UI.MicroFeed.BaseAtMention.tagSuggestions&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.get_isShowing()&&this.$98_0();$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$W+1)&&this.$5A_0(this.calculateCurrentState(),this.get_currentSelection(),false);a.preventDefault();a.stopPropagation()}},typeAheadKeyUpHandler:function(a){if(!this.get_shouldProvideSuggestions()||a.keyCode===27||a.keyCode===13){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}if(a.keyCode===38||a.keyCode===40){if(this.get_isSuggestionMenuOpen()){var c=1;if(a.keyCode===38)c=this.$o_0-1;else c=this.$o_0+1;this.highlightElementFromDropDown(c);a.preventDefault();a.stopPropagation()}return}var b=this.calculateCurrentState();this.m_handlingMode===1&&this.$80_0(SP.UI.MicroFeed.BaseAtMention.get_$1i(),b);if(this.m_handlingMode===2)if(!SP.UI.MicroFeed.BaseAtMention.$8K(b.prefix)){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}if(a.keyCode===32&&this.m_handlingMode!==2){var d=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$W+"2");if(this.m_handlingMode===1&&!d)if(this.$8y_0(b.prefix)){this.$5A_0(b,this.get_currentSelection(),true);return}else if(!$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$W+"1")&&!SP.UI.MicroFeed.BaseAtMention.$7U()){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}}this.shouldCreateSuggestionDropdown(b)&&this.buildSuggestionDropDown(b)},$8y_0:function(b){var a=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$W+this.$o_0);return!a?false:b.toLowerCase()===a.getAttribute(SP.UI.MicroFeed.BaseAtMention.$2D).toLowerCase()+" "},$9t_0:function(b){var a=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,b);a.set_hideCancelButton(true);a.show()},addMentionsWarningTextWhenTargetting:function(a,b){this.addStandardDropdownWarning(a,String.format(SpsClient.ScriptResources.mentionsWarningTextWhenTargetting,b),"_targetmentionwarning")},addStandardDropdownWarning:function(a,c,b){this.appendDropdownWarning(a,c,b,"ms-microfeed-tooManyElementsWarning")},$9u_0:function(b){if(SP.ScriptHelpers.isNullOrEmptyString(b)||b==="#")return;var a={};a.start=b;a.lcid=SP.UI.MicroFeed.BaseAtMention.$9D();a.sspList="00000000-0000-0000-0000-000000000000";a.termSetList="3CEB0050-69A1-40E7-A427-83E2FAC80C27";a.anchorId="00000000-0000-0000-0000-000000000000";a.isSpanTermStores=false;a.isSpanTermSets=false;a.isIncludeUnavailable=false;a.isIncludeDeprecated=false;a.isAddTerms=false;a.isIncludePathData=false;a.excludeKeyword=true;a.excludedTermset="00000000-0000-0000-0000-000000000000";var c=SP.UI.MicroFeed.BaseAtMention.$9K();!SP.ScriptHelpers.isNullOrEmptyString(c)&&Sys.Net.WebServiceProxy.invoke(c,"GetSuggestions",false,a,this.$$d_$9f_0,this.$$d_$9d_0,b,Sys.Net.WebRequestManager.get_defaultTimeout(),false,null)},$9f_0:function(b,c){this.m_LastGetTaxonomyFailed=false;if(!SP.UI.MicroFeed.BaseAtMention.tagSuggestions)return;var a=c;if(!SP.ScriptHelpers.isNullOrEmptyString(a))SP.UI.MicroFeed.BaseAtMention.tagSuggestions.updateSuggestionsWithTaxonomyResult(b,a,a,{},true);else SP.UI.MicroFeed.BaseAtMention.tagSuggestions.hidePanel()},$9d_0:function(){if(!this.m_LastGetTaxonomyFailed){this.$9t_0(SpsClient.ScriptResources.taxonomyNotAvailableWarning);this.m_LastGetTaxonomyFailed=true}},$97_0:function(){if(!SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv||!SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.parentNode){SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv=document.createElement("DIV");SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.id="HashTagSuggestionsContainer";SP.UI.MicroFeed.BaseAtMention.tagSuggestions=new Microsoft.SharePoint.Taxonomy.SuggestionContainer(SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv);SP.UI.MicroFeed.BaseAtMention.tagSuggestions.hidePanel();SP.UI.MicroFeed.BaseAtMention.tagSuggestions[SP.UI.MicroFeed.BaseAtMention.$1h]=this.get_ownerControlId();SP.UI.MicroFeed.BaseAtMention.tagSuggestions.set_isSpanTermSets(true);SP.UI.MicroFeed.BaseAtMention.tagSuggestions.add_selectionMade(this.$$d_$7s_0);Sys.Net.WebRequestManager.add_invokingRequest(this.$$d_$9e_0)}},$7s_0:function(h,d){if(d){var e=this.calculateCurrentState(),a=new SP.UI.MicroFeed.AtMentionMenuOption,b=d.results;if(b){var f=SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.triggerPosition,g=SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.elementPrefix,c=new Microsoft.SharePoint.Taxonomy.Term(b);a.alias=c.get_guid();a.displayName=c.get_text()}this.onElementSelected(e,a,false)}},$9e_0:function(e,d){if(!SP.ScriptHelpers.isUndefined(window._spPageContextInfo)&&!SP.ScriptHelpers.isUndefined(window._spFormDigestRefreshInterval)&&!SP.ScriptHelpers.isUndefined(window.UpdateFormDigest)){var b=_spPageContextInfo.webServerRelativeUrl,c=window._spFormDigestRefreshInterval;UpdateFormDigest(b,c)}var a=$get("__REQUESTDIGEST");if(a)d.get_webRequest().get_headers()["X-RequestDigest"]=a.value},$8d_0:function(a){SP.UI.MicroFeed.BaseAtMention.tagSuggestions&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.get_isShowing()&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.toggleHighlight(a)},$98_0:function(){if(SP.UI.MicroFeed.BaseAtMention.tagSuggestions&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.get_isShowing()){var a=SP.UI.MicroFeed.BaseAtMention.tagSuggestions.getHighlightedSuggestion();if(a){var b=new Microsoft.SharePoint.Taxonomy.SelectionMadeEventArgs(a.get_suggestValue());this.$7s_0(null,b)}}}};SP.UI.MicroFeed.AtMentionMenuOption=function(){};SP.UI.MicroFeed.AtMentionMenuOption.prototype={displayName:null,alias:null};SP.UI.MicroFeed.OwnerControlState=function(){};SP.UI.MicroFeed.OwnerControlState.prototype={prefix:null,triggerPosition:0};SP.UI.MicroFeed.SocialActorCache=function(){this.$2u_0={}};SP.UI.MicroFeed.SocialActorCache.get_actorCache=function(){if(!SP.UI.MicroFeed.SocialActorCache.$1D)SP.UI.MicroFeed.SocialActorCache.$1D=new SP.UI.MicroFeed.SocialActorCache;return SP.UI.MicroFeed.SocialActorCache.$1D};SP.UI.MicroFeed.SocialActorCache.isFollowedByMe=function(a){return!a?false:SP.UI.MicroFeed.SocialActorCache.get_actorCache().$2u_0[a]};SP.UI.MicroFeed.SocialActorCache.setIsFollowedByMeValue=function(a,b){if(!a)return;SP.UI.MicroFeed.SocialActorCache.get_actorCache().$2u_0[a.get_id()]=b};SP.UI.MicroFeed.SocialActorCache.prototype={$2u_0:null};SP.UI.MicroFeed.MicrofeedThreadCache=function(){this.$9_0={}};SP.UI.MicroFeed.MicrofeedThreadCache.get_threadCache=function(){if(!SP.UI.MicroFeed.MicrofeedThreadCache.$1D)SP.UI.MicroFeed.MicrofeedThreadCache.$1D=new SP.UI.MicroFeed.MicrofeedThreadCache;return SP.UI.MicroFeed.MicrofeedThreadCache.$1D};SP.UI.MicroFeed.MicrofeedThreadCache.getThreadById=function(a){return!a?null:SP.UI.MicroFeed.MicrofeedThreadCache.get_threadCache().$9_0[a]};SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate=function(a,c){if(!a)return;SP.UI.MicroFeed.MicrofeedThreadCache.$5m(a.get_actors());a.get_postReference()&&a.get_postReference().get_digest()&&SP.UI.MicroFeed.MicrofeedThreadCache.$5m(a.get_postReference().get_digest().get_actors());if(!a.get_threadType()&&a.get_replies()&&a.get_replies().length<2&&a.get_replies().length!==a.get_totalReplyCount())return;if(!a.get_actors().length)return;if(c){var b=SP.UI.MicroFeed.MicrofeedThreadCache.getThreadById(a.get_id());(!b||a.get_totalReplyCount()!==b.get_totalReplyCount()||a.get_rootPost().get_modifiedTime().toString()!==b.get_rootPost().get_modifiedTime().toString())&&SP.UI.MicroFeed.SPMicroFeed.microfeed.incrementNewPostCount()}SP.UI.MicroFeed.MicrofeedThreadCache.get_threadCache().$9_0[a.get_id()]=a};SP.UI.MicroFeed.MicrofeedThreadCache.$5m=function(e){for(var c=e,d=c.length,b=0;b<d;++b){var a=c[b];if(!a.get_actorType())SP.UI.People.PersonManager.addSocialActor(a);else SP.UI.MicroFeed.SocialActorCache.setIsFollowedByMeValue(a,a.get_isFollowed())}};SP.UI.MicroFeed.MicrofeedThreadCache.removeById=function(a){if(!a)return;SP.UI.MicroFeed.MicrofeedThreadCache.get_threadCache().$9_0[a]=null};SP.UI.MicroFeed.MicrofeedThreadCache.prototype={$9_0:null};SP.UI.MicroFeed.MicrofeedThreadList=function(){this.$9_0=[];this.$2W_0={}};SP.UI.MicroFeed.MicrofeedThreadList.prototype={$9_0:null,$5F_0:false,$2W_0:null,setThreadCollection:function(a,d,c){if(a&&a.get_threads()){var b=0;this.$5F_0=c;Array.clear(this.$9_0);this.$2W_0={};for(b=0;b<a.get_threads().length;b++){var e=a.get_threads()[b];this.add(e,d,true)}}},appendThreadList:function(a){this.$5y_0();if(!a||!a.sizeAfterRemovingRecentDeletions())return;for(var b=null,c=0;c<a.size();c++){b=a.get(c);!this.containsByID(b.get_id())&&this.add(b,false,false)}},"get":function(a){return a<0||a>=this.$9_0.length?null:SP.UI.MicroFeed.MicrofeedThreadCache.getThreadById(this.$9_0[a])},containsByID:function(a){return this.$59_0(a)>-1},$5y_0:function(){for(var a=0;a<this.$9_0.length;a++)while(a<this.$9_0.length&&!SP.UI.MicroFeed.MicrofeedThreadCache.getThreadById(this.$9_0[a]))Array.removeAt(this.$9_0,a)},add:function(a,c,d){d&&SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(a,c);if(this.$5F_0){var b="";if(!a.get_threadType())b=a.get_rootPost().get_id();else if(a.get_postReference())b=a.get_postReference().get_threadId();else return;if(this.$2W_0[b])return;this.$2W_0[b]=true}Array.add(this.$9_0,a.get_id())},addToFront:function(a,b){SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(a,b);Array.insert(this.$9_0,0,a.get_id())},moveToFront:function(a,c){SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(a,c);var b=this.$59_0(a.get_id());if(b>-1){Array.removeAt(this.$9_0,b);Array.insert(this.$9_0,0,a.get_id())}},remove:function(b){var a=this.$59_0(b.get_id());a>-1&&Array.removeAt(this.$9_0,a)},$59_0:function(b){if(!b)return-1;for(var a=0;a<this.$9_0.length;a++)if(this.$9_0[a]===b)return a;return-1},size:function(){return this.$9_0.length},sizeAfterRemovingRecentDeletions:function(){this.$5y_0();return this.$9_0.length}};SP.UI.MicroFeed.MicroFeedView=function(){};SP.UI.MicroFeed.MicroFeedView.createView=function(d,e,f,c,b){var a=new SP.UI.MicroFeed.MicroFeedView;a.$4B_0=d;a.$d_0=e;a.$r_0=f;a.$37_0=c;a.$2J_0=b;return a};SP.UI.MicroFeed.MicroFeedView.prototype={get_numVisiblePosts:function(){return this.$4B_0.length},visiblePostAttribute:function(a){return this.$4B_0[a]},get_feedName:function(){return this.$r_0},get_emptyFeedMessage:function(){return this.$37_0},get_feedToUse:function(){return this.$d_0},get_feedDescription:function(){return this.$2J_0},$4B_0:null,$d_0:0,$r_0:null,$37_0:null,$2J_0:null};SP.UI.MicroFeed.AttributePair=function(){};SP.UI.MicroFeed.AttributePair.createAttributePairWithType=function(b,a){return SP.UI.MicroFeed.AttributePair.createAttributePair(SP.Social.SocialThreadType.toString(b),a)};SP.UI.MicroFeed.AttributePair.createAttributePair=function(c,b){var a=new SP.UI.MicroFeed.AttributePair;a.$2X_0=c;a.$2t_0=b;return a};SP.UI.MicroFeed.AttributePair.prototype={get_key:function(){return this.$2X_0},get_value:function(){return this.$2t_0},$2X_0:null,$2t_0:null};SP.UI.MicroFeed.SPMicroFeed=function(k,j,i){this.$$d_$A0_0=Function.createDelegate(this,this.$A0_0);this.$$d_$A1_0=Function.createDelegate(this,this.$A1_0);this.$$d_$9z_0=Function.createDelegate(this,this.$9z_0);this.$$d_$7w_0=Function.createDelegate(this,this.$7w_0);this.$$d_$8e_0=Function.createDelegate(this,this.$8e_0);this.$U_0=SpsClient.ScriptResources.replyTextBoxString;var e=$get(SP.UI.MicroFeed.SPMicroFeed.$22);e.className=SP.UI.MicroFeed.SPMicroFeed.$7n;var a="",b="";this.$2Z_0="";this.$6_0=k;e.innerHTML="";this.$M_0="";this.$K_0=true;SP.UI.MicroFeed.SPMicroFeed.$P={};this.$E_0=[];this.$4_0=[];this.$1H_0=new Date;this.$1Z_0=0;this.$z_0=-1;this.$1I_0=this.$6_0===1;this.$3j_0=false;this.$1W_0=-1;this.$1v_0=false;this.$2a_0=0;this.$1Y_0=null;this.$3f_0=new Date;this.$w_0=false;SP.UI.MicroFeed.SPMicroFeed.$c=false;SP.UI.MicroFeed.SPMicroFeed.$1g=null;this.$3l_0=false;this.$2c_0="";this.$2b_0="";this.$2f_0="";this.$2e_0="";this.$1V_0=j;this.$2Y_0=i;SP.UI.MicroFeed.SPMicroFeed.$J={};var f="",g="",l=SP.ScriptHelpers.getDocumentQueryPairs(),c=l;for(var d in c){var h={key:d,value:c[d]};a=h.key.toLowerCase();b=decodeURIComponent(h.value||"");if(a==="threadid"&&!SP.ScriptHelpers.isNullOrEmptyString(b))SP.UI.MicroFeed.SPMicroFeed.$c=true;if(a==="mentionperson")this.$2c_0=b;else if(a==="mentionpersonname")this.$2b_0=b;else if(a==="tagtext")this.$2f_0=b;else if(a==="tagid")this.$2e_0=b;else if(a==="unsubscribe")this.$3l_0=true;else if(a==="rootpostauthorid")f=b;else if(a==="rootpostid")g=b}if(!SP.ScriptHelpers.isNullOrEmptyString(g)&&!SP.ScriptHelpers.isNullOrEmptyString(f))SP.UI.MicroFeed.SPMicroFeed.$c=true};SP.UI.MicroFeed.SPMicroFeed.get_companyFeedViewIndex=function(){return SP.UI.MicroFeed.SPMicroFeed.$23};SP.UI.MicroFeed.SPMicroFeed.set_companyFeedViewIndex=function(a){SP.UI.MicroFeed.SPMicroFeed.$23=a;return a};SP.UI.MicroFeed.SPMicroFeed.get_$D=function(){!SP.UI.MicroFeed.SPMicroFeed.$V&&!SP.UI.MicroFeed.SPMicroFeed.$12&&SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);return SP.UI.MicroFeed.SPMicroFeed.$V};SP.UI.MicroFeed.SPMicroFeed.get_$Q=function(){!SP.UI.MicroFeed.SPMicroFeed.$V&&!SP.UI.MicroFeed.SPMicroFeed.$12&&SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);return SP.UI.MicroFeed.SPMicroFeed.$41};SP.UI.MicroFeed.SPMicroFeed.get_$6G=function(){return SP.UI.MicroFeed.SPMicroFeed.$5a&&!!SP.UI.MicroFeed.SPMicroFeed.get_$Q()&&!SP.UI.MicroFeed.SPMicroFeed.get_$Q().get_status()};SP.UI.MicroFeed.SPMicroFeed.get_$5c=function(){!SP.UI.MicroFeed.SPMicroFeed.$25&&SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);return SP.UI.MicroFeed.SPMicroFeed.$25};SP.UI.MicroFeed.SPMicroFeed.get_followedPeopleCallback=function(){return SP.UI.MicroFeed.SPMicroFeed.$2o};SP.UI.MicroFeed.SPMicroFeed.set_followedPeopleCallback=function(a){SP.UI.MicroFeed.SPMicroFeed.$2o=a;return a};SP.UI.MicroFeed.SPMicroFeed.get_$1O=function(){return GetThemedImageUrl("spcommon.png")};SP.UI.MicroFeed.SPMicroFeed.get_$2s=function(){return GetThemedImageUrl("socialcommon.png")};SP.UI.MicroFeed.SPMicroFeed.setFocusOnRootPostInputBox=function(){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$1L);a&&a.focus()};SP.UI.MicroFeed.SPMicroFeed.initializeForExternalUse=function(){if(!SP.UI.MicroFeed.SPMicroFeed.$1f){SP.UI.MicroFeed.SPMicroFeed.$12=true;SP.UI.MicroFeed.SPMicroFeed.$1f=true}};SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData=function(a){if(SP.UI.MicroFeed.SPMicroFeed.$1f&&!SP.UI.MicroFeed.SPMicroFeed.$V&&!SP.UI.MicroFeed.SPMicroFeed.$12){SP.UI.MicroFeed.SPMicroFeed.$46=false;SP.UI.MicroFeed.SPMicroFeed.$2p=false;SP.UI.MicroFeed.SPMicroFeed.$1d=false}if(!SP.UI.MicroFeed.SPMicroFeed.$V&&SP.UI.MicroFeed.SPMicroFeed.$1f&&!SP.UI.MicroFeed.SPMicroFeed.$46){SP.UI.MicroFeed.SPMicroFeed.$46=true;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){SP.UI.MicroFeed.SPMicroFeed.$N=SP.ClientContext.get_current();if(!SP.UI.MicroFeed.SPMicroFeed.$12)SP.UI.MicroFeed.SPMicroFeed.$V=SP.Social.SocialFeedManager.newObject(SP.UI.MicroFeed.SPMicroFeed.$N);if(!SP.UI.MicroFeed.SPMicroFeed.$25)SP.UI.MicroFeed.SPMicroFeed.$25=SP.UserProfiles.PeopleManager.newObject(SP.UI.MicroFeed.SPMicroFeed.$N)})}a&&SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){},function(){})};SP.UI.MicroFeed.SPMicroFeed.setCSOMDataInited=function(){if(!SP.UI.MicroFeed.SPMicroFeed.$1d&&(SP.UI.MicroFeed.SPMicroFeed.$12||SP.UI.MicroFeed.SPMicroFeed.$V.isPropertyAvailable("Owner"))){if(SP.UI.MicroFeed.SPMicroFeed.$V)SP.UI.MicroFeed.SPMicroFeed.$41=SP.UI.MicroFeed.SPMicroFeed.$V.get_owner();SP.UI.MicroFeed.SPMicroFeed.$1d=true}};SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded=function(c,d){var a=null,b=false;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){if(!SP.UI.MicroFeed.SPMicroFeed.$1d&&!SP.UI.MicroFeed.SPMicroFeed.$2p){SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);SP.UI.MicroFeed.SPMicroFeed.$2p=true;b=true;a=SP.UI.MicroFeed.SPMicroFeed.$A2();SP.UI.MicroFeed.SPMicroFeed.$V&&SP.UI.MicroFeed.SPMicroFeed.$N.load(SP.UI.MicroFeed.SPMicroFeed.$V)}SP.UI.MicroFeed.SPMicroFeed.$N.get_hasPendingRequest()&&SP.UI.MicroFeed.SPMicroFeed.$N.executeQueryAsync(function(d,e){if(b){SP.UI.MicroFeed.SPMicroFeed.setCSOMDataInited();a&&SP.UI.MicroFeed.SPMicroFeed.$A3(a)}c(d,e)},function(a,c){if(b)SP.UI.MicroFeed.SPMicroFeed.$2p=false;d(a,c)})})};SP.UI.MicroFeed.SPMicroFeed.$9R=function(){var a=null,b=OpenSuiteLinksJson();if(b)try{a=JSON.parse(b)}catch(c){}if(a)if(typeof a.AdminLink!=="undefined"&&a.AdminLink)return true;return false};SP.UI.MicroFeed.SPMicroFeed.$9G=function(){var a=new SP.ClientRuntimeContext(_spPageContextInfo.webServerRelativeUrl),b=$get("ms-microfeedthreadviewthread");if(b){SP.UI.MicroFeed.SPMicroFeed.$1g=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(b));SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(SP.UI.MicroFeed.SPMicroFeed.$1g,false);b.parentNode.removeChild(b)}var c=$get("ms-microfeedinitialdata"),k=null;if(c){k=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(c));c.parentNode.removeChild(c)}var d=$get("ms-microfeedsitesfolloweddata");if(d){SP.UI.MicroFeed.SPMicroFeed.$27=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(d));d.parentNode.removeChild(d)}var e=$get("ms-microfeedcurrentuser");if(e){SP.UI.MicroFeed.SPMicroFeed.$41=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(e));e.parentNode.removeChild(e)}var f=$get("ms-microfeedisfeedactivitypublic");if(f){SP.UI.MicroFeed.SPMicroFeed.$5b=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(f));f.parentNode.removeChild(f)}var g=$get("ms-microfeedfileattachmentsenabled");if(g){SP.UI.MicroFeed.SPMicroFeed.$5a=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(g));g.parentNode.removeChild(g)}var h=$get("ms-microfeedmentions");if(h){SP.UI.MicroFeed.SPMicroFeed.maxResolvedMentions=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(h));h.parentNode.removeChild(h)}var i=$get("ms-microfeedtags");if(i){SP.UI.MicroFeed.SPMicroFeed.maxResolvedTags=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(i));i.parentNode.removeChild(i)}var j=$get("ms-microfeedcharlimit");if(j){SP.UI.MicroFeed.SPMicroFeed.characterLimit=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(j));j.parentNode.removeChild(j)}SP.UI.MicroFeed.SPMicroFeed.$9h(a);return k};SP.UI.MicroFeed.SPMicroFeed.$9h=function(d){var a=$get("ms-microfeedisfallbackmodeon");if(a){SP.UI.MicroFeed.SPMicroFeed.$45=d.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(a));a.parentNode.removeChild(a)}if(SP.UI.MicroFeed.SPMicroFeed.$45){var b=$get("ms-microfeedfallbacksitesnameurlpairs");if(b){SP.UI.MicroFeed.SPMicroFeed.$42=d.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(b));b.parentNode.removeChild(b)}var c=$get("ms-microfeedfallbackusersnameurlpairs");if(c){SP.UI.MicroFeed.SPMicroFeed.$43=d.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(c));c.parentNode.removeChild(c)}}};SP.UI.MicroFeed.SPMicroFeed.$62=function(c,j){var d=document.createElement("div"),h=true;d.className="ms-microfeed-fallbackTitle ms-webpart-titleText";var k=j?SpsClient.ScriptResources.cacheFallbackSitesText:SpsClient.ScriptResources.cacheFallbackPeopleText;SP.UI.MySiteCommon.CommonUIElements.setElementText(d,k);c.appendChild(d);var l=j?SP.UI.MicroFeed.SPMicroFeed.$42:SP.UI.MicroFeed.SPMicroFeed.$43,f=l;for(var g in f){var i={key:g,value:f[g]},b=document.createElement("div");b.className="ms-microfeed-fallbackEntity";var m=i.key,n=i.value;c.appendChild(b);var a=document.createElement("a");a.setAttribute("href",n);a.setAttribute("target","_blank");a.className="ms-listlink";SP.UI.MySiteCommon.CommonUIElements.setElementText(a,m);b.appendChild(a);c.appendChild(b);h=false}if(h){var e=document.createElement("div");SP.UI.MySiteCommon.CommonUIElements.setElementText(e,SpsClient.ScriptResources.cacheFallbackNoRecentActivityMessage);e.className="ms-microfeed-fallbackEntity";c.appendChild(e)}};SP.UI.MicroFeed.SPMicroFeed.$8j=function(b){var a=document.createElement("div");SP.UI.MicroFeed.SPMicroFeed.$62(a,true);SP.UI.MicroFeed.SPMicroFeed.$62(a,false);b.appendChild(a)};SP.UI.MicroFeed.SPMicroFeed.$61=function(e,f){var a=document.createElement("div");a.className="ms-status-blue ms-status-msg";a.setAttribute("aria-live","polite");a.setAttribute("aria-relevant","all");var b=document.createElement("span");b.className="ms-status-status";b.setAttribute("role","alert");var c=document.createElement("span");c.className="ms-status-body";var d=f?SpsClient.ScriptResources.cacheFallbackBannerMessage:SpsClient.ScriptResources.cacheFallbackNoFollowedEntitiesMessage;c.appendChild(document.createTextNode(d));b.appendChild(c);a.appendChild(b);e.appendChild(a)};SP.UI.MicroFeed.SPMicroFeed.switchToCompanyFeedView=function(){SP.UI.MicroFeed.SPMicroFeed.microfeed.changeView(SP.UI.MicroFeed.SPMicroFeed.$23)};SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID=function(a){return a.substr(a.lastIndexOf("_")+1)};SP.UI.MicroFeed.SPMicroFeed.initializeWhatsNew=function(g,f,h){var b="",c="",d="",e="",a=$get(SP.UI.MicroFeed.SPMicroFeed.$22);if(a){b=a.getAttribute("unreadMentionCount");c=a.getAttribute("errorString");d=a.getAttribute("statusCode");e=a.getAttribute("isPubFeedOnly")}else return;if(e==="false"){SP.UI.MicroFeed.SPMicroFeed.microfeed=new SP.UI.MicroFeed.SPMicroFeed(1,g,f);!SP.ScriptHelpers.isNullOrEmptyString(b)&&SP.UI.MicroFeed.SPMicroFeed.microfeed.$29_0(Number.parseInvariant(b));SP.UI.MicroFeed.SPMicroFeed.microfeed.$M_0="";SP.UI.MicroFeed.SPMicroFeed.microfeed.initialize(h,true,"","",c?c:"",d?d:"")}};SP.UI.MicroFeed.SPMicroFeed.initializePublishedFeed=function(h,i,k,j,l,m,c,g){var d="",e="",a=$get(SP.UI.MicroFeed.SPMicroFeed.$22);if(a){d=a.getAttribute("errorString");e=a.getAttribute("statusCode")}else return;var b=false;if(m)b=true;SP.UI.MicroFeed.SPMicroFeed.microfeed=new SP.UI.MicroFeed.SPMicroFeed(b?2:0,k,j);if(b&&c)SP.UI.MicroFeed.SPMicroFeed.microfeed.$M_0=c;if(!g)SP.UI.MicroFeed.SPMicroFeed.microfeed.$K_0=false;var f=false;if(l&&SP.UI.MicroFeed.SPMicroFeed.microfeed.$K_0)f=true;SP.UI.MicroFeed.SPMicroFeed.microfeed.initialize(f,true,h,i,d||"",e||"")};SP.UI.MicroFeed.SPMicroFeed.$2v=function(b){var c=SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(b.id),d=SP.UI.MicroFeed.SPMicroFeed.$P[c],a=$get(b.id===SP.UI.MicroFeed.SPMicroFeed.$1L?SP.UI.MicroFeed.SPMicroFeed.$3u:SP.UI.MicroFeed.SPMicroFeed.$3Q+c);if(a){d.setElementHighlights(a);a.style.height=b.clientHeight+"px"}};SP.UI.MicroFeed.SPMicroFeed.$4F=function(b,c,d){var a=document.createElement("button");a.id=c;a.setAttribute("type","button");a.className=d;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,b);return a};SP.UI.MicroFeed.SPMicroFeed.$1j=function(e,f,g,d,h,i,j){var a=document.createElement("img");a.id=d+"_Image";a.src=e;a.alt=f;a.className=j;var b=document.createElement("span");b.id=d+"_Span";b.className=i;b.appendChild(a);var c=SP.UI.MicroFeed.SPMicroFeed.$4F("",d,h);c.title=g;c.appendChild(b);return c};SP.UI.MicroFeed.SPMicroFeed.$64=function(j,a){var b=document.createElement("div");b.id=!a?SP.UI.MicroFeed.SPMicroFeed.$1z:SP.UI.MicroFeed.SPMicroFeed.$1m+a;b.className=SP.UI.MicroFeed.SPMicroFeed.$7g;var g=document.createElement("div");g.id=!a?SP.UI.MicroFeed.SPMicroFeed.$7h:SP.UI.MicroFeed.SPMicroFeed.$70+a;g.className=SP.UI.MicroFeed.SPMicroFeed.$5N;var h=document.createElement("div");h.id=!a?SP.UI.MicroFeed.SPMicroFeed.$7d:SP.UI.MicroFeed.SPMicroFeed.$6z+a;h.className=SP.UI.MicroFeed.SPMicroFeed.$5N;var c=SP.UI.MicroFeed.SPMicroFeed.$4G(!a?SP.UI.MicroFeed.SPMicroFeed.$21:SP.UI.MicroFeed.SPMicroFeed.$1o+a,SP.UI.MicroFeed.SPMicroFeed.$5O),d=SP.UI.MicroFeed.SPMicroFeed.$4G(!a?SP.UI.MicroFeed.SPMicroFeed.$3s:SP.UI.MicroFeed.SPMicroFeed.$3N+a,SP.UI.MicroFeed.SPMicroFeed.$5O),i=SP.UI.MicroFeed.SPMicroFeed.$1j(SP.UI.MicroFeed.SPMicroFeed.get_$1O(),SpsClient.ScriptResources.cancelButtonText,SpsClient.ScriptResources.cancelButtonText,SP.UI.MicroFeed.SPMicroFeed.$3v+(!a?"":"_"+a),SP.UI.MicroFeed.SPMicroFeed.$O+" "+SP.UI.MicroFeed.SPMicroFeed.$5X,SP.UI.MicroFeed.SPMicroFeed.$3y,SP.UI.MicroFeed.SPMicroFeed.$3x),e=document.createElement("div");e.id=!a?SP.UI.MicroFeed.SPMicroFeed.$20:SP.UI.MicroFeed.SPMicroFeed.$1n+a;e.className="ms-error ms-microfeed-linkErrorMessageDiv";var f=SP.UI.MicroFeed.SPMicroFeed.$1j(SP.UI.MicroFeed.SPMicroFeed.get_$2s(),SpsClient.ScriptResources.saveLinkButtonText,SpsClient.ScriptResources.saveLinkButtonText,!a?SP.UI.MicroFeed.SPMicroFeed.$3r:SP.UI.MicroFeed.SPMicroFeed.$3M+a,SP.UI.MicroFeed.SPMicroFeed.$O+" "+SP.UI.MicroFeed.SPMicroFeed.$5X,"ms-microfeed-editLinkButtonImageParent","ms-microfeed-editLinkButtonImage");$addHandler(i,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$9m(j,a)});$addHandler(f,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$A5(j,c,d,a)});$addHandler(c,"focus",function(){SP.UI.MicroFeed.SPMicroFeed.$7Y(c,f,i)});$addHandler(d,"focus",function(){SP.UI.MicroFeed.SPMicroFeed.$7Y(d,f,i)});$addHandler(c,"blur",function(){SP.UI.MicroFeed.SPMicroFeed.$9a(c,e,!a?j.id:a)});$addHandler(d,"blur",function(){SP.UI.MicroFeed.SPMicroFeed.$9Z(d,c,e)});$addHandler(c,"keydown",function(a){SP.UI.MicroFeed.SPMicroFeed.$7Z(a,f)});$addHandler(d,"keydown",function(a){SP.UI.MicroFeed.SPMicroFeed.$7Z(a,f)});SP.UI.MySiteCommon.CommonUIElements.setElementText(g,SpsClient.ScriptResources.linkUrlLabel);SP.UI.MySiteCommon.CommonUIElements.setElementText(h,SpsClient.ScriptResources.displayLinkAsLabel);b.appendChild(g);b.appendChild(c);b.appendChild(h);b.appendChild(d);b.appendChild(f);b.appendChild(i);b.appendChild(e);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e);return b};SP.UI.MicroFeed.SPMicroFeed.$7Y=function(a,b,c){a&&a.select();SP.UI.MySiteCommon.CommonUIElements.display(b);SP.UI.MySiteCommon.CommonUIElements.display(c)};SP.UI.MicroFeed.SPMicroFeed.$9a=function(a,e,f){var b=SP.UI.MicroFeed.SPMicroFeed.$P[f];if(!b||!a)return;var c=a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$16);if(!c)return;var d=b.linkUrlFromDisplayText(c);if(SP.ScriptHelpers.isNullOrEmptyString(a.value)&&d){a.value=d;SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e)}};SP.UI.MicroFeed.SPMicroFeed.$9Z=function(a,c,d){if(!c||!a)return;var b=c.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$16);if(SP.ScriptHelpers.isNullOrEmptyString(a.value)&&b){a.value=b;SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,d)}};SP.UI.MicroFeed.SPMicroFeed.$7Z=function(a,b){if(a.keyCode===13){b.click();a.preventDefault();a.stopPropagation()}};SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv=function(a){var b=a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$e);if(!SP.UI.MicroFeed.SPMicroFeed.$J[b]&&a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$1R)!=="true")SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);else SP.UI.MySiteCommon.CommonUIElements.display(a)};SP.UI.MicroFeed.SPMicroFeed.$7D=function(a){var b;b=SP.UI.MicroFeed.SPMicroFeed.$J[a?a:""];if(b){var c=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$2n:SP.UI.MicroFeed.SPMicroFeed.$2O+a),d;if(!b.get_attachmentKind())d=!a?SP.UI.MicroFeed.SPMicroFeed.$3q:SP.UI.MicroFeed.SPMicroFeed.$3L+a;else d=!a?SP.UI.MicroFeed.SPMicroFeed.$2j:SP.UI.MicroFeed.SPMicroFeed.$2P+a;if(c){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,c);var e=$get(d);e&&c.removeChild(e)}}return b};SP.UI.MicroFeed.SPMicroFeed.$9B=function(b){var a=SP.ScriptHelpers.getUrlQueryPairs(b);return a.type==="file"?2:0};SP.UI.MicroFeed.SPMicroFeed.$8m=function(c,d){var b=document.createElement("div");b.id=!d?SP.UI.MicroFeed.SPMicroFeed.$3q:SP.UI.MicroFeed.SPMicroFeed.$3L+d;var a=document.createElement("img");a.className="ms-microfeed-imageAttachmentPreview";a.src=c.get_previewUri();a.alt=c.get_name();b.appendChild(a);return b};SP.UI.MicroFeed.SPMicroFeed.$28=function(d,b){var e=SP.UI.MicroFeed.SPMicroFeed.$P[!b?d.id:b],c=$get(!b?SP.UI.MicroFeed.SPMicroFeed.$21:SP.UI.MicroFeed.SPMicroFeed.$1o+b);if(!e||!c)return;var a=e.get_linkToEdit();if(a&&a.startsWith("<")&&a.endsWith(">")&&c.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$16)!==a)SP.UI.MicroFeed.SPMicroFeed.$8x(d,b,a.substring(1,a.length-1));else!a&&c.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$16)&&SP.UI.MicroFeed.SPMicroFeed.$7O(d,b,-1)};SP.UI.MicroFeed.SPMicroFeed.$8x=function(k,a,c){var b=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$1z:SP.UI.MicroFeed.SPMicroFeed.$1m+a),d=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$21:SP.UI.MicroFeed.SPMicroFeed.$1o+a),f=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$3s:SP.UI.MicroFeed.SPMicroFeed.$3N+a),g=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$3r:SP.UI.MicroFeed.SPMicroFeed.$3M+a),e=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$20:SP.UI.MicroFeed.SPMicroFeed.$1n+a),i=$get(SP.UI.MicroFeed.SPMicroFeed.$3v+(!a?"":"_"+a)),h=SP.UI.MicroFeed.SPMicroFeed.$P[SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(k.id)];if(!b||!b.parentNode||!d||!f||!g||!c)return;if(e){e.innerHTML="";SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e)}SP.UI.MySiteCommon.CommonUIElements.display(b);b.parentNode.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$1R,"true");SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(b.parentNode);if(!h)return;var j=h.linkUrlFromDisplayText(c);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,g);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,i);d.value=j;f.value=c;d.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$16,c)};SP.UI.MicroFeed.SPMicroFeed.$9m=function(i,a){var e=SP.UI.MicroFeed.SPMicroFeed.$P[!a?i.id:a],b=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$21:SP.UI.MicroFeed.SPMicroFeed.$1o+a),f=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$3s:SP.UI.MicroFeed.SPMicroFeed.$3N+a),c=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$20:SP.UI.MicroFeed.SPMicroFeed.$1n+a),g=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$3r:SP.UI.MicroFeed.SPMicroFeed.$3M+a),h=$get(SP.UI.MicroFeed.SPMicroFeed.$3v+(!a?"":"_"+a));if(!e||!b||!f)return;var d=b.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$16);if(!d)return;b.value=e.linkUrlFromDisplayText(d);f.value=d;if(c){c.innerHTML="";SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,c)}SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,g);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,h)};SP.UI.MicroFeed.SPMicroFeed.$7O=function(c,a,e){var b=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$1z:SP.UI.MicroFeed.SPMicroFeed.$1m+a),f=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$21:SP.UI.MicroFeed.SPMicroFeed.$1o+a),d=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$20:SP.UI.MicroFeed.SPMicroFeed.$1n+a);if(!b||!b.parentNode)return;if(d){d.innerHTML="";SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,d)}SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);f&&f.removeAttribute(SP.UI.MicroFeed.SPMicroFeed.$16);b.parentNode.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$1R,"false");SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(b.parentNode);if(e>=0&&e<=c.value.length){c.blur();SP.UI.MySiteCommon.CommonUIElements.setCursorPosition(c,e)}c.focus()};SP.UI.MicroFeed.SPMicroFeed.$A5=function(h,i,j,f){var d=SP.UI.MicroFeed.SPMicroFeed.$P[!f?h.id:f],b=$get(!f?SP.UI.MicroFeed.SPMicroFeed.$20:SP.UI.MicroFeed.SPMicroFeed.$1n+f);if(!i||!j||!d||!b)return;var c=i.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$16);if(!c)return;var k=d.linkUrlFromDisplayText(c);b.innerHTML="";var a=j.value,e=i.value||"",g=e.toLowerCase()||"";if(SP.ScriptHelpers.isNullOrEmptyString(a)){if(c)j.value=e;a=e}if(a!==c&&d.hasLinkWithDisplayText(a)){if(b){SP.UI.MySiteCommon.CommonUIElements.setElementText(b,SpsClient.ScriptResources.duplicateLinkErrorMessage);SP.UI.MySiteCommon.CommonUIElements.display(b)}return}if(!g.startsWith("www.")&&!g.startsWith("http://")&&!g.startsWith("https://")){if(b){SP.UI.MySiteCommon.CommonUIElements.setElementText(b,SpsClient.ScriptResources.invalidLinkErrorMessage);SP.UI.MySiteCommon.CommonUIElements.display(b)}return}if(c===a&&c===d.getLinkWithDisplayText(c))a=e;d.updateLinkSelection(c,a,e);SP.UI.MicroFeed.SPMicroFeed.$7O(h,f,h.value.indexOf("<"+a+">")+a.length+2)};SP.UI.MicroFeed.SPMicroFeed.$8R=function(b,a){if(SP.UI.MicroFeed.SPMicroFeed.$1e)return;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var c=SP.UI.MicroFeed.SPMicroFeed.get_$D().getPreview(b);SP.UI.MicroFeed.SPMicroFeed.$1e=true;SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(SP.UI.MicroFeed.SPMicroFeed.$1e){SP.UI.MicroFeed.SPMicroFeed.$1e=false;if(c&&c.get_uri()){var f=!a;if(SP.UI.MicroFeed.SPMicroFeed.$J[a||""])return;var b=$get(f?SP.UI.MicroFeed.SPMicroFeed.$2n:SP.UI.MicroFeed.SPMicroFeed.$2O+a),g=$get(f?SP.UI.MicroFeed.SPMicroFeed.$b:SP.UI.MicroFeed.SPMicroFeed.$19+a),d=null;switch(c.get_attachmentKind()){case 1:d=SP.UI.MicroFeed.MicroFeedVideo.$6B(c,a);break;case 2:d=SP.UI.MicroFeed.MicroFeedDoc.$67(c,a)}if(d){SP.UI.MicroFeed.SPMicroFeed.$2B(d,b,null,true);SP.UI.MySiteCommon.CommonUIElements.display(b)}var e=a?a:"";SP.UI.MicroFeed.SPMicroFeed.$J[e]=c;g.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$e,e);b.parentNode.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$e,e);SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(b.parentNode)}}},function(){SP.UI.MicroFeed.SPMicroFeed.$1e=false})})};SP.UI.MicroFeed.SPMicroFeed.$8F=function(b,d,e){var c=e?$get(SP.UI.MicroFeed.SPMicroFeed.$b):$get(SP.UI.MicroFeed.SPMicroFeed.$19+d),a=SP.UI.MicroFeed.SPMicroFeed.$P[d];if(b.keyCode===13&&b.shiftKey&&c&&!c.disabled&&(!a||!a.get_isSuggestionMenuOpen()&&!a.get_isHandlingLinkEntry())){c.focus();c.click();b.preventDefault();b.stopPropagation()}a&&a.typeAheadKeyDownHandler(b)};SP.UI.MicroFeed.SPMicroFeed.createProgressDiv=function(){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$3I;a.className=SP.UI.MicroFeed.SPMicroFeed.$6s;a.appendChild(SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon(SP.UI.MicroFeed.SPMicroFeed.$6u,SP.UI.MicroFeed.SPMicroFeed.$6t));return a};SP.UI.MicroFeed.SPMicroFeed.$56=function(a,b){return b>0?String.format(SpsClient.ScriptResources.pivotControlViewTitleText,a,b):a};SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner=function(){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$3I);a&&SP.UI.MySiteCommon.CommonUIElements.display(a)};SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner=function(){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$3I);a&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,a)};SP.UI.MicroFeed.SPMicroFeed.drawEmptyFeedThreadWithGivenMessage=function(b,c){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$2K;a.className=SP.UI.MicroFeed.SPMicroFeed.$6Z;if(!SP.ScriptHelpers.isNullOrEmptyString(c)){a.innerHTML=b+"<br/><br/>";SP.UI.MySiteCommon.CommonUIElements.addTechnicalDetailsDiv(a,c,"_emptyfeed",null)}else a.innerHTML=b;return a};SP.UI.MicroFeed.SPMicroFeed.drawMinimalThread=function(c){SP.SOD.executeFunc("SP.DateTimeUtil.js","SP.DateTimeUtil.SPRelativeDateTime.getRelativeDateTimeString",null);var a=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(c,c.get_rootPost()),d=a.$2_0,b=SP.UI.MicroFeed.SPMicroFeed.createThreadDivWithoutHiding(null,d);b.appendChild(SP.UI.MicroFeed.SPMicroFeed.$92(a,d,a.$2_0));b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());return b};SP.UI.MicroFeed.SPMicroFeed.$8v=function(b){var a=0;if(b.get_attributes()&8)a=0;else if(b.get_attributes()&2)a=1;else if(b.get_attributes()&16)a=2;return a};SP.UI.MicroFeed.SPMicroFeed.$1t=function(a){return!a||!a.$a_0&&!a.$I_0};SP.UI.MicroFeed.SPMicroFeed.$1s=function(a){return a.get_actorType()===1||a.get_actorType()===2};SP.UI.MicroFeed.SPMicroFeed.$8G=function(b){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$1A+b),e=$get(SP.UI.MicroFeed.SPMicroFeed.$4z+b),c=null,d=null;if(!a||!e)return;if(a.getAttribute("expanded")){if(a){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1P+b));a.removeAttribute("expanded")}c=$get(SP.UI.MicroFeed.SPMicroFeed.$3U+b);if(c)c.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.expandRepliesText);d=$get(SP.UI.MicroFeed.SPMicroFeed.$3T+b);if(d)d.className=SP.UI.MicroFeed.SPMicroFeed.$3F}else{if(a){SP.UI.MySiteCommon.CommonUIElements.display(a);SP.UI.MySiteCommon.CommonUIElements.display($get(SP.UI.MicroFeed.SPMicroFeed.$1P+b));a.setAttribute("expanded","true")}c=$get(SP.UI.MicroFeed.SPMicroFeed.$3U+b);if(c)c.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.collapseRepliesText);d=$get(SP.UI.MicroFeed.SPMicroFeed.$3T+b);if(d)d.className=SP.UI.MicroFeed.SPMicroFeed.$4c}};SP.UI.MicroFeed.SPMicroFeed.$99=function(a){var b=$get(SP.UI.MicroFeed.SPMicroFeed.$1A+a),c=$get(SP.UI.MicroFeed.SPMicroFeed.$2R+a);b&&!b.getAttribute("expanded")&&c&&!SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(c)&&SP.UI.MicroFeed.SPMicroFeed.$8G(a)};SP.UI.MicroFeed.SPMicroFeed.$8M=function(c){var b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$2R+c;var a=document.createElement("button");a.id=SP.UI.MicroFeed.SPMicroFeed.$4z+c;var d=document.createElement("span");d.id=SP.UI.MicroFeed.SPMicroFeed.$3U+c;var e=document.createElement("span");e.id=SP.UI.MicroFeed.SPMicroFeed.$7A+c;var f=document.createElement("img");f.id=SP.UI.MicroFeed.SPMicroFeed.$3T+c;b.className=SP.UI.MicroFeed.SPMicroFeed.$2N+" "+SP.UI.MicroFeed.SPMicroFeed.$4g;a.setAttribute("type","button");a.className=SP.UI.MicroFeed.SPMicroFeed.$O+" "+SP.UI.MicroFeed.SPMicroFeed.$4f;e.className=SP.UI.MicroFeed.SPMicroFeed.$4h;a.appendChild(e);f.setAttribute("src",SP.UI.MicroFeed.SPMicroFeed.get_$1O());f.className=SP.UI.MicroFeed.SPMicroFeed.$4c;e.appendChild(f);d.className="ms-microfeed-toggleRepliesText";d.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.collapseRepliesText);$addHandler(a,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$8G(c)});a.appendChild(d);b.appendChild(a);b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);return b};SP.UI.MicroFeed.SPMicroFeed.$5k=function(a,b,c){b=Math.max(b,0);a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$15,b);if(!b){a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$32,"false");a.setAttribute(SP.Microfeed.MicroBlogType.toString(8),"false")}else c&&a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$32,"true")};SP.UI.MicroFeed.SPMicroFeed.$5B=function(a){return!!a.get_likerInfo()&&a.get_likerInfo().get_includesCurrentUser()};SP.UI.MicroFeed.SPMicroFeed.createThreadDivWithoutHiding=function(b,c){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$1B+c;a.className=SP.UI.MicroFeed.SPMicroFeed.$75;a.setAttribute("LastModificationTime",b?""+b.get_rootPost().get_modifiedTime():"");if(SP.UI.MicroFeed.SPMicroFeed.$J&&(c||"")in SP.UI.MicroFeed.SPMicroFeed.$J)delete SP.UI.MicroFeed.SPMicroFeed.$J[c||""];b&&a.setAttribute(SP.Social.SocialThreadType.toString(b.get_threadType()),"true");return a};SP.UI.MicroFeed.SPMicroFeed.$6K=function(d){SP.UI.MicroFeed.SPMicroFeed.$5h(d);var b=null,e=null,c=0,f=0,a=null,g=null,h="";b=$get(SP.UI.MicroFeed.SPMicroFeed.$1A+d);if(!b)return;e=b.childNodes;f=e.length;c=f-1;while(c>=0){a=e[c];if(a.getAttribute("deleted")!=="true"){if(SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(a)){b.removeChild(a);SP.UI.MySiteCommon.CommonUIElements.display(a);SP.UI.MicroFeed.SPMicroFeed.$2B(a,b,null,false);c+=2}h=a.id.substr(a.id.indexOf("_")+1);g=$get(SP.UI.MicroFeed.SPMicroFeed.$4P+h);g&&SP.UI.MySiteCommon.CommonUIElements.display(g)}c--}b.setAttribute("expanded","true");SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$4d+d));f>2&&SP.UI.MySiteCommon.CommonUIElements.display($get(SP.UI.MicroFeed.SPMicroFeed.$2R+d));SP.UI.MicroFeed.SPMicroFeed.$5i(d)};SP.UI.MicroFeed.SPMicroFeed.$60=function(f,b,d,m){var a="",e="ms-microfeed-userThumbnailArea",g="";if(!m)e+=" ms-hide";if(d){var h=!b||!!b.$l_0;if(b&&!b.$n_0&&!SP.ScriptHelpers.isNullOrEmptyString(b.$11_0)){e+=" ms-microfeed-contentThumbnailArea";a=b.$11_0}else{var c=d.get_imageUri();if(!b||b.$n_0)if(!SP.ScriptHelpers.isNullOrEmptyString(c))if(!_spPageContextInfo.crossDomainPhotosEnabled||c.startsWith("/")||SP.UI.MicroFeed.SPMicroFeed.$9W(c))a=c;else{var k=!SP.ScriptHelpers.isNullOrEmptyString(_spPageContextInfo.webAbsoluteUrl)?SP.UI.MySiteCommon.CommonUIElements.ensureTrailingSlash(_spPageContextInfo.webAbsoluteUrl):"/";a=k+"_layouts/15/userphoto.aspx?size=S&url="+encodeURIComponent(c);if(!SP.ScriptHelpers.isNullOrEmptyString(d.get_accountName()))a+="&accountname="+encodeURIComponent(d.get_accountName());try{var l=SP.ScriptHelpers.getUrlQueryPairs(c),i=l.t;if(!SP.ScriptHelpers.isNullOrEmptyString(i))a+="&t="+i}catch(n){}}else a=SP.UI.MicroFeed.SPMicroFeed.$7z;else if(SP.UI.MicroFeed.SPMicroFeed.$1s(d))a=c;else a=SP.UI.MicroFeed.SPMicroFeed.$7R}if(b&&b.$l_0===2)g=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$4R+f,"ms-microfeed-iconImage",a,"");else if(!d.get_actorType())return SP.UI.MySiteCommon.PresenceManager.getLyncUserImageHTML(SP.UI.MicroFeed.SPMicroFeed.$2H+f,e+" "+(h?SP.UI.MicroFeed.SPMicroFeed.$6x:SP.UI.MicroFeed.SPMicroFeed.$74),d,a,h);else{var j=h?"36px":"48px";g=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$4R+f,"",a,'style="height:'+j+";width:"+j+'"')}}return SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("div",SP.UI.MicroFeed.SPMicroFeed.$2H+f,e)+g+"</div>"};SP.UI.MicroFeed.SPMicroFeed.$9W=function(a){if(!SP.UI.MicroFeed.SPMicroFeed.$q){SP.UI.MicroFeed.SPMicroFeed.$q=window.location.href;if(SP.UI.MicroFeed.SPMicroFeed.$q.lastIndexOf("/")>SP.UI.MicroFeed.SPMicroFeed.$q.indexOf("//")+1)SP.UI.MicroFeed.SPMicroFeed.$q=SP.UI.MicroFeed.SPMicroFeed.$q.substring(0,SP.UI.MicroFeed.SPMicroFeed.$q.indexOf("/",SP.UI.MicroFeed.SPMicroFeed.$q.indexOf("//")+2))}return a.toLowerCase().startsWith(SP.UI.MicroFeed.SPMicroFeed.$q.toLowerCase())};SP.UI.MicroFeed.SPMicroFeed.$92=function(a,d,e){var b=document.createElement("div"),c=null;a.$1w_0=false;a.$G_0=true;a.$8_0=d;a.$3_0=e;c=SP.UI.MicroFeed.SPMicroFeed.$7S(a);b.id=SP.UI.MicroFeed.SPMicroFeed.$1p+d;b.className=SP.UI.MicroFeed.SPMicroFeed.$3R;!SP.UI.MicroFeed.SPMicroFeed.$1t(a)&&c.appendChild(SP.UI.MicroFeed.SPMicroFeed.$8n(a,e,true));b.appendChild(c);return b};SP.UI.MicroFeed.SPMicroFeed.$7S=function(a){var b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$2M+a.$3_0;b.setAttribute("threadDivID",a.$8_0);var c=document.createElement("input");c.name=a.$2_0;c.type="hidden";b.appendChild(c);a.$G_0&&b.setAttribute("isRoot","true");var d=SP.UI.MicroFeed.SPMicroFeed.$4m;if(a.$0_0===4||a.$0_0===2||a.$0_0===7||a.$0_0===8){d+=" ms-microfeed-replyMessage";if(!a.$F_0)d+=" "+SP.UI.MicroFeed.SPMicroFeed.$2Q}b.className=d;a.$1w_0&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);return b};SP.UI.MicroFeed.SPMicroFeed.$1S=function(a){return!SP.UI.MicroFeed.SPMicroFeed.get_$Q()||SP.UI.MicroFeed.SPMicroFeed.$33(a.$A_0,SP.UI.MicroFeed.SPMicroFeed.get_$Q())};SP.UI.MicroFeed.SPMicroFeed.$33=function(a,b){return!a||!b||a.get_actorType()!==b.get_actorType()?false:!a.get_actorType()?a.get_accountName().toLowerCase()===b.get_accountName().toLowerCase():a.get_id()===b.get_id()};SP.UI.MicroFeed.SPMicroFeed.$8i=function(a){var b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$6w+a.$3_0;b.className=SP.UI.MicroFeed.SPMicroFeed.$6v;var c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$6T+a.$3_0;c.className="ms-microfeed-activityImageDiv";c.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML("ms-microfeed-activityImage_"+a.$3_0,"ms-microfeed-activityImage",a.$5_0.$11_0,"");if(a&&SP.UI.MicroFeed.SPMicroFeed.$1t(a)||SP.UI.MicroFeed.SPMicroFeed.$1t(a.$5_0)||a.$5_0.$a_0==="")b.className="ms-metadata";b.appendChild(c);b.innerHTML=b.innerHTML+a.$5_0.$a_0;return b};SP.UI.MicroFeed.SPMicroFeed.$68=function(a,c,d){var b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$3p+c;b.className=SP.UI.MicroFeed.SPMicroFeed.$3o;if(!OffSwitch.IsActive(SP.UI.MySiteCommon.CommonUIElements.encodeAttributeValueKillSwitchID))b.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$1c+c,d,a.get_previewUri()||a.get_uri(),'alt="'+STSHtmlEncode(a.get_name())+'"');else b.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$1c+c,d,a.get_previewUri()||a.get_uri(),'alt="'+a.get_name()+'"');SP.UI.MicroFeed.SPMicroFeed.$5n(b.firstChild,a,c);return b};SP.UI.MicroFeed.SPMicroFeed.$5n=function(f,a,c){var b=a.get_contentUri(),d=a.get_width(),e=a.get_height();if(a.get_clickAction()&&!SP.ScriptHelpers.isNullOrEmptyString(a.get_clickAction().get_actionUri())){b=a.get_clickAction().get_actionUri();d=a.get_clickAction().get_width();e=a.get_clickAction().get_height()}if(!SP.ScriptHelpers.isNullOrEmptyString(b)){f.style.cursor="pointer";$addHandler(f,"click",function(){SP.SOD.executeFunc("SP.UI.Dialog.js","SP.UI.Lightbox.showLightbox",function(){var h=document.createElement("div"),f=h;if(!SP.ScriptHelpers.isNullOrEmptyString(a.get_contentUri())){f.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("ms-microfeed-attachmentThumbnailLink_"+c,null,"ms-microfeed-attachmentThumbnailLink",a.get_contentUri(),null,false);f=f.firstChild}if(!OffSwitch.IsActive(SP.UI.MySiteCommon.CommonUIElements.encodeAttributeValueKillSwitchID))f.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$5K+c,"ms-microfeed-attachmentThumbnail",b,'alt="'+STSHtmlEncode(a.get_name())+'"');else f.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$5K+c,"ms-microfeed-attachmentThumbnail",b,'alt="'+a.get_name()+'"');var g=new SP.UI.LightboxOptions;g.title=a.get_name();g.html=h;g.width=d;g.height=e;SP.UI.Lightbox.showLightbox(g)})})}};SP.UI.MicroFeed.SPMicroFeed.$8n=function(a,b,j){var i=11,h=document.createElement("div"),c=document.createElement("div"),d=null,e=null,f=document.createElement("a");h.id=SP.UI.MicroFeed.SPMicroFeed.$4n+b;c.id=SP.UI.MicroFeed.SPMicroFeed.$3D+b;c.className=SP.UI.MicroFeed.SPMicroFeed.$6g;f.id="ms-viewthreadlink_"+b;c.appendChild(SP.UI.MicroFeed.SPMicroFeed.$6D(a,b,"",j,i,false));if(a.$I_0){var g=null;switch(a.$I_0.get_attachmentKind()){case 0:g=SP.UI.MicroFeed.SPMicroFeed.$68(a.$I_0,b,"ms-microfeed-smallAttachmentImage");break;case 1:g=SP.UI.MicroFeed.MicroFeedVideo.$69(a.$I_0,b);break;case 2:g=SP.UI.MicroFeed.MicroFeedDoc.$65(a.$I_0,b)}g&&c.appendChild(g)}d=SP.UI.MicroFeed.SPMicroFeed.$5s(a,i,b,false);if(a.$10_0>0){SP.UI.MicroFeed.SPMicroFeed.$s(d);e=document.createElement("span");e.id="ms-replycount_"+b;e.className="ms-microfeed-replyCountText ms-textSmall";SP.UI.MySiteCommon.CommonUIElements.setElementText(e,String.format(SP.Utilities.LocUtility.getLocalizedCountValue(SpsClient.ScriptResources.numRepliesText,SpsClient.ScriptResources.numRepliesTextIntervals,a.$10_0),a.$10_0));d.appendChild(e)}SP.UI.MicroFeed.SPMicroFeed.$s(d);if(!SP.ScriptHelpers.isNullOrEmptyString(a.$L_0)){f.className="ms-microfeed-viewThreadLink "+SP.UI.MicroFeed.SPMicroFeed.$5W;f.href=a.$L_0;SP.UI.MySiteCommon.CommonUIElements.setElementText(f,SpsClient.ScriptResources.viewFullThreadLinkText);d.appendChild(f)}c.appendChild(d);h.appendChild(c);return h};SP.UI.MicroFeed.SPMicroFeed.$8q=function(a,c,d){var b="";if(!a.$n_0)return b;b=SP.UI.MicroFeed.SPMicroFeed.$6F("ms-authorlabel_"+c,a.$A_0,!a.$m_0);if(a.$B_0&&(!a.$m_0||a.$5_0&&a.$5_0.$0_0===10)&&!d&&SP.UI.MicroFeed.SPMicroFeed.$1s(a.$B_0)&&!SP.ScriptHelpers.isNullOrEmptyString(a.$B_0.get_name()))b=String.format(SpsClient.ScriptResources.postTitleFormatString,b,SP.UI.MicroFeed.SPMicroFeed.$6F("ms-targetlabel_"+c,a.$B_0,!a.$m_0));return b};SP.UI.MicroFeed.SPMicroFeed.$6F=function(a,b,c){return SP.UI.MySiteCommon.PresenceManager.getLyncActorNameHTML(b,a,c?"ms-microfeed-userName ms-textLarge ms-subtleLink":"ms-microfeed-userName ms-textSmall ms-bold ms-subtleLink")};SP.UI.MicroFeed.SPMicroFeed.$6D=function(d,e,g,h,i,j){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$6Y+e;var f=d.$a_0,b="";a.className=SP.UI.MicroFeed.SPMicroFeed.$6X+(!SP.ScriptHelpers.isNullOrEmptyString(g)?" "+g:"");if(i!==11){b=SP.UI.MicroFeed.SPMicroFeed.$8q(d,e,j);if(b!=="")if(h)b+="<br/>";else b+="&nbsp; "}a.innerHTML=b;if(!SP.ScriptHelpers.isNullOrEmptyString(f)){var c=document.createElement("span");c.className=SP.UI.MicroFeed.SPMicroFeed.$4l;c.id=SP.UI.MicroFeed.SPMicroFeed.$6p+e;c.innerHTML=f.replace(new RegExp("\x0d?\x0a","g"),"<br/>");a.appendChild(c);!SP.ScriptHelpers.isNullOrEmptyString(d.$1F_0)&&SP.UI.MicroFeed.SPMicroFeed.$8L(d,e,a)}return a};SP.UI.MicroFeed.SPMicroFeed.$8L=function(f,d,e){var c=document.createElement("span");c.id="ms-microfeed-extraText_"+d;c.className=SP.UI.MicroFeed.SPMicroFeed.$4l;c.innerHTML=f.$1F_0.replace(new RegExp("\x0d?\x0a","g"),"<br/>");SP.UI.MySiteCommon.CommonUIElements.displayOrHide(c,false);var b=document.createElement("a");b.id="ms-microfeed-expandPost_"+d;b.className=SP.UI.MicroFeed.SPMicroFeed.$4b;SP.UI.MySiteCommon.CommonUIElements.setElementText(b,SpsClient.ScriptResources.expandPostButtonText);b.href="#";b.setAttribute("onclick","return false;");var a=document.createElement("a");a.id="ms-microfeed-collapsePost_"+d;a.className=SP.UI.MicroFeed.SPMicroFeed.$4b;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,SpsClient.ScriptResources.collapsePostButtonText);a.href="#";a.setAttribute("onclick","return false;");SP.UI.MySiteCommon.CommonUIElements.displayOrHide(a,false);$addHandler(b,"click",function(){SP.UI.MySiteCommon.CommonUIElements.displayOrHide(c,true);SP.UI.MySiteCommon.CommonUIElements.displayOrHide(b,false);SP.UI.MySiteCommon.CommonUIElements.displayOrHide(a,true)});$addHandler(a,"click",function(){SP.UI.MySiteCommon.CommonUIElements.displayOrHide(c,false);SP.UI.MySiteCommon.CommonUIElements.displayOrHide(b,true);SP.UI.MySiteCommon.CommonUIElements.displayOrHide(a,false)});e.appendChild(b);e.appendChild(c);e.appendChild(a)};SP.UI.MicroFeed.SPMicroFeed.$5q=function(b,a){if(a.$1T_0){b.addRootPostDropDownItem(SpsClient.ScriptResources.followUpDropDownText,function(){EnsureScriptFunc("sp.pageinstrumentation.js","SP.PageInstrumentation.Clicks",function(){SP.PageInstrumentation.Clicks.recordClickClientId("FollowUp",a.$2_0)});var c=document.createElement("span");c.innerHTML=a.$a_0+a.$1F_0;var b=SP.UI.UIUtility.getInnerText(c),d=255-String.format(SpsClient.ScriptResources.moreContentEllipsesNoSpace,"").length,e=b.length>255?String.format(SpsClient.ScriptResources.moreContentEllipsesNoSpace,b.substr(0,d)):b,f=String.format(SpsClient.ScriptResources.followUpTaskDescription,a.$A_0.get_name(),b);SP.UI.MicroFeed.SPMicroFeed.$8t(a,e,f)});return true}return false};SP.UI.MicroFeed.SPMicroFeed.$8t=function(a,b,c){SP.SOD.executeFunc("SP.WorkManagement.js","SP.WorkManagement.OM.TaskWriteResult",function(){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){!SP.UI.MicroFeed.SPMicroFeed.$1d&&SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);var e=new SP.WorkManagement.OM.SortableSessionManager(SP.UI.MicroFeed.SPMicroFeed.$N),f=e.createSession(),g=!a.$L_0?"":a.$L_0,d=f.createTask(b,c,"","",false,true,-1,g);SP.UI.MicroFeed.SPMicroFeed.$N.load(d);SP.UI.MicroFeed.SPMicroFeed.$N.load(d.get_result());SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){var a={txt:"",dt:"",img:null};if(d.get_error()||!d.get_result()){var b=new SP.UI.Notify.Notification(1,SpsClient.ScriptResources.followUpTaskCreatingFailed,false,"",null,a);b.Show(false)}else{a.txt=SpsClient.ScriptResources.followUpTaskCreatedNotificationSubText;var c=new SP.UI.Notify.Notification(1,SpsClient.ScriptResources.followUpTaskCreatedNotification,false,"",function(){window.location.href=SP.Utilities.Utility.getLayoutsPageUrl("MySite.aspx?MySiteRedirect=AllTasks")},a);c.Show(false)}},function(){var a={txt:"",dt:"",img:null},b=new SP.UI.Notify.Notification(1,SpsClient.ScriptResources.followUpTaskCreatingFailed,false,"",null,a);b.Show(false)})})})};SP.UI.MicroFeed.SPMicroFeed.$8u=function(a){switch(a.get_actorType()){case 2:return SpsClient.ScriptResources.hideSiteRootDropDownText;case 1:return SpsClient.ScriptResources.hideDocumentRootDropDownText;case 0:return SpsClient.ScriptResources.stopFollowingRootDropDownText;default:return String.format(SpsClient.ScriptResources.stopFollowingObjectDropDownText,a.get_name())}};SP.UI.MicroFeed.SPMicroFeed.$5p=function(g,d,i){SP.UI.MySiteCommon.SPSocialSwitch.reset();if(!SP.UI.MySiteCommon.SPSocialSwitch.isSPSocialEnabled())return 0;var e=0,c=[];if(d&&d.length>0)for(var h={},f=0;f<d.length;f++){var a=d[f];if(a.get_canFollow()){var b=a.get_id();if((!b||!b.length)&&a.get_accountName())b=a.get_accountName();if(b&&!(b in h)){if(SP.UI.MicroFeed.SPMicroFeed.$8P(g,a,i)){e++;c[c.length]=a}h[b]=true}}}e>0&&g.setOpenedCallback(function(){for(var a=0;a<c.length;a++)SP.UI.MicroFeed.SPMicroFeed.$8h(g,c[a])});return e};SP.UI.MicroFeed.SPMicroFeed.$8h=function(e,a){var b=!a.get_actorType()?SP.UI.People.PersonManager.getFollowState(a.get_accountName()):SP.UI.MicroFeed.SocialActorCache.isFollowedByMe(a.get_id()),c=String.format(SP.UI.MicroFeed.SPMicroFeed.$2T(a.get_actorType(),b),a.get_name()),d=String.format(SP.UI.MicroFeed.SPMicroFeed.$2T(a.get_actorType(),!b),a.get_name());e.updateMySiteMenuItemByName(c,d,function(){SP.UI.MicroFeed.SPMicroFeed.$3G(a,!b)})};SP.UI.MicroFeed.SPMicroFeed.$2T=function(b,a){return!b?a?SpsClient.ScriptResources.followLinkTextWithName:SpsClient.ScriptResources.stopFollowingLinkTextWithName:a?SpsClient.ScriptResources.followObjectDropDownText:SpsClient.ScriptResources.stopFollowingObjectDropDownText};SP.UI.MicroFeed.SPMicroFeed.$8P=function(d,a,e){if(!a||SP.UI.MicroFeed.SPMicroFeed.$33(a,SP.UI.MicroFeed.SPMicroFeed.get_$Q())||SP.UI.MicroFeed.SPMicroFeed.$33(a,e))return false;var b=!a.get_actorType()?SP.UI.People.PersonManager.getFollowState(a.get_accountName()):SP.UI.MicroFeed.SocialActorCache.isFollowedByMe(a.get_id());if(b)return false;var c=String.format(SP.UI.MicroFeed.SPMicroFeed.$2T(a.get_actorType(),true),a.get_name());d.addRootPostDropDownItem(c,function(){SP.UI.MicroFeed.SPMicroFeed.$3G(a,true)});return true};SP.UI.MicroFeed.SPMicroFeed.$8r=function(b){var a=document.createElement("a");a.id="ms-postLink_"+b;a.setAttribute("name","fullyOrphaned");a.className="ms-microfeed-activityPostLink "+SP.UI.MicroFeed.SPMicroFeed.$2L;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,SpsClient.ScriptResources.viewFullThreadText);a.setAttribute("href","#");a.setAttribute("onclick","return false;");return a};SP.UI.MicroFeed.SPMicroFeed.$4G=function(b,c){var a=document.createElement("input");a.id=b;a.className=c;a.type="text";return a};SP.UI.MicroFeed.SPMicroFeed.$9x=function(e,c,d){var a=$get("ms-threadLink_"+c),b=null;if(a){SP.UI.MySiteCommon.CommonUIElements.display(a);b=$get("ms-threadLinkInput_"+c);if(b){b.focus();b.select()}}else{a=document.createElement("div");a.id="ms-threadLink_"+c;a.className="ms-microfeed-threadLinkDiv ms-textSmall";a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.threadLinkDescriptorText);b=SP.UI.MicroFeed.SPMicroFeed.$4G("ms-threadLinkInput_"+c,"ms-microfeed-threadLinkInputBox");b.setAttribute("readonly","readonly");$addHandler(b,"blur",function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a)});a.appendChild(b);d.insertBefore(a,d.firstChild);SP.UI.MicroFeed.SPMicroFeed.$9p(b,e)}};SP.UI.MicroFeed.SPMicroFeed.$9p=function(a,b){a.focus();a.value=b&&b.$L_0?b.$L_0:"";a.select()};SP.UI.MicroFeed.SPMicroFeed.$34=function(e,o,s,p,q,t,r,u){var f=$get(SP.UI.MicroFeed.SPMicroFeed.$2M+e),j=$get(SP.UI.MicroFeed.SPMicroFeed.$4Q+e),b=document.createElement("div"),c=document.createElement("div"),k=document.createElement("div"),d=document.createElement("button"),g=document.createElement("button"),a=null,h=0,n=6,m=0,l=0,i=null;j&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,j);f&&$clearHandlers(f);d.id="ms-confConfirmButton_"+e;g.id="ms-confCancelButton_"+e;b.id="ms-confDiv_"+e;c.id="ms-confMessageDiv_"+e;b.className="ms-microfeed-confirmationDiv ms-shadow";c.className="ms-microfeed-confMessageDiv";d.className="ms-microfeed-confirmationDivButton ms-button-emphasize";g.className="ms-microfeed-confirmationDivButton ms-microfeed-cancelButton";k.className="ms-microfeed-confirmationButtonDiv";if(!SP.ScriptHelpers.isNullOrEmptyString(q)){c.innerHTML=STSHtmlEncode(p)+"<br/><br/>";SP.UI.MySiteCommon.CommonUIElements.addTechnicalDetailsDiv(c,q,"_"+e,null)}else SP.UI.MySiteCommon.CommonUIElements.setElementText(c,p);SP.UI.MySiteCommon.CommonUIElements.setElementText(d,t);if(!SP.ScriptHelpers.isNullOrEmptyString(r))d.title=r;SP.UI.MySiteCommon.CommonUIElements.setElementText(g,SpsClient.ScriptResources.cancelConfirmationDialogButtonText);k.appendChild(d);k.appendChild(g);c.appendChild(k);if(s){if(!SP.UI.MicroFeed.SPMicroFeed.$7F($get(SP.UI.MicroFeed.SPMicroFeed.$1A+o)))h=6;else h=31;b.className=b.className+" ms-microfeed-rootConfDiv";a=$get(SP.UI.MicroFeed.SPMicroFeed.$1B+o);if(a.previousSibling)a.previousSibling.className+=" ms-microfeed-noBottomBorder"}else{h=6;b.className=b.className+" ms-microfeed-replyConfDiv";a=f;i=$get(SP.UI.MicroFeed.SPMicroFeed.$1p+a.getAttribute("threadDivID"))}b.style.marginTop=h+"px";b.style.marginBottom=n+"px";a.className+=" "+SP.UI.MicroFeed.SPMicroFeed.$5Z;b.appendChild(c);a.parentNode.insertBefore(b,a);d.focus();m=a.style.pixelHeight;if(a.offsetHeight>0)m=a.offsetHeight;l=b.style.pixelHeight;if(b.offsetHeight>0)l=b.offsetHeight;l+=h+n;a.style.height=Math.max(l,m)+"px";$addHandler(d,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$81(f,j,b,a,i);u();a.style.height=""});$addHandler(g,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$81(f,j,b,a,i)});SP.UI.MicroFeed.SPMicroFeed.$8w(a);i&&SP.UI.MicroFeed.SPMicroFeed.$4J(i)};SP.UI.MicroFeed.SPMicroFeed.$81=function(b,c,d,a,e){d.parentNode.removeChild(d);if(a){a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$5Z,"");a.style.height="";if(a.previousSibling)a.previousSibling.className=a.previousSibling.className.replace("ms-microfeed-noBottomBorder","")}if(b&&c){$addHandler(b,"mouseover",function(){SP.UI.MySiteCommon.CommonUIElements.display(c)});$addHandler(b,"mouseout",function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,c)})}SP.UI.MicroFeed.SPMicroFeed.$96(a);e&&SP.UI.MicroFeed.SPMicroFeed.$6Q(e)};SP.UI.MicroFeed.SPMicroFeed.$4J=function(a){SP.UI.MicroFeed.SPMicroFeed.$38(a,"button",true)};SP.UI.MicroFeed.SPMicroFeed.$6Q=function(a){SP.UI.MicroFeed.SPMicroFeed.$38(a,"button",false)};SP.UI.MicroFeed.SPMicroFeed.$8w=function(a){SP.UI.MicroFeed.SPMicroFeed.$4J(a);SP.UI.MicroFeed.SPMicroFeed.$38(a,"a",true)};SP.UI.MicroFeed.SPMicroFeed.$96=function(a){SP.UI.MicroFeed.SPMicroFeed.$6Q(a);SP.UI.MicroFeed.SPMicroFeed.$38(a,"a",false)};SP.UI.MicroFeed.SPMicroFeed.$38=function(c,d,e){var a=null;a=c.getElementsByTagName(d);for(var b=0;b<a.length;b++)a[b].disabled=e};SP.UI.MicroFeed.SPMicroFeed.$6J=function(a){SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){SPAnimationUtility.BasicAnimator.FadeOut(a,function(){a.style.height=a.clientHeight+"px";a.style.width=a.clientWidth+"px";SPAnimationUtility.BasicAnimator.Resize(a,0,0,function(){if($get(a.id)){if(a.getAttribute("deleted")!=="true")SP.UI.MicroFeed.SPMicroFeed.$31(a);else SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);a.style.height="";a.style.width=""}},null)},null)})};SP.UI.MicroFeed.SPMicroFeed.$31=function(a){a.removeAttribute("deleted");SP.UI.MySiteCommon.CommonUIElements.display(a);SetOpacity(a,1)};SP.UI.MicroFeed.SPMicroFeed.$7F=function(c){var d=0,a=null;if(!c)return 0;a=c.childNodes;if(c.hasChildNodes())for(var b=0;b<a.length;b++){var e=a[b];if(!SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(e))d++}return d};SP.UI.MicroFeed.SPMicroFeed.$7P=function(b,e,d){var c=b.id.substr(b.id.indexOf("_")+1);if(SP.UI.MicroFeed.SPMicroFeed.$7F(b)===e){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$2R+c));var a=$get(SP.UI.MicroFeed.SPMicroFeed.$1P+c);if(a){SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){SPAnimationUtility.BasicAnimator.FadeOut(a,function(){a.style.height=a.clientHeight+"px";a.style.width=a.clientWidth+"px";SPAnimationUtility.BasicAnimator.Resize(a,0,a.clientWidth,function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);a.style.height="";a.style.width="";SetOpacity(a,1);d&&d()},null)},null)});return true}}return false};SP.UI.MicroFeed.SPMicroFeed.$7J=function(){var a=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,SpsClient.ScriptResources.lockThreadErrorMessage);a.set_okButtonText(SpsClient.ScriptResources.closeButtonText);a.set_hideCancelButton(true);a.show();SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()};SP.UI.MicroFeed.SPMicroFeed.$7E=function(i,d,f,j,a,g){var b=document.createElement("span");b.id=SP.UI.MicroFeed.SPMicroFeed.$4Z+a;var c="";if(d>0)c=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span",SP.UI.MicroFeed.SPMicroFeed.$4Y+a,SP.UI.MicroFeed.SPMicroFeed.$4X)+SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$4V+a,f?SP.UI.MicroFeed.SPMicroFeed.$4W:SP.UI.MicroFeed.SPMicroFeed.$4U,SP.UI.MicroFeed.SPMicroFeed.get_$2s(),"")+"</span>";c+=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span",SP.UI.MicroFeed.SPMicroFeed.$6e+a,"")+SP.UI.MicroFeed.SPMicroFeed.$9I(d,f,j,a,g)+"</span>";b.innerHTML=c;var h=SP.UI.MicroFeed.SPMicroFeed.$4x+a,e=SP.UI.MySiteCommon.CommonUIElements.findElementByID(b,h);d>0&&e&&g&&SP.UI.MicroFeed.AllLikerDisplayManager.createAllLikerCallout(i,e);return b};SP.UI.MicroFeed.SPMicroFeed.$9I=function(c,f,a,i,g){var b="",h=SP.UI.MicroFeed.SPMicroFeed.$4x+i,d=g?SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(h,SP.UI.MicroFeed.SPMicroFeed.$4S,"#",'title="'+STSHtmlEncode(SpsClient.ScriptResources.seeAllLikerTitle)+'"'):"",e=g?"</a>":"";if(!a){if(c>0)if(f)b+=c===1?STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYou):String.format(STSHtmlEncode(SP.Utilities.LocUtility.getLocalizedCountValue(SpsClient.ScriptResources.likeIndicatorNoNamesYouAndOthers_withAnchor,SpsClient.ScriptResources.likeIndicatorNoNamesYouAndOthers_withAnchorIntervals,c-1)),d,c-1,e);else b+=String.format(STSHtmlEncode(SP.Utilities.LocUtility.getLocalizedCountValue(SpsClient.ScriptResources.likeIndicatorNoNames_withAnchor,SpsClient.ScriptResources.likeIndicatorNoNames_withAnchorIntervals,c)),d,c,e)}else switch(c){case 0:break;case 1:if(f)b+=STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYou);else b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicator1Other),a[0]);break;case 2:if(f)b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYouAnd1Other),a[0]);else b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicator2Others),a[0],a[1]);break;case 3:if(f)b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYouAnd2Others),a[0],a[1]);else b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicator3Others_withAnchor),a[0],d,e);break;default:if(f)if(c===4)b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYouAnd3Others_withAnchor),a[0],d,e);else b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYouAndManyOthers_withAnchor),a[0],a[1],d,c-3,e);else b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorManyOthers_withAnchor),a[0],a[1],d,c-2,e)}return b};SP.UI.MicroFeed.SPMicroFeed.$s=function(b){var c=SP.UI.UIUtility.getInnerText(b);if(!SP.ScriptHelpers.isNullOrEmptyString(c)){var a=document.createElement("span");a.className=SP.UI.MicroFeed.SPMicroFeed.$7p;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,"");b.appendChild(a)}};SP.UI.MicroFeed.SPMicroFeed.$8N=function(b,f,h){SP.UI.MySiteCommon.SPSocialSwitch.reset();if(!b||!f||!SP.UI.MySiteCommon.SPSocialSwitch.isSPSocialEnabled())return null;var a=null,c=null;b.$S_0&&b.$S_0.sort(SP.UI.MicroFeed.MicrofeedEntry.actorComparison);if(!b.$i_0&&SP.UI.MicroFeed.SPMicroFeed.get_$Q()&&!SP.UI.MicroFeed.SPMicroFeed.$1S(b)&&!b.$A_0.get_actorType()&&b.$0_0!==10)a=b.$A_0;else if(b.$S_0)for(var e=0;e<b.$S_0.length;e++){var d=b.$S_0[e];if(!d.get_actorType()){if(!SP.UI.People.PersonManager.getFollowState(d.get_accountName())&&!SP.UI.MicroFeed.SPMicroFeed.$33(d,SP.UI.MicroFeed.SPMicroFeed.get_$Q())){a=d;break}}else if(!SP.UI.MicroFeed.SocialActorCache.isFollowedByMe(d.get_id())){a=d;break}}if(a&&a.get_canFollow())if(!a.get_actorType()){var g=SP.UI.People.FollowLinkManager.getLink(a.get_accountName());if(g)c=g.htmlForCustomLink("Microfeed_"+h+"_","Microfeed",false,true,true)}else{c=document.createElement("a");c.id=SP.UI.MicroFeed.SPMicroFeed.$6a+b.$3_0;c.setAttribute("href","#");c.setAttribute("onclick","return false;");c.setAttribute("name",SP.UI.MicroFeed.SPMicroFeed.$4j+a.get_id());c.innerHTML=STSHtmlEncode(String.format(SP.UI.MicroFeed.SPMicroFeed.$2T(a.get_actorType(),true),a.get_name()));$addHandler(c,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$3G(a,true)})}if(c){SP.UI.MicroFeed.SPMicroFeed.$s(f);c.className=SP.UI.MicroFeed.SPMicroFeed.$2L;f.appendChild(c);return a}return null};SP.UI.MicroFeed.SPMicroFeed.$5s=function(a,h,d,k){var f=document.createElement("div");f.id=SP.UI.MicroFeed.SPMicroFeed.$6i+d;f.className=SP.UI.MicroFeed.SPMicroFeed.$6h;if((h===1||h===6||h===11)&&!a.$F_0){var c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$4a+d;c.className=SP.UI.MicroFeed.SPMicroFeed.$6d;var j=null;if(h!==11)j=SP.UI.MicroFeed.SPMicroFeed.$5u(a.$y_0,c,true);c.setAttribute("numLikers",a.$k_0);c.appendChild(SP.UI.MicroFeed.SPMicroFeed.$7E(a,a.$k_0,a.$x_0,j,d,k));a.$k_0<=0&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,c);f.appendChild(c)}var e=document.createElement("span");e.id="ms-timesource_"+d;e.className="ms-metadata";var b=(a.$F_0&&a.$5_0?a.$5_0:a).$v_0,i=false;if(b){i=true;b=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span","ms-relativetime_"+d,"ms-microfeed-postedTime")+b+"</span>"}if(!SP.ScriptHelpers.isNullOrEmptyString(a.$1J_0)){i=true;var g=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span","ms-source_"+d,"");if(!SP.ScriptHelpers.isNullOrEmptyString(a.$1a_0))g+=SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("ms-sourcelink_"+d,a.$1J_0,"ms-subtleLink",a.$1a_0,'target="_blank"',true)+"</span>";else g+=STSHtmlEncode(a.$1J_0)+"</span>";if(b)e.innerHTML=String.format(STSHtmlEncode(SpsClient.ScriptResources.postFooter),b,g);else e.innerHTML=String.format(STSHtmlEncode(SpsClient.ScriptResources.postFooterOnlySource),g)}else if(b)e.innerHTML=b;i&&f.appendChild(e);return f};SP.UI.MicroFeed.SPMicroFeed.$5u=function(e,f,g){var d=["",""],c=0,b=0,a=null;if(e)for(c=0;c<e.length&&b<d.length;c++){a=e[c];if(!a||a.get_actorType())continue;d[b]=SP.UI.MicroFeed.SPMicroFeed.$55(a.get_name(),g?a.get_accountName():null);f.setAttribute("liker_"+b,a.get_name());g&&f.setAttribute("likerAccountName_"+b,a.get_accountName());b++}return d};SP.UI.MicroFeed.SPMicroFeed.$55=function(c,b){if(b){var a=SP.UI.People.PersonManager.getPerson(b);if(a)return SP.UI.MySiteCommon.PresenceManager.getLyncUserNameHTML(a,"ms-linkToLikers","ms-subtleLink")}return STSHtmlEncode(c)};SP.UI.MicroFeed.SPMicroFeed.$9F=function(a,d,e){var b=$get(SP.UI.MicroFeed.SPMicroFeed.$4w+a);if(!b){b=document.createElement("span");b.id=SP.UI.MicroFeed.SPMicroFeed.$4w+a;b.className=SP.UI.MicroFeed.SPMicroFeed.$73}var c=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span",SP.UI.MicroFeed.SPMicroFeed.$72+a,"")+SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span",SP.UI.MicroFeed.SPMicroFeed.$4Y+a,SP.UI.MicroFeed.SPMicroFeed.$4X)+SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$4V+a,e?SP.UI.MicroFeed.SPMicroFeed.$4W:SP.UI.MicroFeed.SPMicroFeed.$4U,SP.UI.MicroFeed.SPMicroFeed.get_$2s(),"")+"</span>"+SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span",SP.UI.MicroFeed.SPMicroFeed.$4u+a,"")+d+"</span></span>";b.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$4v+a,SP.UI.MicroFeed.SPMicroFeed.$4S,"#",'onclick="return false;" title="'+SpsClient.ScriptResources.seeAllLikerTitle+'"')+c+"</a>";return b};SP.UI.MicroFeed.SPMicroFeed.$5t=function(c,d,e,h,i){if(!c)return;var b=null,a=SP.UI.MicroFeed.SPMicroFeed.$9F(e,d,i);if(!a)return;if(!$get(a.id)){SP.UI.MicroFeed.SPMicroFeed.$s(c);c.appendChild(a)}b=a.previousSibling;if(d<=0){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b)}else{SP.UI.MySiteCommon.CommonUIElements.display(a);SP.UI.MySiteCommon.CommonUIElements.display(b);var f=SP.UI.MicroFeed.SPMicroFeed.$4v+e,g=SP.UI.MySiteCommon.CommonUIElements.findElementByID(a,f);SP.UI.MicroFeed.AllLikerDisplayManager.createAllLikerCallout(h,g)}};SP.UI.MicroFeed.SPMicroFeed.$9Y=function(b,c,d){var a=b.target.getAttribute("liked")==="true";EnsureScriptFunc("sp.pageinstrumentation.js","SP.PageInstrumentation.Clicks",function(){if(a)SP.PageInstrumentation.Clicks.recordClickClientId("Unlike",c);else SP.PageInstrumentation.Clicks.recordClickClientId("Like",c)});SP.UI.MySiteCommon.CommonUIElements.setElementText(b.target,a?SpsClient.ScriptResources.likeCommandText:SpsClient.ScriptResources.unlikeCommandText);b.target.disabled=true;SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var e=a?SP.UI.MicroFeed.SPMicroFeed.get_$D().unlikePost(c):SP.UI.MicroFeed.SPMicroFeed.get_$D().likePost(c);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){var f=e.get_status();if(f&&f!==5&&f!==8)SP.UI.MicroFeed.SPMicroFeed.$7V(b,a,null);else SP.UI.MicroFeed.SPMicroFeed.$7W(b,c,a,e,d)},function(f,e){if(e.get_errorCode()===5)SP.UI.MicroFeed.SPMicroFeed.$7W(b,c,a,null,d);else SP.UI.MicroFeed.SPMicroFeed.$7V(b,a,e)})})};SP.UI.MicroFeed.SPMicroFeed.$7W=function(l,o,c,m,n){var f=0,g=null,h=null,i=null,d=null,k="",b="",a=null,e=0;m&&SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(m,false);i=document.getElementsByName(o);for(var j=0;j<i.length;j++){f=c?-1:1;d=i[j].parentNode;k=d.getAttribute("threadDivID");b=d.id.substr(d.id.indexOf("_")+1);a=$get(SP.UI.MicroFeed.SPMicroFeed.$4T+b);h=$get(SP.UI.MicroFeed.SPMicroFeed.$1B+k);e=parseInt(h.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$15));if(!a)continue;if(c&&a.getAttribute("liked")==="true"){a.removeAttribute("liked");e=Math.max(e-1,0)}else if(!c&&a.getAttribute("liked")!=="true"){a.setAttribute("liked","true");e++}else continue;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,c?SpsClient.ScriptResources.likeCommandText:SpsClient.ScriptResources.unlikeCommandText);SP.UI.MicroFeed.SPMicroFeed.$5k(h,e,a===l.target);if(d.getAttribute("isRoot")==="true")SP.UI.MicroFeed.SPMicroFeed.$A4(c,f,b,n);else{g=$get(SP.UI.MicroFeed.SPMicroFeed.$4u+b);f+=!g?0:parseInt(SP.UI.UIUtility.getInnerText(g));SP.UI.MicroFeed.SPMicroFeed.$5t($get("ms-footer_"+b),f,b,n,!c)}}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();l.target.disabled=false};SP.UI.MicroFeed.SPMicroFeed.$A4=function(f,b,e,h){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$4a+e),c=$get(SP.UI.MicroFeed.SPMicroFeed.$4Z+e),d=["",""];b+=parseInt(a.getAttribute("numLikers"));a.setAttribute("numLikers",b);d[0]=SP.UI.MicroFeed.SPMicroFeed.$55(a.getAttribute("liker_"+0),a.getAttribute("likerAccountName_"+0));d[1]=SP.UI.MicroFeed.SPMicroFeed.$55(a.getAttribute("liker_"+1),a.getAttribute("likerAccountName_"+1));if(b>0){SP.UI.MySiteCommon.CommonUIElements.display(a);a.innerHTML="";c=SP.UI.MicroFeed.SPMicroFeed.$7E(h,b,!f,d,e,true);var g=!f&&b===1;if(g)SP.UI.MicroFeed.SPMicroFeed.$2B(c,a,ProcessImn,false);else{a.appendChild(c);ProcessImn()}}else SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){SPAnimationUtility.BasicAnimator.FadeOut(a,function(){a.style.paddingBottom="0";a.style.height=a.clientHeight+"px";a.style.width=a.clientWidth+"px";a.innerHTML="";SPAnimationUtility.BasicAnimator.Resize(a,0,0,function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);a.style.height="";a.style.width="";a.style.paddingBottom="";SetOpacity(a,1)},null)},null)})};SP.UI.MicroFeed.SPMicroFeed.$7V=function(c,b,d){if(d&&d.get_errorCode()===2)SP.UI.MicroFeed.SPMicroFeed.$35(function(){SP.UI.MicroFeed.SPMicroFeed.$5w(c,b)});else{var a=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,b?SpsClient.ScriptResources.unLikeErrorMessage:SpsClient.ScriptResources.likeErrorMessage);a.set_okButtonCallback(function(){SP.UI.MicroFeed.SPMicroFeed.$5w(c,b)});a.set_hideCancelButton(true);a.show()}};SP.UI.MicroFeed.SPMicroFeed.$5w=function(a,b){SP.UI.MySiteCommon.CommonUIElements.setElementText(a.target,b?SpsClient.ScriptResources.unlikeCommandText:SpsClient.ScriptResources.likeCommandText);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()};SP.UI.MicroFeed.SPMicroFeed.$9T=function(a){return!a?true:a.innerHTML===""||a.innerHTML===STSHtmlEncode(SpsClient.ScriptResources.replyLimitErrorText)};SP.UI.MicroFeed.SPMicroFeed.getTextBoxFocusDiv=function(a,b){if(b)return $get(SP.UI.MicroFeed.SPMicroFeed.$5T);else{var c=SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(a.id);return $get(SP.UI.MicroFeed.SPMicroFeed.$4t+c)}};SP.UI.MicroFeed.SPMicroFeed.$6S=function(c,d){var b=$get(c),a=SP.UI.MicroFeed.SPMicroFeed.getTextBoxFocusDiv(b,d);if(a)a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$5S,SP.UI.MicroFeed.SPMicroFeed.$2m);SP.UI.MicroFeed.SPMicroFeed.$14&&window.clearInterval(SP.UI.MicroFeed.SPMicroFeed.$44)};SP.UI.MicroFeed.SPMicroFeed.$A2=function(){if(!SP.UI.MicroFeed.SPMicroFeed.$N)SP.UI.MicroFeed.SPMicroFeed.$N=SP.ClientContext.get_current();var a=SP.UI.MicroFeed.SPMicroFeed.$25.getPeopleFollowedByMe();SP.UI.MicroFeed.SPMicroFeed.$N.load(a,"Include(DisplayName, AccountName, UserUrl, PictureUrl, Email, LatestPost, IsFollowed)");return a};SP.UI.MicroFeed.SPMicroFeed.$A3=function(b){if(!b)return;SP.UI.MicroFeed.BaseAtMention.setFollowedPeople(b);if(document.activeElement&&document.activeElement.className.indexOf(SP.UI.MicroFeed.SPMicroFeed.$3w)>-1){var a=SP.UI.MicroFeed.SPMicroFeed.$P[SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(document.activeElement.id)];a&&a.correctDropdownState()}SP.UI.MicroFeed.SPMicroFeed.$2o&&SP.UI.MicroFeed.SPMicroFeed.$2o()};SP.UI.MicroFeed.SPMicroFeed.$2G=function(a,b){SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){var c=$get(SP.UI.MicroFeed.SPMicroFeed.$2I);if(c)if(b)SPAnimationUtility.BasicAnimator.FadeIn(c,function(){a&&a()},null);else SPAnimationUtility.BasicAnimator.FadeOut(c,function(){a&&a()},null)})};SP.UI.MicroFeed.SPMicroFeed.$2B=function(a,b,j,k){if(!a||!b)return;var c=document.createElement("div"),d=0,e=0,f=a.style.zIndex,g=a.style.position,h=a.style.left,i=a.style.top;a.style.zIndex=1;a.style.position="absolute";a.style.left="0px";a.style.top="0px";SetOpacity(a,0);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,a);if(!k)b.insertBefore(a,b.firstChild);else b.appendChild(a);d=a.clientHeight;e=a.clientWidth;c.style.height="0px";c.style.width="0px";b.insertBefore(c,a);SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){SPAnimationUtility.BasicAnimator.Resize(c,d,e,function(){b.removeChild(c);a.style.left=h;a.style.top=i;a.style.zIndex=f;a.style.position=g;SP.UI.MicroFeed.SPMicroFeed.$89(a,2);SP.UI.MySiteCommon.CommonUIElements.display(a);SPAnimationUtility.BasicAnimator.FadeIn(a,j,null)},null)})};SP.UI.MicroFeed.SPMicroFeed.$89=function(c,d){if(!c)return;if(d>0){var a=c.childNodes;if(a)for(var e=a.length,b=0;b<e;b++)if(a[b].nodeType!==3){SetOpacity(a[b],1);SP.UI.MicroFeed.SPMicroFeed.$89(a[b],d-1)}}};SP.UI.MicroFeed.SPMicroFeed.$84=function(b,c,d){if(b){var a=$get(c);if(a&&a.parentNode){b.id=c;a.parentNode.replaceChild(b,a);SP.UI.MicroFeed.SPMicroFeed.$5n(b,d.get_attachment(),d.get_id())}}};SP.UI.MicroFeed.SPMicroFeed.$35=function(b){var a=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,SpsClient.ScriptResources.lossOfPermissionsDialogText);a.set_okButtonCallback(b);a.set_hideCancelButton(true);a.show()};SP.UI.MicroFeed.SPMicroFeed.$5h=function(b){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$3E+b);if(a){a.innerHTML="";a.appendChild(SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon("",""));return true}return false};SP.UI.MicroFeed.SPMicroFeed.$5i=function(b){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$3E+b);if(a)a.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$4e+b,SP.UI.MicroFeed.SPMicroFeed.$3F,SP.UI.MicroFeed.SPMicroFeed.get_$1O(),"")};SP.UI.MicroFeed.SPMicroFeed.$3G=function(a,b){SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();SP.UI.MicroFeed.SPMicroFeed.$4D(a,!b,false);var d=function(){SP.UI.MicroFeed.SPMicroFeed.$7K(a,b)},e=function(){SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();SP.UI.MicroFeed.SPMicroFeed.$4D(a,b,true)};if(!a.get_actorType()){var c=SP.UI.People.FollowLinkManager.getLink(a.get_accountName());if(c&&c.get_followingState()!==b)c.onClick("Microfeed");else SP.UI.MicroFeed.SPMicroFeed.$7K(a,b)}else if(a.get_actorType()===3)SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){if(b)SP.UI.MicroFeed.SPMicroFeed.get_$5c().followTag(a.get_tagGuid());else SP.UI.MicroFeed.SPMicroFeed.get_$5c().stopFollowingTag(a.get_tagGuid());SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(d,e)});else SP.SOD.executeFunc("followingcommon.js","SetFollowStatus",function(){SetFollowStatus(a.get_uri(),b,a.get_actorType()===1,d,e)})};SP.UI.MicroFeed.SPMicroFeed.$7K=function(a,b){if(!a.get_actorType()){var c=SP.UI.People.FollowLinkManager.getLink(a.get_accountName());c&&c.updateFromExternalSource(b,"Microfeed")}else{SP.UI.MicroFeed.SPMicroFeed.$4D(a,!b,true);SP.UI.MicroFeed.SocialActorCache.setIsFollowedByMeValue(a,b)}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()};SP.UI.MicroFeed.SPMicroFeed.$4D=function(a,e,f){if(a&&a.get_actorType())for(var d=document.getElementsByName(SP.UI.MicroFeed.SPMicroFeed.$4j+a.get_id()),c=0;c<d.length;c++){var b=d[c];if(b){SP.UI.MySiteCommon.CommonUIElements.setElementText(b,String.format(SP.UI.MicroFeed.SPMicroFeed.$2T(a.get_actorType(),e),a.get_name()));b.disabled=!f;$clearHandlers(b);$addHandler(b,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$3G(a,e)})}}};SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv=function(){var a=document.createElement("div");a.className="ms-clear";return a};SP.UI.MicroFeed.SPMicroFeed.prototype={$2Z_0:null,$6_0:0,get_webPartFeedType:function(){return this.$6_0},$M_0:null,get_targetID:function(){return this.$M_0},set_targetID:function(a){this.$M_0=a;return a},$K_0:false,get_hasWritePermission:function(){return this.$K_0},set_hasWritePermission:function(a){this.$K_0=a;return a},$w_0:false,$4_0:null,$2a_0:0,$E_0:null,$3f_0:null,$1Y_0:null,$1I_0:false,$3j_0:false,$1v_0:false,$3h_0:0,$7_0:0,$1W_0:0,$z_0:0,$1X_0:false,$1H_0:null,$1Z_0:0,$3k_0:null,$1x_0:null,$1V_0:null,$2Y_0:null,$1y_0:false,$3l_0:false,$2c_0:"",$2b_0:"",$2f_0:"",$2e_0:"",$T_0:null,$u_0:null,$5E_0:false,$3i_0:1,$H_0:"",initializeViewsAndThreadAttributes:function(){var b=null,a=[],c="</a>";if(this.$6_0===1){a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(0,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(1,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(2,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(4,"true");var g="SP.UI.MicroFeed.SPMicroFeed.switchToCompanyFeedView();";if(SP._yam)b=String.format(STSHtmlEncode(SpsClient.ScriptResources.yammerEmptyFeedDueToNoActivity),SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","",SP.UI.MySiteCommon.CommonUIElements.ensureTrailingSlash(_spPageContextInfo.webAbsoluteUrl)+SP.UI.MicroFeed.SPMicroFeed.$8B,""),c);else b=String.format(STSHtmlEncode(SpsClient.ScriptResources.emptyFeedDueToNoActivity),SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","",SP.UI.MySiteCommon.CommonUIElements.ensureTrailingSlash(_spPageContextInfo.webAbsoluteUrl)+SP.UI.MicroFeed.SPMicroFeed.$6n,""),c,SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","ms-link","#",'onclick="'+g+'return false;"'),c);this.$1W_0=this.$4_0.length;this.$4_0[this.$4_0.length]=SP.UI.MicroFeed.MicroFeedView.createView(a,1,SpsClient.ScriptResources.followingViewName,b,"");a=[];a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(0,"true");b=STSHtmlEncode(SpsClient.ScriptResources.emptyFeedDueToCacheIssues);SP.UI.MicroFeed.SPMicroFeed.$23=this.$4_0.length;this.$4_0[this.$4_0.length]=SP.UI.MicroFeed.MicroFeedView.createView(a,4,SpsClient.ScriptResources.companyFeedViewName,b,"");a=[];a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(3,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(0,"true");this.$z_0=this.$4_0.length;b=STSHtmlEncode(SpsClient.ScriptResources.emptyMentionView);this.$4_0[this.$4_0.length]=SP.UI.MicroFeed.MicroFeedView.createView(a,5,SpsClient.ScriptResources.mentionsViewName,b,STSHtmlEncode(SpsClient.ScriptResources.mentionsViewDescription))}a=[];a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(1,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(2,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(0,"true");var f="SP.UI.MicroFeed.SPMicroFeed.setFocusOnRootPostInputBox();";if(this.$6_0===1){b=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","ms-link","#",'onclick="'+f+'return false;"')+STSHtmlEncode(SpsClient.ScriptResources.emptyPublishedFeedViewLinkText)+c;b=String.format(STSHtmlEncode(SpsClient.ScriptResources.emptyPublishedFeedView),b)}else if(!this.$6_0)b=STSHtmlEncode(String.format(SpsClient.ScriptResources.emptyOtherUserFeed,this.$1x_0));else{var d="",e="";if(!SP.ScriptHelpers.isNullOrEmptyString(this.$M_0)){var h="SP.SOD.executeFunc('sharing.js', 'DisplaySharingDialog', function() { DisplaySharingDialog('"+SP.Utilities.HttpUtility.ecmaScriptStringLiteralEncode(this.$M_0)+"'); });";d=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","ms-link","#",'onclick="'+h+'return false;"');e=c}if(this.$K_0)b=String.format(SpsClient.ScriptResources.emptySiteFeed,d,e,SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","ms-link","#",'onclick="'+f+'return false;"'),c);else b=String.format(SpsClient.ScriptResources.emptySiteFeedWithNoPermissions,d,e)}this.$4_0[this.$4_0.length]=SP.UI.MicroFeed.MicroFeedView.createView(a,0,SpsClient.ScriptResources.publishedFeedViewName,b,"");if(this.$6_0===1){a=[];a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(1,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePair(SP.UI.MicroFeed.SPMicroFeed.$32,"true");b=STSHtmlEncode(SpsClient.ScriptResources.emptyMyLikesView);this.$4_0[this.$4_0.length]=SP.UI.MicroFeed.MicroFeedView.createView(a,0,SpsClient.ScriptResources.likesViewName,b,"")}},$2A_0:function(){return this.$1I_0||this.$3j_0||this.$6_0===2},initialize:function(a,d,g,h,e,b){this.$3k_0=g;this.$1x_0=h;if(this.$6_0===2)this.$H_0=SpsClient.ScriptResources.siteFeedRootTextBoxString;else this.$H_0=SpsClient.ScriptResources.postTextBoxString;var i=$get(SP.UI.MicroFeed.SPMicroFeed.$22),j=this;$addHandler(document.body,"click",function(a){!SP.UI.MicroFeed.BaseAtMention.$9S(a.target)&&SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector()});var k=this;SP.UI.People.FollowLinkManager.set_followCallback(function(b,c,e,d){if(d){var a=SP.UI.People.PersonManager.getPerson(b);if(a)if(c)SP.UI.MicroFeed.BaseAtMention.addFollowedPerson(a.get_accountName(),a.get_displayName());else SP.UI.MicroFeed.BaseAtMention.removeFollowedPerson(a.get_accountName(),a.get_displayName())}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()});var c=SP.UI.MicroFeed.SPMicroFeed.$9G();a=!!(a&((this.$6_0===1||this.$6_0===2)&&!SP.UI.MicroFeed.SPMicroFeed.$c));if(d){this.initializeViewsAndThreadAttributes();this.$87_0(0);if(!SP.UI.MicroFeed.SPMicroFeed.$c){if(!c)c=new SP.Social.SocialFeed;this.$9n_0(c)}}this.$5E_0=SP.UI.MicroFeed.SPMicroFeed.$9R();if(!SP.ScriptHelpers.isNullOrEmptyString(e)||!SP.ScriptHelpers.isNullOrEmptyString(b)){var f=0;if(!SP.ScriptHelpers.isNullOrEmptyString(b))f=Number.parseInvariant(b);this.$7I_0(e,f)}else{this.drawTheWebPart(a,d,i);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()}},$7I_0:function(c,d){var a=document.createElement("div");a.id="ms-ErrorMessage";var b=$get(SP.UI.MicroFeed.SPMicroFeed.$22);if(!b)return;if(SP.UI.MicroFeed.SPMicroFeed.$c){a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.individualThreadViewErrorText);b.appendChild(a);return}switch(d){case 16:a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.featureDisabledErrorMessage);!SP.ScriptHelpers.isNullOrEmptyString(c)&&SP.UI.MySiteCommon.CommonUIElements.addTechnicalDetailsDiv(a,String.format(SpsClient.ScriptResources.genericErrorMessage,c),"_featuredisabled",null);b.appendChild(a);break;case 9:if(this.$6_0!==2){a.innerHTML=this.$9C_0();b.appendChild(a);SP.UI.MicroFeed.SPMicroFeed.$1f=true;SP.UI.MicroFeed.SPMicroFeed.$12=false;SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(true)}break;case 10:if(this.$6_0!==2){a.innerHTML=SpsClient.ScriptResources.currentUserTriedAndFailedToCreateMySite;b.appendChild(a)}break;case 11:if(this.$6_0!==2){a.innerHTML=SpsClient.ScriptResources.currentUserCannotHaveMySite;b.appendChild(a)}break;case 12:break;case 7:a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.emptyFeedDueToCacheIssues);b.appendChild(a);break;default:a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.unknownErrorTitle);!SP.ScriptHelpers.isNullOrEmptyString(c)&&SP.UI.MySiteCommon.CommonUIElements.addTechnicalDetailsDiv(a,String.format(SpsClient.ScriptResources.genericErrorMessage,c),"_initialerror",null);b.appendChild(a)}},$9C_0:function(){var e="",f="";if(!SP.ScriptHelpers.isNullOrEmptyString(this.$2Y_0)&&SP.UI.MySiteCommon.CommonUIElements.isSafeURL(this.$2Y_0)){e=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$7t,"",this.$2Y_0,"");f="</a>"}var g="",h="",b="";if(!SP.ScriptHelpers.isNullOrEmptyString(this.$1V_0)&&SP.UI.MySiteCommon.CommonUIElements.isSafeURL(this.$1V_0)){g=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$7v,"",this.$1V_0,"");var i=SP.ScriptHelpers.replaceOrAddQueryString(this.$1V_0,"Section","Preferences");h=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$7u,"",i,"");b="</a>"}var c='<span class="ms-bold">',d="</span>",a='<h1 class="ms-core-pageTitle">'+STSHtmlEncode(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_Title)+"</h1><br/>";a+='<div class="ms-textLarge">'+String.format(STSHtmlEncode(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_EditProfileLinks),e,f,h,b,g,b)+"</div><br/>";a+='<div class="ms-microfeed-welcomeText">';a+="<div>"+STSHtmlEncode(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_MySiteHubs)+"</div>";a+="<div>"+String.format(STSHtmlEncode(SP._yam?SpsClient.ScriptResources.yammerCurrentUserDoesNotHaveMySite_NewsfeedHub:SpsClient.ScriptResources.currentUserDoesNotHaveMySite_NewsfeedHub),c,d)+"</div>";a+="<div>"+String.format(STSHtmlEncode(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_SkyDriveHub2),c,d)+"</div>";a+="<div>"+String.format(STSHtmlEncode(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_SitesHub),c,d)+"</div>";a+="</div>";return a},$9n_0:function(b){var a=new SP.UI.MicroFeed.MicrofeedThreadList;a.setThreadCollection(b,false,this.$1I_0);this.$E_0[this.$4_0[this.$7_0].$d_0]=a;this.$2A_0()&&this.$5e_0(b)},drawTheWebPart:function(h,g,a){if(SP.UI.MicroFeed.SPMicroFeed.$45)if(!SP.UI.MicroFeed.SPMicroFeed.$43&&!SP.UI.MicroFeed.SPMicroFeed.$42)SP.UI.MicroFeed.SPMicroFeed.$61(a,false);else{SP.UI.MicroFeed.SPMicroFeed.$61(a,true);SP.UI.MicroFeed.SPMicroFeed.$8j(a)}else{if(SP._yam&&this.$6_0===1){var c=document.createElement("div");c.setAttribute("class","ms-status-blue ms-status-msg");c.setAttribute("aria-live","polite");c.setAttribute("aria-relevant","all");var f=document.createElement("span");f.setAttribute("class","ms-status-status");f.setAttribute("role","alert");var d=document.createElement("span");d.setAttribute("class","ms-status-body");d.appendChild(document.createTextNode(SpsClient.ScriptResources.yammerMicroFeedReadOnly));d.appendChild(document.createTextNode(" "));var e=document.createElement("a");e.setAttribute("href","https://go.microsoft.com/fwlink/?LinkId=624733");e.setAttribute("target","_blank");e.setAttribute("title",SpsClient.ScriptResources.yammerMicroFeedReadOnlyMoreInfo);e.appendChild(document.createTextNode(SpsClient.ScriptResources.yammerMicroFeedReadOnlyMoreInfo));d.appendChild(e);f.appendChild(d);c.appendChild(f);a.appendChild(c)}g&&this.$6_0===2&&a.appendChild(this.$6O_0());if(h){a.appendChild(this.$91_0());var b=$get(SP.UI.MicroFeed.SPMicroFeed.$1L);if(b&&!SP.ScriptHelpers.isNullOrEmptyString(b.value)&&b.value!==this.$H_0){b.focus();SP.UI.MySiteCommon.CommonUIElements.setCursorPosition(b,b.value.length);SP.UI.MicroFeed.SPMicroFeed.$2v(b)}}if(g){a.appendChild(this.$8z_0());this.$w_0=true;SP.SOD.executeFunc("SP.DateTimeUtil.js","SP.DateTimeUtil.SPRelativeDateTime.getRelativeDateTimeString",null);SP.UI.MySiteCommon.PresenceManager.updateExistingImagesAndNamesWithPresence(this.$6_0===2?800:0)}}a.setAttribute("tabindex","0");a.setAttribute("role","region");a.setAttribute("aria-label",STSHtmlEncode(this.$9N_0()));SP.UI.MicroFeed.SPMicroFeed.$1f=true;SP.UI.MicroFeed.SPMicroFeed.$12=false},$9N_0:function(){var a="";if(!this.$6_0)a=String.format(SpsClient.ScriptResources.wallViewName,this.$1x_0);else a=String.format(SpsClient.ScriptResources.siteFeedTitleName);return a},changeView:function(a){if(a<0)return;var c=null,e=this.$4_0[this.$7_0],b=this.$4_0[a],d=$get(SP.UI.MicroFeed.SPMicroFeed.$b),f=false;if(!b)return;if(e.$r_0===b.$r_0){this.refreshTheFeed();return}if(this.$T_0){if(this.$7_0>=0)this.$T_0.AllOptions[this.$7_0].SelectedOption=false;this.$T_0.AllOptions[a].SelectedOption=true;this.$T_0.Render()}this.$1Y_0=null;this.resetNewPostNotifications();this.$1I_0=a===this.$1W_0;this.$3j_0=a===SP.UI.MicroFeed.SPMicroFeed.$23;if(e.$r_0===SpsClient.ScriptResources.mentionsViewName||b.$r_0===SpsClient.ScriptResources.mentionsViewName)f=true;SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();this.$87_0(a);if(b.$r_0===SpsClient.ScriptResources.mentionsViewName){c=$get(SP.UI.MicroFeed.SPMicroFeed.$1l);if(d)d.disabled=true;this.$1H_0=new Date;this.$52_0(true,c,true)}else if(b.$d_0===e.$d_0&&this.$1X_0)this.refreshCurrentFeedDataForNewView(f);else{c=$get(SP.UI.MicroFeed.SPMicroFeed.$1l);if(d)d.disabled=true;this.$1H_0=new Date;this.$52_0(this.$2A_0(),c,false)}},refreshCurrentFeedDataForNewView:function(h){var a=0,g=0,c=$get(SP.UI.MicroFeed.SPMicroFeed.$1Q),d=null,e=c.children,i=this.$4_0[this.$7_0],f=$get(SP.UI.MicroFeed.SPMicroFeed.$51);SP.UI.MicroFeed.SPMicroFeed.$2G(null,false);f.innerHTML=i.$2J_0;if(SP.ScriptHelpers.isNullOrEmptyString(f.innerHTML))SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,f);else SP.UI.MySiteCommon.CommonUIElements.display(f);d=$get(SP.UI.MicroFeed.SPMicroFeed.$2K);null!==d&&d.parentNode.removeChild(d);for(var b=0;b<e.length;b++)if(this.$4A_0(e[b])&&a<SP.UI.MicroFeed.SPMicroFeed.$1N){a++;SP.UI.MySiteCommon.CommonUIElements.display(e[b])}else{g++;SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e[b])}if(!a){c.appendChild(this.$2E_0(false));SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1k))}c.setAttribute("numHiddenThreads",g);SP.UI.MySiteCommon.CommonUIElements.display($get(SP.UI.MicroFeed.SPMicroFeed.$1k));a<SP.UI.MicroFeed.SPMicroFeed.$1N&&this.$48_0(c,SP.UI.MicroFeed.SPMicroFeed.$1N-a,0);h&&this.$8I_0();SP.UI.MicroFeed.SPMicroFeed.$2G(null,true);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();this.$1X_0=true},$8I_0:function(){var b=0,d=0,c=$get(SP.UI.MicroFeed.SPMicroFeed.$1Q),a=null;if(c&&c.childNodes)for(b=0;b<c.childNodes.length;b++){a=c.childNodes[b];if(a.getAttribute(SP.Social.SocialThreadType.toString(3))==="true")if(this.$7_0===this.$z_0&&d<this.$1Z_0){a.className+=" "+SP.UI.MicroFeed.SPMicroFeed.$3B;d++}else a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$3B,"")}this.$7_0===this.$z_0&&this.$29_0(0)},$8e_0:function(a){if(a.keyCode===37||a.keyCode===38||a.keyCode===39||a.keyCode===40)return;this.$2C_0(a.target)},$2C_0:function(a){if(!SP.ScriptHelpers.isNullOrEmptyString(a.style.height)&&a.style.height.toLowerCase()!=="auto")return;!SP.UI.MicroFeed.SPMicroFeed.$14&&$removeHandler(a,"propertychange",this.$$d_$8e_0);while(a.scrollHeight<=a.clientHeight&&a.rows>2)a.rows=a.rows-1;while(a.scrollHeight>a.clientHeight)a.rows=a.rows+1;!SP.UI.MicroFeed.SPMicroFeed.$14&&$addHandler(a,"propertychange",this.$$d_$8e_0);SP.UI.MicroFeed.SPMicroFeed.$2v(a)},$91_0:function(){var c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$7f;c.className=SP.UI.MicroFeed.SPMicroFeed.$7e+(this.$6_0===2?" ms-microfeed-siteFeedMicroBlogPart":"");var g=document.createElement("div");g.id=SP.UI.MicroFeed.SPMicroFeed.$5T;g.className=SP.UI.MicroFeed.SPMicroFeed.$5R+" "+SP.UI.MicroFeed.SPMicroFeed.$2m;g.style.position="relative";var m=document.createElement("div");m.id=SP.UI.MicroFeed.SPMicroFeed.$3u;m.className=SP.UI.MicroFeed.SPMicroFeed.$5P+" "+SP.UI.MicroFeed.SPMicroFeed.$7i;var a=document.createElement("textarea");a.id=SP.UI.MicroFeed.SPMicroFeed.$1L;a.style.position="relative";if(this.$6_0!==2){var k=document.createElement("div");k.id="ms-shareWithDiv";var f=new SP.UI.MicroFeed.MicrofeedMenu("ms-shareWithTarget","span","","",true,"ms-microfeed-mysitemenu-control ms-microfeed-mysitemenu-subtleEmphasis","ms-microfeed-mysitemenu-titleImage","ms-mysitemenu-link ms-microfeed-shareWithTarget",""),w=this;f.add(SpsClient.ScriptResources.shareWithEveryoneString,"","","",function(){w.$M_0="";a.setAttribute("targetDisplayName","");a.focus();return});f.addSeparator();if(!this.$8O_0(a,f)){var n=new SP.UI.MySiteCommon.MySiteMenuItem(null);n.set_enabled(false);n.set_text(SpsClient.ScriptResources.notFollowingAnySitesHelperText);f.appendMenuItem(n);f.addSeparator();var z=this;f.add(SpsClient.ScriptResources.createAGroupTargetString,"","","",function(){window.location.href=SP.Utilities.Utility.getLayoutsPageUrl("MySite.aspx?MySiteRedirect=AllSites");f.setSelection(0)})}var h=document.createElement("label");h.id="ms-shareWithLabel";k.className="ms-microfeed-shareWith";h.className="ms-microfeed-shareWithLabel ms-soften ms-textLarge";h.setAttribute("for","ms-mysitemenu-control_Link_ms-shareWithTarget");h.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.shareWithString)+"&nbsp;";k.appendChild(h);h.appendChild(f.render());c.appendChild(k)}var i=document.createElement("span");i.id=SP.UI.MicroFeed.SPMicroFeed.$5V;var b=SP.UI.MicroFeed.SPMicroFeed.$4F(SpsClient.ScriptResources.postCommandText,SP.UI.MicroFeed.SPMicroFeed.$b,SP.UI.MicroFeed.SPMicroFeed.$5U);b.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$e,"");var d=document.createElement("div");d.id=SP.UI.MicroFeed.SPMicroFeed.$3t;var e=document.createElement("label");e.id=SP.UI.MicroFeed.SPMicroFeed.$1K;e.className=SP.UI.MicroFeed.SPMicroFeed.$5L+" "+SP.UI.MicroFeed.SPMicroFeed.$2k;a.rows=2;a.className=SP.UI.MicroFeed.SPMicroFeed.$5P+" "+SP.UI.MicroFeed.SPMicroFeed.$2l+" "+SP.UI.MicroFeed.SPMicroFeed.$3w;a.title=SpsClient.ScriptResources.postBoxTitleText;if(!SP.ScriptHelpers.isNullOrEmptyString(this.$M_0))a.setAttribute("targetDisplayName",this.$1x_0);else a.setAttribute("targetDisplayName","");if(!SP.UI.MicroFeed.SPMicroFeed.$14){$addHandler(a,"keydown",this.$$d_$8e_0);$addHandler(a,"keyup",this.$$d_$8e_0);$addHandler(a,"propertychange",this.$$d_$8e_0);$addHandler(a,"input",this.$$d_$8e_0)}var x=this;$addHandler(a,"focus",function(){x.$6R_0(a.id,true,null)});var A=this;$addHandler(a,"blur",function(){SP.UI.MicroFeed.SPMicroFeed.$6S(a.id,true)});SP.UI.MySiteCommon.CommonUIElements.setElementText(a,this.$H_0);c.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());g.appendChild(m);g.appendChild(a);d.className="ms-microfeed-elementsNoFocus";d.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$e,"");d.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$1R,"false");SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,d);d.appendChild(SP.UI.MicroFeed.SPMicroFeed.$64(a,null));d.appendChild(this.$5z_0(a,b,null));g.appendChild(d);c.appendChild(g);i.className=SP.UI.MicroFeed.SPMicroFeed.$3z+" "+SP.UI.MicroFeed.SPMicroFeed.$7k;b.disabled=true;var y=this;$addHandler(b,"click",function(){y.$7y_0(null,"",SP.UI.MicroFeed.SPMicroFeed.$7D(null))});SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e);i.appendChild(e);i.appendChild(b);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);var j=SP.UI.MicroFeed.SPMicroFeed.$1j(SP.UI.MicroFeed.SPMicroFeed.get_$1O(),SpsClient.ScriptResources.attachPictureButtonText,SpsClient.ScriptResources.attachPictureButtonText,SP.UI.MicroFeed.SPMicroFeed.$3n,SP.UI.MicroFeed.SPMicroFeed.$2i+" "+SP.UI.MicroFeed.SPMicroFeed.$O,SP.UI.MicroFeed.SPMicroFeed.$5J,SP.UI.MicroFeed.SPMicroFeed.$5I);j.setAttribute("name",SP.UI.MicroFeed.SPMicroFeed.$3Z);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,j);var o=this;$addHandler(j,"click",function(){o.$2w_0(b,a,null,false);o.clearDefaultTextInPostBoxIfNeeded(a)});c.appendChild(j);if(SP.UI.MicroFeed.SPMicroFeed.get_$6G()){var l=SP.UI.MicroFeed.SPMicroFeed.$1j(SP.UI.MicroFeed.SPMicroFeed.get_$2s(),SpsClient.ScriptResources.attachFileButtonText,SpsClient.ScriptResources.attachFileButtonText,SP.UI.MicroFeed.SPMicroFeed.$3m,SP.UI.MicroFeed.SPMicroFeed.$2i+" "+SP.UI.MicroFeed.SPMicroFeed.$O,SP.UI.MicroFeed.SPMicroFeed.$5H,SP.UI.MicroFeed.SPMicroFeed.$5G);l.setAttribute("name",SP.UI.MicroFeed.SPMicroFeed.$3C);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,l);var p=this;$addHandler(l,"click",function(){p.$2w_0(b,a,null,true);p.clearDefaultTextInPostBoxIfNeeded(a)});c.appendChild(l)}c.appendChild(i);c.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());if(!SP.UI.MicroFeed.SPMicroFeed.$14){var q=this,r=this;$addHandlers(a,{keyup:function(){q.$17_0(a,e,b,q.$H_0)},change:function(){r.$17_0(a,e,b,r.$H_0)}})}var s=this,t=this,B=this,C=this,D=this;$addHandlers(a,{cut:function(){s.$2y_0(a,e,b,s.$H_0)},paste:function(){t.$2y_0(a,e,b,t.$H_0)},keyup:function(){SP.UI.MicroFeed.SPMicroFeed.$28(a,null)},click:function(){SP.UI.MicroFeed.SPMicroFeed.$28(a,null)},focus:function(){SP.UI.MicroFeed.SPMicroFeed.$28(a,null)}});var u=this,v=new SP.UI.MicroFeed.AtMention(a,SP.UI.MicroFeed.SPMicroFeed.maxResolvedMentions,SP.UI.MicroFeed.SPMicroFeed.maxResolvedTags,function(){u.$8E_0(a,b,d,e,u.$H_0)});SP.UI.MicroFeed.SPMicroFeed.$P[a.id]=v;var E=this;$addHandler(a,"keydown",function(b){SP.UI.MicroFeed.SPMicroFeed.$8F(b,a.id,true)});this.$9P_0(a,v);return c},$9P_0:function(a,b){if(this.$2c_0!==""&&this.$2b_0!==""){a.value="";b.addTextAreaElement(1,this.$2b_0,this.$2c_0,false);a.value=a.value+" "}if(this.$2f_0!==""&&this.$2e_0!==""){if(a.value===this.$H_0)a.value="";b.addTextAreaElement(2,this.$2f_0,this.$2e_0,false);a.value=a.value+" "}},$8O_0:function(d,c){if(SP.UI.MicroFeed.SPMicroFeed.$27&&SP.UI.MicroFeed.SPMicroFeed.$27.length>0){var a=new SP.UI.MySiteCommon.MySiteMenuItem(null);a.set_enabled(false);a.set_text(SpsClient.ScriptResources.teamSiteDropDownDescriptionText);c.appendMenuItem(a);for(var b=0;b<SP.UI.MicroFeed.SPMicroFeed.$27.length;b++)this.$8X_0(SP.UI.MicroFeed.SPMicroFeed.$27[b],d,c);return true}return false},$8X_0:function(b,d,g){if(!b)return;var c=b.get_name(),f=b.get_id(),e=this,a=new SP.UI.MySiteCommon.MySiteMenuItem(function(){e.$M_0=f;d.setAttribute("targetDisplayName",c);d.focus()});a.set_enabled(true);a.set_text(c);g.appendMenuItem(a)},clearDefaultTextInPostBoxIfNeeded:function(a){if(a&&a.value===this.$H_0)a.value=""},incrementNewPostCount:function(){this.$3h_0++},$2r_0:function(a,c,e){if(!a||!c)return;var b=a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$e),d=(b===""||!!b)&&SP.UI.MicroFeed.SPMicroFeed.$J[b];if((c.value.trim().length>0&&c.value!==e||d)&&SP.UI.MicroFeed.SPMicroFeed.get_$D()&&this.$1X_0)a.disabled=false;else a.disabled=true},$4N_0:function(b){var a=0;this.$1y_0=!b;var c=document.getElementsByName(SP.UI.MicroFeed.SPMicroFeed.$3Z);for(a=0;a<c.length;a++)c[a].disabled=!b;var d=document.getElementsByName(SP.UI.MicroFeed.SPMicroFeed.$3C);for(a=0;a<d.length;a++)d[a].disabled=!b},$5z_0:function(g,h,a){var b=document.createElement("div");b.id=!a?SP.UI.MicroFeed.SPMicroFeed.$2n:SP.UI.MicroFeed.SPMicroFeed.$2O+a;b.className=!a?"ms-microfeed-attachmentPreviewDiv":"ms-microfeed-attachmentReplyPreviewDiv";var f=document.createElement("div");f.className=SP.UI.MicroFeed.SPMicroFeed.$3z;var c=document.createElement("a");c.id="ms-microfeed-cancelImageAttachmentLink"+(!a?"":"_"+a);c.className=SP.UI.MicroFeed.SPMicroFeed.$3z+" "+SP.UI.MicroFeed.SPMicroFeed.$3y;c.href="#";c.setAttribute("onclick","return false;");var e=document.createElement("img");e.id="ms-microfeed-cancelImageAttachmentLinkImage"+(!a?"":"_"+a);e.src=SP.UI.MicroFeed.SPMicroFeed.get_$1O();e.className=SP.UI.MicroFeed.SPMicroFeed.$3x;c.appendChild(e);var d=this;$addHandler(c,"click",function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);var e=SP.UI.MicroFeed.SPMicroFeed.$J[a?a:""];if(e){var c;switch(e.get_attachmentKind()){case 0:c=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$3q:SP.UI.MicroFeed.SPMicroFeed.$3L+a);break;default:c=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$2j:SP.UI.MicroFeed.SPMicroFeed.$2P+a)}c&&b.removeChild(c)}d.$4N_0(true);delete SP.UI.MicroFeed.SPMicroFeed.$J[a?a:""];SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(b.parentNode);d.$2r_0(h,g,!a?d.$H_0:d.$U_0);g.focus()});f.appendChild(c);b.appendChild(f);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);return b},$2w_0:function(b,c,d,e){var a=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var f="SelectPicture2.aspx?Type=User&FeedAttachment=true";if(e)f+="&FileAttachment=true";a.$9s_0(SP.Utilities.Utility.getLayoutsPageUrl(f),b,c,d)})},$9s_0:function(d,e,f,b){if(!SP.UI.MicroFeed.SPMicroFeed.$J[b?b:""]){var a=new SP.UI.DialogOptions;a.autoSizeStartWidth=410;a.autoSize=true;a.url=d;var c=this;a.dialogReturnValueCallback=function(h,i){if(h===1){var a=i.split("|");if(!a||a.length<3)return;var g=a[0],j=a[1],k=a[2],d=new SP.Social.SocialAttachment;d.set_attachmentKind(SP.UI.MicroFeed.SPMicroFeed.$9B(g));d.set_uri(g);d.set_previewUri(j);d.set_name(k);c.displayAttachmentPreview(e,f,d,b)}};SP.UI.ModalDialog.showModalDialog(a)}},displayAttachmentPreview:function(d,f,c,a){var e=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$2n:SP.UI.MicroFeed.SPMicroFeed.$2O+a),b=null;switch(c.get_attachmentKind()){case 0:b=SP.UI.MicroFeed.SPMicroFeed.$8m(c,a);break;case 1:b=SP.UI.MicroFeed.MicroFeedVideo.$6B(c,a);break;case 2:b=SP.UI.MicroFeed.MicroFeedDoc.$67(c,a)}this.$4N_0(false);if(e&&b){SP.UI.MySiteCommon.CommonUIElements.display(e);SP.UI.MicroFeed.SPMicroFeed.$2B(b,e,null,true)}if(d){SP.UI.MySiteCommon.CommonUIElements.display(d);SP.UI.MySiteCommon.CommonUIElements.display(d);this.$2r_0(d,f,!a?this.$H_0:this.$U_0)}SP.UI.MicroFeed.SPMicroFeed.$J[a?a:""]=c;if(f){SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(e.parentNode);f.focus()}},$8E_0:function(a,b,c,d,e){this.$2C_0(a);this.$17_0(a,d,b,e);SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(c)},$9v_0:function(){this.$1v_0=true;this.$7w_0()},$7w_0:function(){window.clearInterval(this.$2a_0);var b=Math.max(new Date-this.$3f_0,0),a=this.$3i_0*6e4-b;if(a<=0){$get(SP.UI.MicroFeed.SPMicroFeed.$1l)&&this.$2A_0()&&this.$9k_0();this.$8C_0()}else this.$2a_0=window.setInterval(this.$$d_$7w_0,a)},$8C_0:function(){this.$1v_0=false;window.clearInterval(this.$2a_0)},$9k_0:function(){var e=this.$4_0[this.$7_0].$d_0,f=this.$E_0[e],c=new SP.UI.MicroFeed.MicrofeedThreadList,b=null,d=false,a=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var g,h;b=(h=a.$3X_0(2,false,g={val:d}),d=g.val,h);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(b){c.setThreadCollection(b,true,a.$1I_0);a.$3i_0=1;a.$5e_0(b);c.appendThreadList(f);a.$E_0[e]=c;a.updateNewPostNotifications()}d&&a.$29_0(b.get_unreadMentionCount())},function(){a.$3i_0++})})},$5e_0:function(a){if(a.get_threads()&&a.get_threads().length>0&&a.get_threads()[0]&&a.get_threads()[0].get_rootPost())this.$1Y_0=a.get_threads()[0].get_rootPost().get_modifiedTime()},$2y_0:function(a,f,g,h){var d=a.value,e=0,b=0,c=this;b=window.setInterval(function(){if(a.value!==d){window.clearInterval(b);c.$17_0(a,f,g,h);c.$2C_0(a)}e++>100&&window.clearInterval(b)},50)},$17_0:function(b,a,d,e){if(!b)return;if(a&&b.value.length>.9*SP.UI.MicroFeed.SPMicroFeed.characterLimit){var c=SP.UI.MicroFeed.SPMicroFeed.characterLimit-b.value.length;SP.UI.MySiteCommon.CommonUIElements.display(a);a.innerHTML=STSHtmlEncode(c.localeFormat("n0"));if(c<0)a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$2k,SP.UI.MicroFeed.SPMicroFeed.$5M);else a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$5M,SP.UI.MicroFeed.SPMicroFeed.$2k)}else SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);d&&this.$2r_0(d,b,e)},$8z_0:function(){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$1l;a.className=SP.UI.MicroFeed.SPMicroFeed.$6o;if(this.$6_0===1||this.$6_0===2){var b=this;$addHandler(a,"mouseover",function(){b.$88_0()})}this.$6_0!==2&&a.appendChild(this.$6O_0());if(SP.UI.MicroFeed.SPMicroFeed.$c)this.$90_0(a);else{this.$4K_0(a);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()}return a},$7y_0:function(a,k,d){var c=!a,b=$get(c?SP.UI.MicroFeed.SPMicroFeed.$1L:SP.UI.MicroFeed.SPMicroFeed.$3O+a);if(!b)return;var e=b.value,f=SP.UI.MicroFeed.SPMicroFeed.$P[SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(b.id)],g=$get(c?SP.UI.MicroFeed.SPMicroFeed.$b:SP.UI.MicroFeed.SPMicroFeed.$19+a),l=c?null:$get(SP.UI.MicroFeed.SPMicroFeed.$2H+SP.UI.MicroFeed.SPMicroFeed.$39+a),h=$get(SP.UI.MicroFeed.SPMicroFeed.$3t+(c?"":a)),m=$get(c?SP.UI.MicroFeed.SPMicroFeed.$1z:SP.UI.MicroFeed.SPMicroFeed.$1m+a);if(e.length>SP.UI.MicroFeed.SPMicroFeed.characterLimit){var j=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.postTooLongErrorTitle,String.format(SpsClient.ScriptResources.postTooLong,e.length,SP.UI.MicroFeed.SPMicroFeed.characterLimit)),n=this;j.set_okButtonCallback(function(){b.focus()});j.set_hideCancelButton(true);j.show();d&&this.displayAttachmentPreview(g,b,d,c?null:a);return}SP.UI.MicroFeed.SPMicroFeed.$1e=false;var i=new SP.Social.SocialPostCreationData;if(f){f.setPostContentAndDataLinks(i);f.reset()}i.set_attachment(d);b.value="";SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1K+(c?"":a)));d&&this.$4N_0(true);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,m);if(g)g.disabled=true;delete SP.UI.MicroFeed.SPMicroFeed.$J[a?a:""];if(h){h.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$1R,"false");SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(h)}if(c){b.rows=2;b.focus();SP.UI.MicroFeed.SPMicroFeed.$2v(b)}else this.$9l_0(a,c,l,b);this.$7x_0(i,e,a,SP.ScriptHelpers.isNullOrEmptyString(k)?SP.UI.MicroFeed.SPMicroFeed.microfeed.$M_0:k)},$93_0:function(){for(var a=0;a<this.$4_0.length;++a){var d=this.$4_0[a],e=this.$u_0?this.$u_0:d.$r_0,f=a===this.$z_0?this.$1Z_0:0,b=new ClientPivotControlMenuOption;b.DisplayText=SP.UI.MicroFeed.SPMicroFeed.$56(e,f);b.OnClickAction="SP.UI.MicroFeed.SPMicroFeed.microfeed.changeView("+a.toString()+");";this.$T_0.AddMenuOption(b)}var c=this;window.setTimeout(function(){c.$T_0.Render()},0)},$6O_0:function(){var c=document.createElement("div");c.id="ms-titlebararea";if(SP.UI.MicroFeed.SPMicroFeed.$c)return c;c.className="ms-microfeed-titleArea";var b=null,g=SP.UI.MicroFeed.SPMicroFeed.$76,k=SP.UI.MicroFeed.SPMicroFeed.createProgressDiv(),a=null,d=null,h=null,i=null;if(!this.$6_0){b=document.createElement("div");a=document.createElement("h2");a.id=SP.UI.MicroFeed.SPMicroFeed.$3S;a.className="ms-microfeed-feedTitleLabel ms-webpart-titleText";this.$u_0=String.format(SpsClient.ScriptResources.wallViewName,this.$1x_0);a.innerHTML=STSHtmlEncode(this.$u_0);b.appendChild(a);if(SP.UI.MicroFeed.SPMicroFeed.get_$Q()&&this.$3k_0===SP.UI.MicroFeed.SPMicroFeed.get_$Q().get_accountName()&&!SP.UI.MicroFeed.SPMicroFeed.$5b){d=document.createElement("span");d.id=SP.UI.MicroFeed.SPMicroFeed.$4r;d.className=SP.UI.MicroFeed.SPMicroFeed.$5Y+" ms-microfeed-privacyIcon";h=new SP.UI.MySiteCommon.MySitePrivacyIcon(SP.UI.MicroFeed.SPMicroFeed.$4r,SpsClient.ScriptResources.feedPrivacyIcon_Tooltip,this.$1V_0);i=h.render();d.innerHTML=i;b.appendChild(d)}}else if(this.$6_0===1){b=document.createElement("div");var f=document.createElement("div");f.id=SP.UI.MicroFeed.SPMicroFeed.$4y;f.className=SP.UI.MicroFeed.SPMicroFeed.$79;b.appendChild(f);var e=this;SP.SOD.executeFunc("clienttemplates.js","ClientPivotControl",function(){var a={};a.PivotParentId=SP.UI.MicroFeed.SPMicroFeed.$4y;a.PivotContainerId=SP.UI.MicroFeed.SPMicroFeed.$78;e.$T_0=new ClientPivotControl(a);e.$T_0.SurfacedPivotCount=3;e.$93_0()})}else{b=document.createElement("h2");a=document.createElement("a");a.id=SP.UI.MicroFeed.SPMicroFeed.$3S;a.className="ms-microfeed-feedTitleLabel ms-headerFont ms-microfeed-siteFeedTitleLabel";this.$u_0=String.format(SpsClient.ScriptResources.siteFeedTitleName);a.innerHTML=STSHtmlEncode(this.$u_0);var l=a;a.setAttribute("href","#");a.setAttribute("onclick","return false;");var j=this;$addHandler(a,"click",function(){j.refreshTheFeed()});b.appendChild(a);g+=" ms-webpart-titleText";c.className="ms-microfeed-siteFeedTitleArea"}b.id=SP.UI.MicroFeed.SPMicroFeed.$77;b.className=g;b.appendChild(k);b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());this.$6_0===1&&this.$29_0(this.$1Z_0);c.appendChild(b);return c},resetNewPostNotifications:function(){this.$3h_0=0;this.updateNewPostNotifications()},updateNewPostNotifications:function(){this.$8J_0(this.$7_0,this.$3h_0)},refreshTheFeed:function(){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$1l);if(a){this.$52_0(true,a,this.$7_0===this.$z_0);this.resetNewPostNotifications()}},$29_0:function(a){this.$1Z_0=a;this.$8J_0(this.$z_0,this.$1Z_0)},$8J_0:function(a,d){if(a<0)return;var e=this.$4_0[a],b=this.$u_0?this.$u_0:e.$r_0;if(this.$T_0){this.$T_0.AllOptions[a].DisplayText=SP.UI.MicroFeed.SPMicroFeed.$56(b,d);this.$T_0.Render()}else{var c=$get(SP.UI.MicroFeed.SPMicroFeed.$3S);if(c)c.innerHTML=STSHtmlEncode(SP.UI.MicroFeed.SPMicroFeed.$56(b,d))}},$4K_0:function(j){if(!j)return;var c=this.$85_0(),m=this.$4_0[this.$7_0],n=m.$d_0,g=this.$E_0[n],a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$1Q;var o=$get(SP.UI.MicroFeed.SPMicroFeed.$1L),e=document.createElement("div");e.id=SP.UI.MicroFeed.SPMicroFeed.$1k;var f=document.createElement("div");f.id=SP.UI.MicroFeed.SPMicroFeed.$4i;var d=document.createElement("button");d.id="ms-MoreThreadsButtonLabel";var h=document.createElement("span");h.id="ms-MoreThreadsButtonText";var l=null,b,i=0;a.className="ms-microfeed-threadsDiv";b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$51;b.className=SP.UI.MicroFeed.SPMicroFeed.$7B;b.innerHTML=this.$4_0[this.$7_0].$2J_0;c.appendChild(b);if(SP.ScriptHelpers.isNullOrEmptyString(b.innerHTML))SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);else SP.UI.MySiteCommon.CommonUIElements.display(b);if(!g){a.appendChild(this.$2E_0(true));c.appendChild(a);j.appendChild(c);SP.UI.MicroFeed.SPMicroFeed.$2G(null,true);this.$w_0=true;return}else if(!g.sizeAfterRemovingRecentDeletions())a.appendChild(this.$2E_0(false));else{i=this.$6N_0(a,g,0,SP.UI.MicroFeed.SPMicroFeed.$1N);!i&&a.appendChild(this.$2E_0(false))}c.appendChild(a);this.$1X_0=true;e.className=SP.UI.MicroFeed.SPMicroFeed.$6l;f.className=SP.UI.MicroFeed.SPMicroFeed.$6m;d.className=SP.UI.MicroFeed.SPMicroFeed.$O+" "+SP.UI.MicroFeed.SPMicroFeed.$5Y+" ms-commandLink";d.setAttribute("type","button");h.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.seeMorePostsText);d.appendChild(h);e.appendChild(d);f.appendChild(e);var k=this;$addHandler(d,"click",function(){var f=a.children,b=null,c=0,d=0,e=parseInt(a.getAttribute("numHiddenThreads"));if(e>0)for(d=0;d<f.length&&c<SP.UI.MicroFeed.SPMicroFeed.$1N;d++){b=f[d];if(b&&SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(b)&&b.getAttribute("deleted")!=="true")if(k.$4A_0(b)){c++;SP.UI.MySiteCommon.CommonUIElements.display(b)}}e=e-c;a.setAttribute("numHiddenThreads",""+e);c<SP.UI.MicroFeed.SPMicroFeed.$1N&&k.$48_0(a,SP.UI.MicroFeed.SPMicroFeed.$1N-c,0)});!i&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e);c.appendChild(f);c.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());j.appendChild(c);this.$7_0===this.$z_0&&this.$8I_0();SP.UI.MicroFeed.SPMicroFeed.$2G(null,true);l=$get(SP.UI.MicroFeed.SPMicroFeed.$b);this.$2r_0(l,o,this.$H_0);ProcessImn();this.$88_0()},$88_0:function(){var a=this.$2A_0();if(a&&!this.$1v_0)this.$9v_0();else!a&&this.$1v_0&&this.$8C_0()},$85_0:function(){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$2I),b=$get(SP.UI.MicroFeed.SPMicroFeed.$b);if(a)a.innerHTML="";else{a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$2I;a.style.left="0px";a.style.right="0px"}if(b){var c=b.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$e);this.$1y_0=!!SP.UI.MicroFeed.SPMicroFeed.$J[c]}else this.$1y_0=false;return a},$90_0:function(c){var d=this.$85_0(),b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$1Q;if(this.$3l_0){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$3V;a.className="ms-microfeed-unsubscribe ms-textXLarge";a.innerHTML=String.format(STSHtmlEncode(SpsClient.ScriptResources.unsubscribeConfirmationText),SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$50,"","#",'onclick="return false;"'),"</a>");var e=a.getElementsByTagName("a")[0];$addHandler(e,"click",this.$$d_$9z_0);c.insertBefore(a,c.firstChild)}b.appendChild(this.$36_0(SP.UI.MicroFeed.SPMicroFeed.$1g,false,false,true));ProcessImn();d.appendChild(b);c.appendChild(d);this.$w_0=true;this.$1X_0=true},$9z_0:function(){if(!SP.UI.MicroFeed.SPMicroFeed.$1g)return;var a=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){SP.UI.MicroFeed.SPMicroFeed.get_$D().suppressThreadNotifications(SP.UI.MicroFeed.SPMicroFeed.$1g.get_id());SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(a.$$d_$A1_0,a.$$d_$A0_0)})},$A1_0:function(){SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();var a=$get(SP.UI.MicroFeed.SPMicroFeed.$3V);a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.unsubscribeSuccess)},$A0_0:function(){SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();var a=$get(SP.UI.MicroFeed.SPMicroFeed.$3V);a.innerHTML=String.format(STSHtmlEncode(SpsClient.ScriptResources.unsubscribeFailure),SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$50,"","#",'onclick="return false;"'),"</a>");var b=a.getElementsByTagName("a")[0];$addHandler(b,"click",this.$$d_$9z_0)},$6N_0:function(d,g,k,j){if(!d||!g||!g.sizeAfterRemovingRecentDeletions())return 0;for(var a=null,e=0,b=null,f=0,c=false,i=null,h=k;h<g.size();h++){a=g.get(h);if(!a.get_rootPost()||!a.get_actors())continue;b=$get(SP.UI.MicroFeed.SPMicroFeed.$1B+a.get_id());if(b){c=true;i=new Date(Date.parse(b.getAttribute("LastModificationTime")));if(i>a.get_rootPost().get_modifiedTime())b=this.$4M_0(a,e>=j,b,false,null,false)}else b=this.$36_0(a,e>=j,false,false);!c&&d.appendChild(b);if(!SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(b)){if(!c)e++}else if(!c)f++;c=false;if(this.$1H_0>a.get_rootPost().get_modifiedTime())this.$1H_0=a.get_rootPost().get_modifiedTime()}if(d.getAttribute("numHiddenThreads"))f=parseInt(d.getAttribute("numHiddenThreads"))+f;d.setAttribute("numHiddenThreads",f);return e},$2E_0:function(b){if(b){var a=!SP.ScriptHelpers.isNullOrEmptyString(this.$2Z_0)?String.format(SpsClient.ScriptResources.genericErrorMessage,this.$2Z_0):"";return SP.UI.MicroFeed.SPMicroFeed.drawEmptyFeedThreadWithGivenMessage(STSHtmlEncode(SpsClient.ScriptResources.emptyFeedDueToError),a)}else return SP.UI.MicroFeed.SPMicroFeed.drawEmptyFeedThreadWithGivenMessage(this.$4_0[this.$7_0].$37_0,"")},$95_0:function(c,e){var a=c.$2_0,b=this.createThreadDiv(null,a,e,true),d=document.createElement("div");d.id=SP.UI.MicroFeed.SPMicroFeed.$1p+a;d.className=SP.UI.MicroFeed.SPMicroFeed.$3R;c.$0_0=3;c.$8_0=a;d.appendChild(this.$18_0(c));b.appendChild(d);b.appendChild(this.$4L_0(null,a,false,true,false,false));b.appendChild(this.$6L_0(0,false,a,a,c.$B_0?c.$B_0.get_name():""));b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());b.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$15,0);return b},$9r_0:function(e){for(var c=this.$4_0[this.$7_0],d=SP.Social.SocialThreadType.toString(e.get_threadType()),a,b=0;b<c.get_numVisiblePosts();b++){a=c.visiblePostAttribute(b);if(a.$2X_0===d)if(a.$2t_0==="true")return true}return false},$4A_0:function(e){for(var c=this.$4_0[this.$7_0],d="",a,b=0;b<c.get_numVisiblePosts();b++){a=c.visiblePostAttribute(b);d=e.getAttribute(a.$2X_0);if(d===a.$2t_0)return true}return false},$36_0:function(a,i,j,k){var d=a.get_id(),b=this.createThreadDiv(a,d,i,j),e=a.get_replies().length,g=a.get_totalReplyCount(),f=0,c=null,h=null;b.appendChild(this.$94_0(a,j,d));if(SP.UI.MicroFeed.SPMicroFeed.$5B(a.get_rootPost()))f++;if(a.get_postReference()&&a.get_postReference().get_digest()){g=a.get_postReference().get_digest().get_totalReplyCount();e=a.get_postReference().get_digest().get_replies().length}var l=a.get_actors()[a.get_rootPost().get_authorIndex()];if(!SP.UI.MicroFeed.SPMicroFeed.$1s(l)){h=this.$8U_0(a,i,d,b,e,g,k);c=this.$4L_0(a,d,false,e>=g&&e<=2||k,a.get_threadType()===1||a.get_threadType()===2?true:false,false);(!e||!(c.hasChildNodes()||h&&h.hasChildNodes()))&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,c);f+=parseInt(c.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$15));c.removeAttribute(SP.UI.MicroFeed.SPMicroFeed.$15);b.appendChild(c);if(a.get_threadType()===1)f++;SP.UI.MicroFeed.SPMicroFeed.$5k(b,f,true);this.$4A_0(b)&&!i&&SP.UI.MySiteCommon.CommonUIElements.display(b);b.appendChild(this.$6M_0(a,d))}b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());return b},$6M_0:function(a,f){var b=a;if((a.get_threadType()===1||a.get_threadType()===2||a.get_threadType()===4)&&a.get_postReference()&&a.get_postReference().get_digest())b=a.get_postReference().get_digest();var e=SP.UI.MicroFeed.SPMicroFeed.$8v(b),c=b.get_actors()[b.get_ownerIndex()],d="";if(c&&c.get_actorType())d=c.get_name();return this.$6L_0(e,b.get_replies().length>0,f,b.get_id(),d)},$8U_0:function(b,g,e,c,h,f,i){var a=null,d=false;if(!i)if(b.get_threadType()&&b.get_postReference()&&!b.get_postReference().get_digest()){a=this.$5v_0(b,e,c,g,h,f,true);d=true}else if(f>2){a=this.$5v_0(b,e,c,g,h,f,false);d=true}a&&c.appendChild(a);d&&c.appendChild(SP.UI.MicroFeed.SPMicroFeed.$8M(e));return a},$94_0:function(c,d,e){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$1p+e;a.className=SP.UI.MicroFeed.SPMicroFeed.$3R;var b=SP.UI.MicroFeed.MicrofeedEntry.createRootPostFromThread(c);if(!b)return a;if(d)b.$0_0=6;a.appendChild(this.$18_0(b));return a},$5v_0:function(a,j,e,k,l,m,g){var f=false;if(g)for(var d=e.getElementsByTagName("a"),i=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_rootPost()),b=null,c=0;c<d.length;c++)if(d[c].getAttribute("name")==="fullyOrphaned"){b=d[c];var h=this;$addHandler(b,"click",function(){if(a.get_postReference()&&a.get_postReference().get_threadId()){b.innerHTML="";b.appendChild(SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon(SP.UI.MicroFeed.SPMicroFeed.$3A+a.get_postReference().get_threadId(),SP.UI.MicroFeed.SPMicroFeed.$3H));h.$3Y_0(a.get_postReference().get_threadId(),false,true,e,i)}});f=true;return null}return!f?this.$8s_0(g,j,a,e,m,l,k):null},$8s_0:function(o,c,d,h,i,l,m){var b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$4d+c;var a=document.createElement("button"),e=document.createElement("span");e.id="ms-moreRepliesText_"+c;var f=document.createElement("span");f.id=SP.UI.MicroFeed.SPMicroFeed.$3E+c;var g=document.createElement("img");g.id=SP.UI.MicroFeed.SPMicroFeed.$4e+c;var k=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(d,d.get_rootPost());b.className=SP.UI.MicroFeed.SPMicroFeed.$2N;a.setAttribute("type","button");a.className=SP.UI.MicroFeed.SPMicroFeed.$O;f.className=SP.UI.MicroFeed.SPMicroFeed.$4h;a.appendChild(f);g.className=SP.UI.MicroFeed.SPMicroFeed.$3F;g.setAttribute("src",SP.UI.MicroFeed.SPMicroFeed.get_$1O());f.appendChild(g);e.className="ms-microfeed-moreRepliesText";if(o){b.className=b.className+" "+SP.UI.MicroFeed.SPMicroFeed.$6k;a.id="ms-OrphanContent_"+c;e.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.viewFullThreadText);var n=this;$addHandler(a,"click",function(){a.innerHTML="";a.appendChild(SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon(SP.UI.MicroFeed.SPMicroFeed.$3A+d.get_postReference().get_threadId(),SP.UI.MicroFeed.SPMicroFeed.$3H));n.$3Y_0(d.get_postReference().get_threadId(),false,true,h,k)})}else{b.className=b.className+" "+SP.UI.MicroFeed.SPMicroFeed.$4g;a.className=a.className+" "+SP.UI.MicroFeed.SPMicroFeed.$4f;a.id=SP.UI.MicroFeed.SPMicroFeed.$6j+c;e.innerHTML=STSHtmlEncode(String.format(SpsClient.ScriptResources.viewRepliesText,i));var j=this;$addHandler(a,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$5h(c);if(d.get_threadType())j.$7q_0(d.get_postReference().get_threadId(),l,i,m,h,k);else j.$7q_0(c,l,i,m,h,null)})}a.appendChild(e);b.appendChild(a);b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());return b},$4M_0:function(b,i,a,j,h,k){var c="",e=null,f=null,d=null,g=0;if(a){c=a.id.substr(a.id.lastIndexOf("_")+1);e=$get(SP.UI.MicroFeed.SPMicroFeed.$1p+c);a.setAttribute("LastModificationTime",b.get_rootPost().get_modifiedTime());a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$3B,"");e.innerHTML="";d=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(b,b.get_rootPost());d.$0_0=1;d.$5_0=h;d.$8_0=c;e.appendChild(this.$18_0(d));if(SP.UI.MicroFeed.SPMicroFeed.$5B(b.get_rootPost()))g++;f=this.$4L_0(b,c,!j,false,h?true:false,k);g+=parseInt(f.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$15));f.removeAttribute(SP.UI.MicroFeed.SPMicroFeed.$15);SP.UI.MicroFeed.SPMicroFeed.$5k(a,g,true);this.$6M_0(b,c)}else a=this.$36_0(b,i,false,false);ProcessImn();return a},$4L_0:function(f,i,l,m,n,o){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$1A+i),b=null,c=null,j=0,k=0,g=0,e=null,h=null,d=f;if(!a){a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$1A+i}if(!l)a.innerHTML="";a.className=SP.UI.MicroFeed.SPMicroFeed.$2N+" ms-microfeed-repliesDiv";m&&a.setAttribute("expanded","true");if(f&&f.get_postReference()&&f.get_postReference().get_digest())d=f.get_postReference().get_digest();if(d&&d.get_replies())for(g=0;g<d.get_replies().length;g++){h=d.get_replies()[g];b=$get(SP.UI.MicroFeed.SPMicroFeed.$2M+h.get_id());c=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(d,h);c.$8_0=i;if(b&&d.get_id()===i){if(o){c.$0_0=2;e=this.$18_0(c);b.parentNode.insertBefore(e,b);SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(b)&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e);b.parentNode.removeChild(b)}continue}if(n)c.$0_0=8;else c.$0_0=2;e=this.$18_0(c);(k>=2||l)&&!m&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e);if(SP.UI.MicroFeed.SPMicroFeed.$5B(h))j++;a.insertBefore(e,a.firstChild);k++}a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$15,j);return a},createThreadDiv:function(a,c,e,d){var b=SP.UI.MicroFeed.SPMicroFeed.createThreadDivWithoutHiding(a,c);!d&&(e||a&&!this.$9r_0(a))&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);return b},$7q_0:function(a,b,c,d,e,f){if(c!==b)this.$3Y_0(a,d,true,e,f);else SP.UI.MicroFeed.SPMicroFeed.$6K(a)},$18_0:function(a){if(!a)return document.createElement("div");if(!a.$G_0)a.$G_0=a.$0_0===3||a.$0_0===1||a.$0_0===6||a.$0_0===11||a.$0_0===10;if(a.$0_0===8||a.$G_0&&a.$5_0)a.$3_0=a.$8_0+"_"+a.$2_0;var b=SP.UI.MicroFeed.SPMicroFeed.$7S(a);a.$F_0&&b.appendChild(this.$6E_0(a,b));a.$5_0&&b.appendChild(SP.UI.MicroFeed.SPMicroFeed.$8i(a));if(!SP.UI.MicroFeed.SPMicroFeed.$1t(a))b.appendChild(this.$8k_0(a,b));else if(a.$0_0!==12){var c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$3D+a.$3_0;c.className="ms-microfeed-oneLiner";c.appendChild(this.$5r_0(a,b));b.appendChild(c)}return b},$6E_0:function(a,c){var b=document.createElement("div");b.id="ms-rightAlignedDiv_"+a.$3_0;b.className=SP.UI.MicroFeed.SPMicroFeed.$7o;if(a.$0_0===3||a.$0_0===4)b.appendChild(SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon("ms-PendingUploadImage_"+a.$3_0,SP.UI.MicroFeed.SPMicroFeed.$3H));else a.$0_0!==12&&a.$0_0!==11&&this.$K_0&&this.$8b_0(b,a,c);return b},$8b_0:function(c,a,d){var b=null,e=false;if(a.$5_0)this.$8c_0(c,a,d);else if(a.$0_0===9&&a.$X_0)c.appendChild(this.$4C_0(true,a.$3_0,a.$2_0,a.$G_0,d,a.$A_0,a.$0_0,a.$8_0,false));else if(!a.$F_0&&!SP.UI.MicroFeed.SPMicroFeed.$1t(a)){if(a.$X_0&&SP.UI.MicroFeed.SPMicroFeed.$1S(a)&&!(a.$0_0===9)){e=true;b=a.$A_0}else if(a.$G_0&&a.$0_0!==3&&this.$7_0===this.$1W_0)if(a.$B_0&&a.$B_0.get_isFollowed())b=a.$B_0;else if((a.$i_0||SP.UI.MicroFeed.SPMicroFeed.$1s(a.$A_0))&&!SP.UI.MicroFeed.SPMicroFeed.$1S(a))b=a.$A_0;else return;else return;c.appendChild(this.$4C_0(e,a.$3_0,a.$2_0,a.$G_0,d,b,a.$0_0,a.$8_0,a.get_isActivityPost()))}},$8c_0:function(c,a,d){var b=false;if(!a.$5_0)return;if(a.$5_0.$X_0&&SP.UI.MicroFeed.SPMicroFeed.$1S(a.$5_0))if(a.$5_0.$0_0===10||a.$F_0&&a.$5_0.$0_0===9)b=true;else return;else if(!a.$F_0||!a.$5_0.$i_0||SP.UI.MicroFeed.SPMicroFeed.$1S(a.$5_0)||this.$7_0!==this.$1W_0)return;c.appendChild(this.$4C_0(b,a.$3_0,a.$5_0.$2_0,a.$G_0,d,a.$5_0.$A_0,a.$5_0.$0_0,a.$8_0,false))},$8k_0:function(a,e){var c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$4n+a.$3_0;var b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$3D+a.$3_0;if(a.$1U_0)c.className=SP.UI.MicroFeed.SPMicroFeed.$6q;else if(a.$5_0)c.className="ms-microfeed-indentRootRef";c.innerHTML=SP.UI.MicroFeed.SPMicroFeed.$60(a.$3_0,a,a.$A_0,true);if(a.$l_0===2)b.className="ms-microfeed-oneLiner";else if(a.$G_0&&!a.$1U_0)b.className="ms-microfeed-rootBody";else b.className="ms-microfeed-replyBody";!a.$F_0&&b.appendChild(this.$6E_0(a,e));b.appendChild(SP.UI.MicroFeed.SPMicroFeed.$6D(a,a.$3_0,a.$G_0?"ms-microfeed-rootText":"ms-microfeed-replyText",a.$G_0,a.$0_0,this.$6_0===2?true:false));if(a.$I_0){var d=null;switch(a.$I_0.get_attachmentKind()){case 0:d=SP.UI.MicroFeed.SPMicroFeed.$68(a.$I_0,a.$3_0,"ms-microfeed-attachmentImage");break;case 1:d=SP.UI.MicroFeed.MicroFeedVideo.$69(a.$I_0,a.$3_0);break;case 2:d=SP.UI.MicroFeed.MicroFeedDoc.$65(a.$I_0,a.$3_0)}d&&b.appendChild(d)}a.$0_0!==12&&b.appendChild(this.$5r_0(a,e));b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());c.appendChild(b);return c},$4C_0:function(i,d,p,j,k,e,c,l,m){if(!i&&!e.get_canFollow())return document.createElement("div");var f=document.createElement("div");f.id=SP.UI.MicroFeed.SPMicroFeed.$6c+d;var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$4Q+d;a.style.width="24px";a.style.height="24px";var g=document.createElement("img"),b=document.createElement("button");b.id=SP.UI.MicroFeed.SPMicroFeed.$4P+d;var h=document.createElement("span");if(i)if(m||c===9||c===10)b.title=SpsClient.ScriptResources.hideActivityTitleText;else b.title=j?SpsClient.ScriptResources.deleteRootTitleText:SpsClient.ScriptResources.deleteReplyTitleText;else if(e)b.title=String.format(!e.get_actorType()?SpsClient.ScriptResources.stopFollowingAuthorTitleText:SpsClient.ScriptResources.stopFollowingObjectTitleText,e.get_name());a.className=SP.UI.MicroFeed.SPMicroFeed.$6b;b.className=SP.UI.MicroFeed.SPMicroFeed.$O+" "+SP.UI.MicroFeed.SPMicroFeed.$7m;h.className=SP.UI.MicroFeed.SPMicroFeed.$3y;g.setAttribute("src",SP.UI.MicroFeed.SPMicroFeed.get_$1O());g.className=SP.UI.MicroFeed.SPMicroFeed.$3x;b.setAttribute("type","button");if(i){var n=this;$addHandler(b,"click",function(){n.$6I_0(d,p,j,c,l,m)})}else{var o=this;$addHandler(b,"click",function(){o.$7N_0(d,j,e,l)})}h.appendChild(g);b.appendChild(h);a.appendChild(b);f.appendChild(a);if(!(c===6||c===7||c===10)){SP.UI.MySiteCommon.CommonUIElements.setDisplayNoneAndTabbable(true,a);a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2V,"false");a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2U,"false");var q=this;$addHandler(k,"mouseover",function(){a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2V,"true");SP.UI.MySiteCommon.CommonUIElements.displayForTabbable(a)});var r=this;$addHandler(k,"mouseout",function(){a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2V,"false");a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$2U)!=="true"&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNoneAndTabbable(true,a)});var s=this;$addHandler(b,"focus",function(){a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2U,"true");SP.UI.MySiteCommon.CommonUIElements.displayForTabbable(a)});var t=this;$addHandler(b,"blur",function(){a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2U,"false");a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$2V)!=="true"&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNoneAndTabbable(true,a)})}return f},$8W_0:function(a,h,d,i,e,j){var b=new SP.UI.MicroFeed.MicrofeedMenu("microfeed-moreDropDownMenu_"+d,"span","socialcommon.png",SpsClient.ScriptResources.titleTextForMoreDropDown,false,SP.UI.MicroFeed.SPMicroFeed.$4o,"ms-microfeed-mysitemenu-ellipsisImage","ms-core-menu-root","ms-microfeed-mysitemenu-ellipsisImageParent"),c=0;if(SP.UI.MicroFeed.SPMicroFeed.$1t(a))return null;if(a.$L_0&&a.$L_0.length&&(a.$h_0||a.$g_0||a.$j_0)&&!SP.UI.MicroFeed.SPMicroFeed.$c){var k=this;b.addRootPostDropDownItem(SpsClient.ScriptResources.copyThreadLinkRootDropDownText,function(){EnsureScriptFunc("sp.pageinstrumentation.js","SP.PageInstrumentation.Clicks",function(){SP.PageInstrumentation.Clicks.recordClickClientId("CopyLink",a.$2_0)});SP.UI.MicroFeed.SPMicroFeed.$9x(a,d,i)});c++}if(SP.UI.MicroFeed.SPMicroFeed.$5q(b,a))c++;if(a.$1E_0&&this.$K_0)if(!a.$j_0){var f=this;b.addRootPostDropDownItem(SpsClient.ScriptResources.lockThreadDropDownText,function(){f.$7a_0(e,a.$2_0,true,a.$5_0)});c++}else{var g=this;b.addRootPostDropDownItem(SpsClient.ScriptResources.unlockThreadDropDownText,function(){g.$7a_0(e,a.$2_0,false,a.$5_0)});c++}if(this.$K_0)if(this.$5o_0(b,a,h,d,e))c++;c>0&&b.addSeparator();c+=SP.UI.MicroFeed.SPMicroFeed.$5p(b,a.$S_0,j);if(this.$8Q_0(b,a,d,e))c++;return c>0?b.render():null},$5o_0:function(c,a,d,e,f){if((a.$X_0||this.$5E_0)&&!(a.$0_0===9||a.$0_0===10)&&!SP.UI.MicroFeed.SPMicroFeed.$1S(a)){var b=this;c.addRootPostDropDownItem(SpsClient.ScriptResources.deleteRootDropDownText,function(){b.$6I_0(e,a.$2_0,a.$G_0,d,f,false)});return true}return false},$8Q_0:function(c,a,d,e){if(this.$7_0===this.$1W_0)if(a.$B_0&&a.$B_0.get_isFollowed()&&a.$B_0.get_id()!==a.$A_0.get_id()&&SP.UI.MicroFeed.SPMicroFeed.$1S(a)){var b=this;c.addRootPostDropDownItem(SP.UI.MicroFeed.SPMicroFeed.$8u(a.$B_0),function(){b.$7N_0(d,true,a.$B_0,e)});return true}return false},$8V_0:function(c,d,e){var a=new SP.UI.MicroFeed.MicrofeedMenu("microfeed-moreDropDownMenu_"+d,"span","socialcommon.png",SpsClient.ScriptResources.titleTextForMoreDropDown,false,SP.UI.MicroFeed.SPMicroFeed.$4o,"ms-microfeed-mysitemenu-ellipsisImage","ms-core-menu-root","ms-microfeed-mysitemenu-ellipsisImageParent"),b=0;if(this.$K_0)if(this.$5o_0(a,c,c.$0_0,d,c.$8_0))b++;if(SP.UI.MicroFeed.SPMicroFeed.$5q(a,c))b++;b>0&&a.addSeparator();b+=SP.UI.MicroFeed.SPMicroFeed.$5p(a,c.$S_0,e);return b>0?a.render():null},$6I_0:function(e,j,f,g,h,k){var a="",b=SpsClient.ScriptResources.deleteConfirmationDialogButtonText,d=g===9,c=f||d;if(k||d){a=SpsClient.ScriptResources.deleteRefConfirmationText;b=SpsClient.ScriptResources.hideConfirmationDialogButtonText}else if(f)if(g===10){a=SpsClient.ScriptResources.deleteRefMentionConfirmationText;b=SpsClient.ScriptResources.removeConfirmationDialogButtonText}else a=SpsClient.ScriptResources.deleteRootConfirmationText;else a=SpsClient.ScriptResources.deleteReplyConfirmationText;var i=this;SP.UI.MicroFeed.SPMicroFeed.$34(e,h,c,a,"",b,"",function(){i.$4I_0(c?h:e,j,c)})},$7N_0:function(f,g,b,h){if(!b)return;var c="",d="",a=b.get_name(),e=a;if(a.length>=15)e=String.format(SpsClient.ScriptResources.moreContentEllipsesNoSpace,a.substr(0,15));if(!b.get_actorType()){c=String.format(SpsClient.ScriptResources.hideConfirmationText,a);d=String.format(SpsClient.ScriptResources.stopFollowingPersonConfirmationDialogButtonText,e)}else{c=String.format(SpsClient.ScriptResources.hideDocumentConfirmationText,a);d=String.format(SpsClient.ScriptResources.stopFollowingObjectConfirmationDialogButtonText,e)}var i=this;SP.UI.MicroFeed.SPMicroFeed.$34(f,h,g,c,"",d,a,function(){i.$7M_0(g?h:f,b,a)})},$4I_0:function(e,c,b){var a=null,f=null;if(b)a=$get(SP.UI.MicroFeed.SPMicroFeed.$1B+e);else a=$get(SP.UI.MicroFeed.SPMicroFeed.$2M+e);if(a){a.setAttribute("deleted","true");SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();!b&&SP.UI.MicroFeed.SPMicroFeed.$7P(a.parentNode,1,null);!SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(a)&&SP.UI.MicroFeed.SPMicroFeed.$6J(a);var d=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){f=SP.UI.MicroFeed.SPMicroFeed.get_$D().deletePost(c);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(f.get_status())d.$6H_0(e,c,b,a,"");else{if(b)SP.UI.MicroFeed.MicrofeedThreadCache.removeById(c);else SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(f,false);d.$8D_0(c,b,a.id)}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()},function(g,f){if(f.get_errorCode()===3)d.$8D_0(c,b,a.id);else if(f.get_errorCode()===2)SP.UI.MicroFeed.SPMicroFeed.$35(function(){SP.UI.MicroFeed.SPMicroFeed.$31(a)});else d.$6H_0(e,c,b,a,f.get_message());SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()})})}},$8D_0:function(c,d,e){var a=null,b=$get(e);b&&b.parentNode.removeChild(b);if(d)this.$8S_0();else{a=document.getElementsByName(c);while(a.length>0){SP.UI.MicroFeed.SPMicroFeed.$7P(a[0].parentNode.parentNode,1,null);a[0].parentNode.parentNode.removeChild(a[0].parentNode)}}},$6H_0:function(h,i,e,c,f){var a=document.createElement("div");a.id="ms-errorPostDiv";a.className=SP.UI.MicroFeed.SPMicroFeed.$4m+" "+SP.UI.MicroFeed.SPMicroFeed.$4p;a.innerHTML=c.innerHTML;if(e)a.innerHTML=c.firstChild.firstChild.innerHTML;SP.UI.MicroFeed.SPMicroFeed.$4J(a);var d="";if(!SP.ScriptHelpers.isNullOrEmptyString(f))d=String.format(SpsClient.ScriptResources.genericErrorMessage,f);var b=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,SpsClient.ScriptResources.deleteErrorMessage);b.set_okButtonText(SpsClient.ScriptResources.retryButtonText);var g=this;b.set_okButtonCallback(function(){g.$4I_0(h,i,e)});var j=this;b.set_cancelButtonCallback(function(){SP.UI.MicroFeed.SPMicroFeed.$31(c)});b.set_extraMessage(a);b.set_errorMessage(d);b.show()},$8S_0:function(){var a=null,c=false,g=false,h=false,b=0,d=null,e=0,f=0,i="";a=$get(SP.UI.MicroFeed.SPMicroFeed.$1Q);if(!a)return;if(SP.UI.MicroFeed.SPMicroFeed.$c){this.$7I_0("",0);return}i=a.getAttribute("numHiddenThreads");if(!SP.ScriptHelpers.isNullOrEmptyString(i))f=parseInt(a.getAttribute("numHiddenThreads"));for(b=0;b<a.children.length;b++){d=a.children[b];g=a.children[b].getAttribute("deleted")==="true";h=SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(d);if(h&&!e&&!g)if(this.$4A_0(d)){e=1;SP.UI.MySiteCommon.CommonUIElements.display(d);c=true;break}if(!c)c=!(g||h)}f=f-e;a.setAttribute("numHiddenThreads",""+f);e<1&&this.$48_0(a,1,0);if(!c){a.appendChild(this.$2E_0(false));SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1k))}},$7a_0:function(e,a,b,f){var g=this;EnsureScriptFunc("sp.pageinstrumentation.js","SP.PageInstrumentation.Clicks",function(){if(b)SP.PageInstrumentation.Clicks.recordClickClientId("LockThread",a);else SP.PageInstrumentation.Clicks.recordClickClientId("UnlockThread",a)});var d=$get(SP.UI.MicroFeed.SPMicroFeed.$1B+e);SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();var c=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var e=b?SP.UI.MicroFeed.SPMicroFeed.get_$D().lockThread(a):SP.UI.MicroFeed.SPMicroFeed.get_$D().unlockThread(a);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(!e.get_status()||e.get_status()===5||e.get_status()===8){SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(e,false);c.$4M_0(e,false,d,false,f,true);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()}else SP.UI.MicroFeed.SPMicroFeed.$7J()},function(b,a){if(a.get_errorCode()===2)SP.UI.MicroFeed.SPMicroFeed.$35(function(){SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()});else SP.UI.MicroFeed.SPMicroFeed.$7J()})})},$5r_0:function(a,j){var g=a.$2_0,b=SP.UI.MicroFeed.SPMicroFeed.$5s(a,a.$0_0,a.$3_0,true),c=document.createElement("a");c.id=SP.UI.MicroFeed.SPMicroFeed.$4T+a.$3_0;var d=document.createElement("a");d.id=SP.UI.MicroFeed.SPMicroFeed.$6y+a.$3_0;var e=document.createElement("span");e.id=SP.UI.MicroFeed.SPMicroFeed.$6f+a.$3_0;e.className="ms-textSmall";var f=null;if(!a.$F_0){if(a.$0_0===2||a.$0_0===8||a.$0_0===7){SP.UI.MicroFeed.SPMicroFeed.$5u(a.$y_0,c,false);SP.UI.MicroFeed.SPMicroFeed.$5t(b,a.$k_0,a.$3_0,a,a.$x_0)}if(a.$g_0&&this.$K_0){SP.UI.MicroFeed.SPMicroFeed.$s(b);c.className=SP.UI.MicroFeed.SPMicroFeed.$2L;c.setAttribute("href","#");c.setAttribute("onclick","return false;");if(a.$x_0){c.setAttribute("liked","true");c.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.unlikeCommandText)}else c.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.likeCommandText);var k=this;$addHandler(c,"click",function(b){SP.UI.MicroFeed.SPMicroFeed.$9Y(b,g,a)});b.appendChild(c)}if(a.$h_0&&(a.$0_0===6||a.$0_0===1)&&this.$K_0){SP.UI.MicroFeed.SPMicroFeed.$s(b);d.className=SP.UI.MicroFeed.SPMicroFeed.$2L;d.setAttribute("href","#");d.setAttribute("onclick","return false;");SP.UI.MySiteCommon.CommonUIElements.setElementText(d,SpsClient.ScriptResources.replyCommandText);b.appendChild(d);var l=this;$addHandler(d,"click",function(){EnsureScriptFunc("sp.pageinstrumentation.js","SP.PageInstrumentation.Clicks",function(){SP.PageInstrumentation.Clicks.recordClickClientId("Reply",g)});var b=$get(SP.UI.MicroFeed.SPMicroFeed.$3O+a.$8_0),c=$get(SP.UI.MicroFeed.SPMicroFeed.$1P+a.$8_0);SP.UI.MicroFeed.SPMicroFeed.$99(a.$8_0);SP.UI.MySiteCommon.CommonUIElements.display(c);b.focus()})}if(a.$j_0&&(a.$0_0===6||a.$0_0===1)){SP.UI.MicroFeed.SPMicroFeed.$s(b);e.title=SpsClient.ScriptResources.lockedToolTip;SP.UI.MySiteCommon.CommonUIElements.setElementText(e,SpsClient.ScriptResources.lockedPostText);b.appendChild(e)}var h=SP.UI.MicroFeed.SPMicroFeed.$8N(a,b,a.$3_0);if(a.$0_0===1||a.$0_0===6)f=this.$8W_0(a,a.$0_0,a.$3_0,j,a.$8_0,h);else f=this.$8V_0(a,a.$3_0,h);if(f){SP.UI.MicroFeed.SPMicroFeed.$s(b);b.appendChild(f)}}else{SP.UI.MicroFeed.SPMicroFeed.$s(b);var i=SP.UI.MicroFeed.SPMicroFeed.$8r(a.$3_0);if(!OffSwitch.IsActive(SP.UI.MySiteCommon.CommonUIElements.newsFeedPermLinkKillSwitchID)&&!a.$L_0)i.className+=" ms-hide";b.appendChild(i)}return b},$6L_0:function(m,x,b,y,z){var c=$get(SP.UI.MicroFeed.SPMicroFeed.$1P+b);if(!c){c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$1P+b}c.className=SP.UI.MicroFeed.SPMicroFeed.$2N+" ms-microfeed-newReplyDiv "+SP.UI.MicroFeed.SPMicroFeed.$2Q;(!x||!this.$K_0)&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,c);if(!this.$K_0)return c;if(1===m&&SP.UI.MicroFeed.SPMicroFeed.$9T(c)){var e=null,a=null,d=null,i=null,f=null,s=null,h=null,g=null,k=null,j=null;h=document.createElement("div");h.id=SP.UI.MicroFeed.SPMicroFeed.$4t+b;h.style.position="relative";h.className=SP.UI.MicroFeed.SPMicroFeed.$5R+" "+SP.UI.MicroFeed.SPMicroFeed.$2m;g=document.createElement("div");g.id=SP.UI.MicroFeed.SPMicroFeed.$3t+b;e=document.createElement("div");e.id="ms-newReplyDivContent_"+b;e.className="ms-microfeedReplyContent";e.style.position="relative";c.innerHTML=SP.UI.MicroFeed.SPMicroFeed.$60(SP.UI.MicroFeed.SPMicroFeed.$39+b,null,SP.UI.MicroFeed.SPMicroFeed.get_$Q(),false);var l=document.createElement("div");l.id=SP.UI.MicroFeed.SPMicroFeed.$3Q+b;l.className=SP.UI.MicroFeed.SPMicroFeed.$4s+" "+SP.UI.MicroFeed.SPMicroFeed.$71;a=document.createElement("textarea");a.id=SP.UI.MicroFeed.SPMicroFeed.$3O+b;a.className=SP.UI.MicroFeed.SPMicroFeed.$4s+" "+SP.UI.MicroFeed.SPMicroFeed.$2l+" "+SP.UI.MicroFeed.SPMicroFeed.$3w;a.title=SpsClient.ScriptResources.replyTitleText;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,this.$U_0);a.rows=1;a.style.position="relative";a.setAttribute("targetDisplayName",STSHtmlEncode(z));i=document.createElement("span");i.id=SP.UI.MicroFeed.SPMicroFeed.$5V;i.className=SP.UI.MicroFeed.SPMicroFeed.$7l;f=document.createElement("label");f.id=SP.UI.MicroFeed.SPMicroFeed.$1K+b;f.className=SP.UI.MicroFeed.SPMicroFeed.$5L+" "+SP.UI.MicroFeed.SPMicroFeed.$2k;SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,f);if(!SP.UI.MicroFeed.SPMicroFeed.$14){$addHandler(a,"keydown",this.$$d_$8e_0);$addHandler(a,"keyup",this.$$d_$8e_0);$addHandler(a,"propertychange",this.$$d_$8e_0);$addHandler(a,"input",this.$$d_$8e_0)}var t=this;$addHandler(a,"focus",function(){SP.UI.MySiteCommon.CommonUIElements.display(c);t.$6R_0(a.id,false,$get(SP.UI.MicroFeed.SPMicroFeed.$2H+SP.UI.MicroFeed.SPMicroFeed.$39+b))});var A=this;$addHandler(a,"blur",function(){SP.UI.MicroFeed.SPMicroFeed.$6S(a.id,false)});if(!SP.UI.MicroFeed.SPMicroFeed.$14){var n=this,o=this;$addHandlers(a,{keyup:function(){n.$17_0(a,f,d,n.$U_0)},change:function(){o.$17_0(a,f,d,o.$U_0)}})}var p=this,q=this,B=this,C=this,D=this;$addHandlers(a,{cut:function(){p.$2y_0(a,f,d,p.$U_0)},paste:function(){q.$2y_0(a,f,d,q.$U_0)},keyup:function(){SP.UI.MicroFeed.SPMicroFeed.$28(a,b)},click:function(){SP.UI.MicroFeed.SPMicroFeed.$28(a,b)},focus:function(){SP.UI.MicroFeed.SPMicroFeed.$28(a,b)}});d=SP.UI.MicroFeed.SPMicroFeed.$4F(SpsClient.ScriptResources.postCommandText,SP.UI.MicroFeed.SPMicroFeed.$19+b,SP.UI.MicroFeed.SPMicroFeed.$5U);d.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$e,b);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,d);k=SP.UI.MicroFeed.SPMicroFeed.$1j(SP.UI.MicroFeed.SPMicroFeed.get_$1O(),SpsClient.ScriptResources.attachPictureButtonText,SpsClient.ScriptResources.attachPictureButtonText,SP.UI.MicroFeed.SPMicroFeed.$3K+b,SP.UI.MicroFeed.SPMicroFeed.$2i+" "+SP.UI.MicroFeed.SPMicroFeed.$O,SP.UI.MicroFeed.SPMicroFeed.$5J,SP.UI.MicroFeed.SPMicroFeed.$5I);k.setAttribute("name",SP.UI.MicroFeed.SPMicroFeed.$3Z);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,k);var u=this;$addHandler(k,"click",function(){u.$2w_0(d,a,b,false)});if(SP.UI.MicroFeed.SPMicroFeed.get_$6G()){j=SP.UI.MicroFeed.SPMicroFeed.$1j(SP.UI.MicroFeed.SPMicroFeed.get_$2s(),SpsClient.ScriptResources.attachFileButtonText,SpsClient.ScriptResources.attachFileButtonText,SP.UI.MicroFeed.SPMicroFeed.$3J+b,SP.UI.MicroFeed.SPMicroFeed.$2i+" "+SP.UI.MicroFeed.SPMicroFeed.$O,SP.UI.MicroFeed.SPMicroFeed.$5H,SP.UI.MicroFeed.SPMicroFeed.$5G);j.setAttribute("name",SP.UI.MicroFeed.SPMicroFeed.$3C);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,j);var v=this;$addHandler(j,"click",function(){v.$2w_0(d,a,b,true)})}h.appendChild(l);h.appendChild(a);g.className="ms-microfeed-elementsNoFocus";g.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$e,b);g.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$1R,"false");SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,g);g.appendChild(SP.UI.MicroFeed.SPMicroFeed.$64(a,b));g.appendChild(this.$5z_0(a,d,b));h.appendChild(g);e.appendChild(h);var w=this;$addHandler(d,"click",function(){w.$7y_0(b,y,SP.UI.MicroFeed.SPMicroFeed.$7D(b))});i.appendChild(f);i.appendChild(d);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,i);e.appendChild(k);j&&e.appendChild(j);e.appendChild(i);e.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());c.appendChild(e);var r=this;s=new SP.UI.MicroFeed.AtMention(a,SP.UI.MicroFeed.SPMicroFeed.maxResolvedMentions,SP.UI.MicroFeed.SPMicroFeed.maxResolvedTags,function(){r.$8E_0(a,d,g,f,r.$U_0)});SP.UI.MicroFeed.SPMicroFeed.$P[b]=s;var E=this;$addHandler(a,"keydown",function(a){SP.UI.MicroFeed.SPMicroFeed.$8F(a,b,false)})}else if(2===m)c.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.replyLimitErrorText);else if(0===m)c.innerHTML="";return c},$6R_0:function(j,n,o){var a=$get(j),b=document.createElement("textarea"),d,f,g,l,h="",i=j.substr(j.indexOf("_")+1),m=0,k=0,c=SP.UI.MicroFeed.SPMicroFeed.getTextBoxFocusDiv(a,n);if(c)c.className=c.className.replace(SP.UI.MicroFeed.SPMicroFeed.$2m,SP.UI.MicroFeed.SPMicroFeed.$5S);o&&SP.UI.MySiteCommon.CommonUIElements.display(o);if(n){if(a.rows<2)a.rows=2;d=$get(SP.UI.MicroFeed.SPMicroFeed.$b);f=$get(SP.UI.MicroFeed.SPMicroFeed.$3n);g=$get(SP.UI.MicroFeed.SPMicroFeed.$3m);l=$get(SP.UI.MicroFeed.SPMicroFeed.$1z);h=this.$H_0}else{d=$get(SP.UI.MicroFeed.SPMicroFeed.$19+i);f=$get(SP.UI.MicroFeed.SPMicroFeed.$3K+i);g=$get(SP.UI.MicroFeed.SPMicroFeed.$3J+i);l=$get(SP.UI.MicroFeed.SPMicroFeed.$1m+i);h=this.$U_0;if(c&&c.parentNode)if(c.parentNode.className.indexOf(SP.UI.MicroFeed.SPMicroFeed.$3P)===-1)c.parentNode.className+=" "+SP.UI.MicroFeed.SPMicroFeed.$3P;if(a.rows<2){b.rows=2;b.style.zIndex=1;b.style.position="absolute";SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,b);a.parentNode.appendChild(b);m=b.clientHeight;k=b.clientWidth;a.parentNode.removeChild(b);a.style.height=a.clientHeight+"px";a.style.width=k+"px";var p=this;SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){SPAnimationUtility.BasicAnimator.Resize(a,m-8,k-10,function(){a.rows=2;a.style.height="auto";a.style.width="";p.$2C_0(a)},null)})}}if(SP.UI.MicroFeed.SPMicroFeed.$14){window.clearInterval(SP.UI.MicroFeed.SPMicroFeed.$44);var e=this;SP.UI.MicroFeed.SPMicroFeed.$44=window.setInterval(function(){e.$2C_0(a);var b=SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(a.id),c=j===SP.UI.MicroFeed.SPMicroFeed.$1L;if(c)e.$17_0(a,$get(SP.UI.MicroFeed.SPMicroFeed.$1K),$get(SP.UI.MicroFeed.SPMicroFeed.$b),e.$H_0);else e.$17_0(a,$get(SP.UI.MicroFeed.SPMicroFeed.$1K+b),$get(SP.UI.MicroFeed.SPMicroFeed.$19+b),e.$U_0)},100)}if(d){SP.UI.MySiteCommon.CommonUIElements.display(d);SP.UI.MySiteCommon.CommonUIElements.display(d.parentNode);this.$2r_0(d,a,h)}if(f){SP.UI.MySiteCommon.CommonUIElements.display(f);f.disabled=this.$1y_0}if(g){SP.UI.MySiteCommon.CommonUIElements.display(g);g.disabled=this.$1y_0}if(a.value===h)a.value="";a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$2l,SP.UI.MicroFeed.SPMicroFeed.$5Q)},$9l_0:function(c,d,i,a){var b=null,g=null,e=null;if(d){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1K));b=$get(SP.UI.MicroFeed.SPMicroFeed.$b);g=$get(SP.UI.MicroFeed.SPMicroFeed.$3n);e=$get(SP.UI.MicroFeed.SPMicroFeed.$3m);a.value=this.$H_0}else{SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1K+c));b=$get(SP.UI.MicroFeed.SPMicroFeed.$19+c);g=$get(SP.UI.MicroFeed.SPMicroFeed.$3K+c);e=$get(SP.UI.MicroFeed.SPMicroFeed.$3J+c);a.value=this.$U_0;var f=SP.UI.MicroFeed.SPMicroFeed.getTextBoxFocusDiv(a,d);if(f&&f.parentNode)f.parentNode.className=f.parentNode.className.replace(SP.UI.MicroFeed.SPMicroFeed.$3P,"");a.style.height="";a.style.width=""}SP.UI.MicroFeed.SPMicroFeed.$2v(a);var h=$get(d?SP.UI.MicroFeed.SPMicroFeed.$3u:SP.UI.MicroFeed.SPMicroFeed.$3Q+SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(a.id));if(h)h.innerHTML="";if(!SP.UI.MicroFeed.SPMicroFeed.$J[c?c:""]){b.disabled=true;if(d)SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,b);else{SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b.parentNode)}SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,g);e&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e)}if(!d)a.rows=1;else a.rows=2;i&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,i);a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$5Q,SP.UI.MicroFeed.SPMicroFeed.$2l)},$87_0:function(a){this.$7_0=a;this.$1X_0=false},$3X_0:function(d,g,c){var e=this.$4_0[this.$7_0],f=e.$d_0,b=null,a=new SP.Social.SocialFeedOptions;a.set_maxThreadCount(SP.UI.MicroFeed.SPMicroFeed.$7r);a.set_sortOrder(0);if(d)if(d===1)a.set_olderThan(this.$1H_0);else if(d===2)this.$1Y_0&&a.set_newerThan(this.$1Y_0);if(this.$2A_0())this.$3f_0=new Date;c.val=true;switch(f){case 0:if(this.$6_0===1)b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeed(0,a);else if(this.$6_0===2){b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeedFor(SP.UI.MicroFeed.SPMicroFeed.microfeed.$M_0,a);c.val=false}else{b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeedFor(this.$3k_0,a);c.val=false}break;case 1:b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeed(1,a);break;case 4:b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeed(4,a);c.val=false;break;case 2:b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeed(2,a);break;case 6:b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeed(3,a);break;case 5:b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getMentions(g,a)}return b},$52_0:function(j,g,i){var d=this.$4_0[this.$7_0].$d_0,e=this.$E_0[d],f=new SP.UI.MicroFeed.MicrofeedThreadList,b=null,c=false,h=false;if(!j&&this.$E_0[d]){this.$5g_0(g);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();return}SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();var a=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){if(a.$2A_0()&&a.$1Y_0&&e&&e.size()>0){var j,k;b=(k=a.$3X_0(2,i,j={val:c}),c=j.val,k);h=true}else{a.$1H_0=new Date;var l,m;b=(m=a.$3X_0(0,i,l={val:c}),c=l.val,m)}SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){f.setThreadCollection(b,false,a.$1I_0);if(h){a.$5e_0(b);f.appendThreadList(e)}a.$E_0[d]=f;a.resetNewPostNotifications();c&&a.$29_0(b.get_unreadMentionCount());a.$5g_0(g);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()},function(c,b){a.$2Z_0=b.get_message();if(b.get_errorCode()===9)a.$E_0[d]=new SP.UI.MicroFeed.MicrofeedThreadList;a.$5g_0(g);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()})})},$5g_0:function(a){var c=$get(SP.UI.MicroFeed.SPMicroFeed.$2I);if(c){var b=this;SP.UI.MicroFeed.SPMicroFeed.$2G(function(){b.$4K_0(a)},false)}else this.$4K_0(a)},$48_0:function(e,d,f){SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();var b=new SP.UI.MicroFeed.MicrofeedThreadList,c=false,a=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var g,h,i=(h=a.$3X_0(1,false,g={val:c}),c=g.val,h);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){c&&a.$29_0(i.get_unreadMentionCount());var j=0,g=0,l=0;b.setThreadCollection(i,false,a.$1I_0);var k=a.$4_0[a.$7_0].$d_0,h=a.$E_0[k];if(!h){a.$E_0[k]=b;g=b.size()}else{l=h.sizeAfterRemovingRecentDeletions();h.appendThreadList(b);a.$E_0[k]=h;g=h.size()-l}if(g)j=a.$6N_0(e,a.$E_0[k],l,d);if(j<d&&g&&f!==3)a.$48_0(e,d-j,++f);else SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();!g&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$4i));if(j>0){var m=$get(SP.UI.MicroFeed.SPMicroFeed.$2K);null!==m&&m.parentNode.removeChild(m)}ProcessImn()},function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1k));SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()})})},$7x_0:function(a,b,d,e){var c=this;SP.SOD.executeFunc("initstrings.js","Strings.STS.L_RelativeDateTime_AFewSeconds",function(){var g=SP.ScriptHelpers.isNullOrEmptyString(d),h=SP.UI.MicroFeed.MicrofeedEntry.createEntryFromData(SP.UI.MicroFeed.SPMicroFeed.get_$Q(),g?0:1,b,"pending",false,false,false,a.get_attachment()),f=$get(SP.UI.MicroFeed.SPMicroFeed.$2K);null!==f&&f.parentNode.removeChild(f);if(!g)c.$8o_0(a,b,d,e,h);else c.$8p_0(a,b,h,e)})},$8o_0:function(j,k,c,h,e){var a=null,g=null,b=null,i="",f=null;if(this.$w_0){g=$get(SP.UI.MicroFeed.SPMicroFeed.$1A+c);e.$0_0=4;e.$8_0=c;b=this.$18_0(e);b.id=SP.UI.MicroFeed.SPMicroFeed.$4q+c;SP.UI.MySiteCommon.CommonUIElements.display(g);g.appendChild(b);ProcessImn();SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner()}if(!SP.ScriptHelpers.isNullOrEmptyString(h))i=h;else i=c;var d=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){a=SP.UI.MicroFeed.SPMicroFeed.get_$D().createPost(i,j);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(a.get_status()&&a.get_status()!==8)d.$47_0(j,k,c,h,e,b,null);else if(!a.get_status()&&d.$w_0){var i=d.$E_0[1];i&&i.moveToFront(a,false);i=d.$E_0[0];i&&i.moveToFront(a,false);var l=$get(SP.UI.MicroFeed.SPMicroFeed.$1c+e.$2_0);b&&b.parentNode&&b.parentNode.removeChild(b);f=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_replies()[0]);f.$0_0=7;f.$8_0=c;g.appendChild(d.$18_0(f));SP.UI.MicroFeed.SPMicroFeed.$84(l,SP.UI.MicroFeed.SPMicroFeed.$1c+f.$2_0,a.get_replies()[0]);ProcessImn();SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()}},function(f,a){d.$47_0(j,k,c,h,e,b,a)})})},$8p_0:function(d,h,e,i){var b=null,a=null,f=null,g=null;if(this.$w_0){g=$get(SP.UI.MicroFeed.SPMicroFeed.$1Q);a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$6r+"0";f=this.$95_0(e,false);f.id=SP.UI.MicroFeed.SPMicroFeed.$4q+"0";a.appendChild(f);SP.UI.MicroFeed.SPMicroFeed.$2B(a,g,null,false);ProcessImn()}if(SP.ScriptHelpers.isNullOrEmptyString(this.$M_0))d.set_updateStatusText(true);else d.set_updateStatusText(false);var c=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){b=SP.UI.MicroFeed.SPMicroFeed.get_$D().createPost(i,d);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){b.get_status()&&b.get_status()!==8&&c.$47_0(d,h,null,null,e,a,null);if(!b.get_status()&&c.$w_0){var f=c.$E_0[1];f&&f.addToFront(b,false);f=c.$E_0[0];f&&f.addToFront(b,false);var g=$get(SP.UI.MicroFeed.SPMicroFeed.$1c+e.$2_0);a&&a.parentNode&&a.parentNode.replaceChild(c.$36_0(b,false,true,false),a);SP.UI.MicroFeed.SPMicroFeed.$84(g,SP.UI.MicroFeed.SPMicroFeed.$1c+b.get_id(),b.get_rootPost());ProcessImn()}},function(f,b){c.$47_0(d,h,null,i,e,a,b)})})},$47_0:function(g,x,u,v,p,b,a){var i=false,e=document.createElement("div");e.id="ms-errorPostDiv";e.className=SP.UI.MicroFeed.SPMicroFeed.$4p;p.$0_0=12;p.$8_0="";e.appendChild(this.$18_0(p));if(a)if(a.get_errorCode()===3){var f=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.knownErrorButNoUserFixTitle,SpsClient.ScriptResources.postToDeletedThreadErrorMessage),y=this;f.set_okButtonCallback(function(){b.parentNode.removeChild(b)});f.set_hideCancelButton(true);f.set_extraMessage(e);f.set_errorMessage(String.format(SpsClient.ScriptResources.genericErrorMessage,a.get_message()));f.show();i=true}else if(a.get_errorCode()===2){var z=this;SP.UI.MicroFeed.SPMicroFeed.$35(function(){b.parentNode.removeChild(b)});i=true}if(!i){var q=SpsClient.ScriptResources.unknownErrorTitle,j=SpsClient.ScriptResources.retryErrorMessage,d="",h="",k=SpsClient.ScriptResources.retryButtonText,w=this,r=function(){b.parentNode.removeChild(b);w.$7x_0(g,x,u,v)},s=SpsClient.ScriptResources.cancelButtonText,A=this,t=function(){b.parentNode.removeChild(b)},l=e;if(a&&a.get_errorCode()===14&&g.get_contentText().trim().length>0){var o=!!g.get_attachment()&&!g.get_attachment().get_attachmentKind();d=o?SpsClient.ScriptResources.pictureUploadErrorMessage:SpsClient.ScriptResources.fileUploadErrorMessage;j=o?SpsClient.ScriptResources.retryWithoutPictureErrorMessage:SpsClient.ScriptResources.retryWithoutFileErrorMessage;k=o?SpsClient.ScriptResources.retryWithoutPictureButtonText:SpsClient.ScriptResources.retryWithoutFileButtonText;g.set_attachment(null);h=String.format(SpsClient.ScriptResources.genericErrorMessage,a.get_message())}else if(!SP.ScriptHelpers.isNullOrEmptyString(v)&&SP.ScriptHelpers.isNullOrEmptyString(u)){q=SpsClient.ScriptResources.knownErrorButNoUserFixTitle;d=SpsClient.ScriptResources.postingToSiteFeedFailure;j="";k=SpsClient.ScriptResources.okButtonText;var B=this;r=function(){b.parentNode.removeChild(b)};s=null;t=null;l=null;if(a){if(a.get_errorCode()===17)d=SpsClient.ScriptResources.postingToSiteFeedFailureSiteOutOfStorage;h=String.format(SpsClient.ScriptResources.genericErrorMessage,a.get_message())}}else if(!a)d=SpsClient.ScriptResources.postErrorMessage;else{d=SpsClient.ScriptResources.postErrorMessage;h=String.format(SpsClient.ScriptResources.genericErrorMessage,a.get_message())}var m=document.createElement("div");l&&m.appendChild(l);var n=document.createElement("div");n.setAttribute("style","margin-top:15px;");SP.UI.MySiteCommon.CommonUIElements.setElementText(n,j);m.appendChild(n);var c=new SP.UI.MySiteCommon.MySiteDialog(q,d);c.set_okButtonText(k);c.set_okButtonCallback(r);c.set_cancelButtonText(s);c.set_cancelButtonCallback(t);c.set_extraMessage(m);c.set_errorMessage(h);c.show()}ProcessImn();SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()},$3Y_0:function(b,f,g,a,h){var d=false;if(!a||a.getAttribute("updating")==="true")return;a.setAttribute("updating","true");d=SP.UI.MicroFeed.SPMicroFeed.$5h(b);var e=a.id.substr(a.id.lastIndexOf("_")+1);SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();var c=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var i=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFullThread(b);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(i.get_status())c.$7H_0(b,f,g,a,h,e,"",0);else{SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(i,false);c.$4M_0(i,f,a,true,h,false);g&&SP.UI.MicroFeed.SPMicroFeed.$6K(e)}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();a.removeAttribute("updating");d&&SP.UI.MicroFeed.SPMicroFeed.$5i(b)},function(j,i){c.$7H_0(b,f,g,a,h,e,i.get_message(),i.get_errorCode());a.removeAttribute("updating");d&&SP.UI.MicroFeed.SPMicroFeed.$5i(b)})})},$7H_0:function(i,m,n,o,a,b,j,p){var d=!SP.ScriptHelpers.isNullOrEmptyString(j)?String.format(SpsClient.ScriptResources.genericErrorMessage,j):"";if(p===2){var g=SpsClient.ScriptResources.siteFeedInsufficientPermissionsUnknownSiteErrorMessage,h=SP.UI.MicroFeed.MicrofeedThreadCache.getThreadById(a.$2_0);if(h){var c=SP.UI.MicroFeed.MicrofeedEntry.getTargetForRef(h);if(c&&c.get_uri()&&SP.UI.MySiteCommon.CommonUIElements.isSafeURL(c.get_uri()))g=String.format(SpsClient.ScriptResources.siteFeedInsufficientPermissionsErrorMessage,SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","",c.get_uri(),""),"</a>")}var e=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,g);e.set_hideCancelButton(true);e.set_errorMessage(d);e.show()}else if(a&&a.$X_0){var k=this;SP.UI.MicroFeed.SPMicroFeed.$34(b,b,true,SpsClient.ScriptResources.getOrphanedThreadErrorMessage,d,SpsClient.ScriptResources.deleteConfirmationDialogButtonText,"",function(){k.$4I_0(b,a.$2_0,true)})}else{var l=this;SP.UI.MicroFeed.SPMicroFeed.$34(b,b,true,SpsClient.ScriptResources.getThreadErrorMessage,d,SpsClient.ScriptResources.retryButtonText,"",function(){l.$3Y_0(i,m,n,o,a)})}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();var f=$get(SP.UI.MicroFeed.SPMicroFeed.$3A+i);f&&SP.UI.MySiteCommon.CommonUIElements.setElementText(f.parentNode,SpsClient.ScriptResources.viewFullThreadText)},$7M_0:function(d,a,e){var b=null;if(a.get_actorType()&&!SP.UI.MicroFeed.SPMicroFeed.$1s(a))return;b=$get(SP.UI.MicroFeed.SPMicroFeed.$1B+d);b.setAttribute("deleted","true");!SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(b)&&SP.UI.MicroFeed.SPMicroFeed.$6J(b);SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();var c=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){if(SP.UI.MicroFeed.SPMicroFeed.$1s(a)){SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);var f=new SP.UserProfiles.FollowedContent(SP.UI.MicroFeed.SPMicroFeed.$N);f.stopFollowing(a.get_contentUri()?a.get_contentUri():a.get_uri())}else!a.get_actorType()&&SP.UI.MicroFeed.SPMicroFeed.get_$5c().stopFollowing(a.get_accountName());SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){c.$7L_0(a,b)},function(g,f){if(f.get_errorTypeName()==="Microsoft.Office.Server.UserProfiles.PrivacyItemNotFoundException")c.$7L_0(a,b);else c.$9Q_0(d,a,b,f.get_message(),e)})})},$7L_0:function(b,c){c.parentNode.removeChild(c);this.$E_0[1]=null;this.refreshTheFeed();if(!b.get_actorType()){var a=SP.UI.People.FollowLinkManager.getLink(b.get_accountName());a&&a.updateFromExternalSource(false,"Microfeed")}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()},$9Q_0:function(f,g,h,c,d){var b="";if(!SP.ScriptHelpers.isNullOrEmptyString(c))b=String.format(SpsClient.ScriptResources.genericErrorMessage,c);var a=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,String.format(SpsClient.ScriptResources.hideErrorMessage,d));a.set_okButtonText(SpsClient.ScriptResources.retryButtonText);var e=this;a.set_okButtonCallback(function(){e.$7M_0(f,g,d)});var i=this;a.set_cancelButtonCallback(function(){SP.UI.MicroFeed.SPMicroFeed.$31(h)});a.set_errorMessage(b);a.show();SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()}};SP.UI.MicroFeed.AllLikerDisplayManager=function(){};SP.UI.MicroFeed.AllLikerDisplayManager.socialActorCompare=function(e,f){var a=e,b=f,c=SP.UI.MicroFeed.SPMicroFeed.get_$Q();if(c){var d=c.get_accountName().toLowerCase();if(a.get_accountName().toLowerCase()===d)return-1;else if(b.get_accountName().toLowerCase()===d)return 1}return a.get_name().toLowerCase().localeCompare(b.get_name().toLowerCase())};SP.UI.MicroFeed.AllLikerDisplayManager.createAllLikerCallout=function(a,b){if(!b||!a)return;SP.UI.MySiteCommon.PresenceManager.ensurePresenceJSLoaded(function(){SP.SOD.executeFunc("callout.js","Callout",function(){var c=new CalloutOptions,e=true;c.launchPoint=b;c.ID=SP.UI.MicroFeed.AllLikerDisplayManager.$6V+b.id;var f=$get("contentBox");c.boundingBox=!f?document.body:f;var d=document.createElement("div");d.id=SP.UI.MicroFeed.AllLikerDisplayManager.$6U+b.id;d.setAttribute("style","min-height: 50px");var g=SP.UI.MicroFeed.AllLikerDisplayManager.$6W+b.id;c.onOpenedCallback=function(){var b=$get(g);if(e){e=false;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var c=SP.UI.MicroFeed.SPMicroFeed.get_$D().getAllLikers(a.$2_0);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(c){c.sort(SP.UI.MicroFeed.AllLikerDisplayManager.socialActorCompare);a.$f_0=c}var g=a.$f_0.length,h=String.format(SP.Utilities.LocUtility.getLocalizedCountValue(SpsClient.ScriptResources.seeAllLikerCalloutTitle,SpsClient.ScriptResources.seeAllLikerCalloutTitleIntervals,g),g);SP.UI.MySiteCommon.CommonUIElements.setElementText(b,h);SP.UI.MicroFeed.AllLikerDisplayManager.$5j[a.$2_0]=h;for(var i="<div>",e=null,f=0;f<a.$f_0.length;f++){e=a.$f_0[f];i+="<div>"+SP.UI.MySiteCommon.PresenceManager.getUserImageInnerHTML(e.get_accountName(),e.get_name(),e.get_imageUri(),e.get_uri(),e.get_emailAddress(),e.get_title(),false,false)+"</div>"}d.className=SP.UI.MicroFeed.AllLikerDisplayManager.$7j;d.innerHTML=i+"</div>";ProcessImn()},function(){SP.UI.MySiteCommon.CommonUIElements.setElementText(b,SpsClient.ScriptResources.unknownErrorTitle);d.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.getLikerErrorMsg);e=true})})}else{SP.UI.MySiteCommon.CommonUIElements.setElementText(b,SP.UI.MicroFeed.AllLikerDisplayManager.$5j[a.$2_0]||"");ProcessImn()}};c.title=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("div",g,"")+SP.UI.MySiteCommon.CommonUIElements.createProcessingIconAsHTML("ms-progressAllLikerSpinner","ms-microfeed-processingImage")+"</div>";c.beakOrientation="leftRight";c.contentElement=d;c.contentWidth=300;var h=CalloutManager.createNew(c)})})};SP.UI.MicroFeed.MicrofeedEntry=function(){this.$A_0=null;this.$B_0=null;this.$X_0=false;this.$g_0=false;this.$1T_0=false;this.$1E_0=false;this.$h_0=false;this.$v_0="";this.$2_0="";this.$i_0=false;this.$1w_0=false;this.$j_0=false;this.$F_0=false;this.$1U_0=false;this.$G_0=false;this.$x_0=false;this.$y_0=null;this.$f_0=null;this.$I_0=null;this.$k_0=0;this.$10_0=0;this.$l_0=0;this.$S_0=[];this.$L_0="";this.$3_0="";this.$11_0="";this.$1J_0=null;this.$1a_0=null;this.$m_0=0;this.$5_0=null;this.$n_0=true;this.$a_0="";this.$1F_0="";this.$8_0="";this.$0_0=0};SP.UI.MicroFeed.MicrofeedEntry.createEntryFromData=function(h,f,i,c,g,d,e,b){var a=new SP.UI.MicroFeed.MicrofeedEntry;a.$A_0=h;a.$B_0=null;a.$m_0=f;a.$a_0=STSHtmlEncode(i);a.$2_0=c;a.$3_0=c;a.$h_0=false;a.$10_0=0;a.$X_0=d;a.$x_0=g;a.$k_0=0;a.$y_0=null;a.$f_0=null;a.$g_0=e;a.$1T_0=false;a.$i_0=true;a.$j_0=false;a.$1E_0=false;a.$v_0=STSHtmlEncode(Strings.STS.L_RelativeDateTime_AFewSeconds);if(b)a.$I_0=b;SP.UI.MicroFeed.MicrofeedEntry.$8A(a);return a};SP.UI.MicroFeed.MicrofeedEntry.getTargetForRef=function(a){if(a&&a.get_postReference()&&a.get_postReference().get_threadOwnerIndex()>0&&a.get_postReference().get_threadOwnerIndex()<a.get_actors().length){var b=a.get_actors()[a.get_postReference().get_threadOwnerIndex()];if(b&&b.get_actorType())return b}return null};SP.UI.MicroFeed.MicrofeedEntry.createRootPostFromThread=function(a){var b=new SP.UI.MicroFeed.MicrofeedEntry;if(a)if(!a.get_threadType()){b=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_rootPost());b.$F_0=false}else if(!a.get_postReference())return null;else if(a.get_postReference().get_digest()){b=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a.get_postReference().get_digest(),a.get_postReference().get_digest().get_rootPost());b.$5_0=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_rootPost());b.$F_0=false;b.$8_0=a.get_id()}else if(a.get_postReference().get_post()){b=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_postReference().get_post());b.$5_0=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_rootPost());var c=SP.UI.MicroFeed.MicrofeedEntry.getTargetForRef(a);if(c)b.$B_0=c;if(a.get_postReference().get_post().get_postType()===1){b.$1U_0=true;b.$3_0=a.get_postReference().get_threadId()}else b.$G_0=true;b.$F_0=true}else{b=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_rootPost());b.$F_0=true;b.$3_0=a.get_postReference().get_threadId()}return b};SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost=function(c,b){var a=new SP.UI.MicroFeed.MicrofeedEntry;if(b){a.$A_0=c.get_actors()[b.get_authorIndex()];var g=c.get_actors()[c.get_ownerIndex()];if(g.get_actorType())a.$B_0=g;a.$m_0=b.get_postType();if(!b.get_postType())switch(c.get_threadType()){case 3:a.$0_0=10;break;case 1:case 2:case 4:a.$0_0=9;break;case 0:a.$0_0=1}else a.$0_0=2;a.$2_0=b.get_id();a.$f_0=null;a.$3_0=b.get_id();a.$h_0=!!(c.get_attributes()&2);a.$10_0=c.get_totalReplyCount();a.$X_0=!!(b.get_attributes()&2);if(b.get_likerInfo()){var e=b.get_likerInfo();a.$x_0=e.get_includesCurrentUser();a.$k_0=e.get_totalCount();a.$y_0=[];for(var f=e.get_indexes(),j=f.length,d=0;d<j;++d){var k=f[d];Array.add(a.$y_0,c.get_actors()[k])}}a.$g_0=!!(b.get_attributes()&1);if(!a.$A_0.get_actorType())a.$i_0=SP.UI.People.PersonManager.getFollowState(a.$A_0.get_accountName());else a.$i_0=a.$A_0.get_isFollowed();a.$1T_0=!!(b.get_attributes()&16);a.$j_0=!!(c.get_attributes()&8);a.$1E_0=!!(c.get_attributes()&4);if(!SP.ScriptHelpers.isNullOrEmptyString(b.get_preferredImageUri())){a.$n_0=false;var h="/_layouts/16/images/",i=b.get_preferredImageUri().toLowerCase().lastIndexOf(h);a.$11_0=i>=0?GetThemedImageUrl(b.get_preferredImageUri().substr(i+h.length)):b.get_preferredImageUri();if(!c.get_threadType())a.$v_0="";else a.$v_0=SP.UI.MicroFeed.MicrofeedEntry.$63(b.get_createdTime())}else a.$n_0=true;if(a.$n_0||a.$g_0||a.$h_0)a.$v_0=SP.UI.MicroFeed.MicrofeedEntry.$63(b.get_createdTime());a.$I_0=b.get_attachment();a.$8_0=c.get_id();SP.UI.MicroFeed.MicrofeedEntry.$8A(a);a.$a_0=SP.UI.MicroFeed.MicrofeedEntry.$9j(c,a,b);a.$L_0=c.get_permalink();if(b.get_source()){a.$1J_0=b.get_source().get_text();a.$1a_0=b.get_source().get_uri()}}return a};SP.UI.MicroFeed.MicrofeedEntry.$8A=function(a){a.$l_0=0;if(a.$m_0===1)a.$l_0=1;else if(!SP.ScriptHelpers.isNullOrEmptyString(a.$11_0))a.$l_0=2};SP.UI.MicroFeed.MicrofeedEntry.$9j=function(r,o,d){if(!d||SP.ScriptHelpers.isNullOrEmptyString(d.get_text()))return"";var c=d.get_text(),g="",e="",a=0,f=0,j=0,h=null,b=-1;if(d.get_text().length>800){var l=d.get_text().indexOf(" ",500),p=d.get_text().indexOf("\n",500),m=d.get_text().indexOf("\r\n",500),i=p;if(i===-1)i=m;else if(i>m&&m!==-1)i=m;b=i;if(b===-1)b=l;else if(b>l&&l!==-1)b=l}var k=false;for(j=0;j<d.get_overlays().length;j++){h=d.get_overlays()[j];f=h.get_index();if(f<b||b===-1)g+=STSHtmlEncode(c.substr(a,f-a));else if(b>a){g+=STSHtmlEncode(c.substr(a,b-a));e+=STSHtmlEncode(c.substr(a+b-a,f-b));k=true}else{e+=STSHtmlEncode(c.substr(a,f-a));k=true}var q=c.substr(f,h.get_length()),n=SP.UI.MicroFeed.MicrofeedEntry.$8l(q,h,r,o);if(!k)g+=n;else e+=n;a=f+h.get_length()}if(b>a){g+=STSHtmlEncode(c.substr(a,b));e+=STSHtmlEncode(c.substr(a+b))}else if(k||b<=a&&b!==-1&&SP.ScriptHelpers.isNullOrEmptyString(e))e+=STSHtmlEncode(c.substr(a));else g+=STSHtmlEncode(c.substr(a));o.$1F_0=e;return g};SP.UI.MicroFeed.MicrofeedEntry.$8l=function(d,b,e,f){var a="";switch(b.get_overlayType()){case 1:var c=e.get_actors()[b.get_actorIndexes()[0]];a=SP.UI.MySiteCommon.PresenceManager.getLyncActorNameHTML(c,"ms-actorElement","ms-bold ms-subtleLink");Array.add(f.$S_0,c);break;case 0:a=SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("ms-externalLink",d,"",b.get_linkUri(),'target="_blank"',true);break;default:return d}return a};SP.UI.MicroFeed.MicrofeedEntry.$63=function(a){var c=false,d=SP.Guid.newGuid().toString(),b='<span id="'+d+'" class="ms-hide">'+a+"</span>";SP.SOD.executeOrDelayUntilScriptLoaded(function(){var e=new Date;if(a>e)a=e;var g=new Date(e.getFullYear(),e.getMonth(),e.getDate()),h=new Date(a.getFullYear(),a.getMonth(),a.getDate()),i=Math.round((g-h)/1e3/60/60/24);if(a.getFullYear()===g.getFullYear()||i<=6)b=SP.DateTimeUtil.SPRelativeDateTime.getRelativeDateTimeString(a,true,0,false);else{var j=SP.DateTimeUtil.IntlDate.createFromJsLocalDate(a,0);b=j.format("D",Sys.CultureInfo.CurrentCulture.name)}if(c){var f=$get(d);f&&f.parentNode&&f.parentNode.replaceChild(document.createTextNode(b),f)}},"SP.DateTimeUtil.js");c=true;return b};SP.UI.MicroFeed.MicrofeedEntry.actorComparison=function(d,c){if(!d)return!c?0:1;if(!c)return-1;var a=d,b=c;return a.get_actorType()===b.get_actorType()?a.get_name().toLowerCase().localeCompare(b.get_name().toLowerCase()):!a.get_actorType()?-1:!b.get_actorType()?1:a.get_actorType()===1?-1:b.get_actorType()===1?1:a.get_actorType()===2?-1:b.get_actorType()===2?1:0};SP.UI.MicroFeed.MicrofeedEntry.prototype={get_author:function(){return this.$A_0},set_author:function(a){this.$A_0=a;return a},get_target:function(){return this.$B_0},set_target:function(a){this.$B_0=a;return a},get_postType:function(){return this.$m_0},set_postType:function(a){this.$m_0=a;return a},get_text:function(){return this.$a_0},set_text:function(a){this.$a_0=a;return a},get_extraText:function(){return this.$1F_0},set_extraText:function(a){this.$1F_0=a;return a},get_id:function(){return this.$2_0},set_id:function(a){this.$2_0=a;return a},get_canReply:function(){return this.$h_0},set_canReply:function(a){this.$h_0=a;return a},get_numReplies:function(){return this.$10_0},set_numReplies:function(a){this.$10_0=a;return a},get_canDelete:function(){return this.$X_0},set_canDelete:function(a){this.$X_0=a;return a},get_likedByMe:function(){return this.$x_0},set_likedByMe:function(a){this.$x_0=a;return a},get_numLikers:function(){return this.$k_0},set_numLikers:function(a){this.$k_0=a;return a},get_likers:function(){return this.$y_0},set_likers:function(a){this.$y_0=a;return a},get_allLikerList:function(){return this.$f_0},set_allLikerList:function(a){this.$f_0=a;return a},get_canLike:function(){return this.$g_0},set_canLike:function(a){this.$g_0=a;return a},get_canFollowUp:function(){return this.$1T_0},set_canFollowUp:function(a){this.$1T_0=a;return a},get_isFollowedByMe:function(){return this.$i_0},set_isFollowedByMe:function(a){this.$i_0=a;return a},get_isLocked:function(){return this.$j_0},set_isLocked:function(a){this.$j_0=a;return a},get_canLock:function(){return this.$1E_0},set_canLock:function(a){this.$1E_0=a;return a},get_isActivityPost:function(){return!this.$F_0&&!this.$g_0&&!this.$h_0&&!this.$1E_0&&!this.$j_0&&(this.$0_0===6||this.$0_0===1)},get_renderPostAuthorImage:function(){return this.$n_0},set_renderPostAuthorImage:function(a){this.$n_0=a;return a},get_postImagePath:function(){return this.$11_0},set_postImagePath:function(a){this.$11_0=a;return a},get_postSource:function(){return this.$1J_0},set_postSource:function(a){this.$1J_0=a;return a},get_postSourceUri:function(){return this.$1a_0},set_postSourceUri:function(a){this.$1a_0=a;return a},get_footer:function(){return this.$v_0},set_footer:function(a){this.$v_0=a;return a},get_attachment:function(){return this.$I_0},set_attachment:function(a){this.$I_0=a;return a},get_pictureSize:function(){return this.$l_0},set_pictureSize:function(a){this.$l_0=a;return a},get_actors:function(){return this.$S_0},set_actors:function(a){this.$S_0=a;return a},get_permalink:function(){return this.$L_0},set_permalink:function(a){this.$L_0=a;return a},$A_0:null,$B_0:null,$m_0:0,$a_0:null,$1F_0:null,$2_0:null,$h_0:false,$10_0:0,$X_0:false,$x_0:false,$k_0:0,$y_0:null,$f_0:null,$g_0:false,$1T_0:false,$i_0:false,$j_0:false,$1E_0:false,$n_0:false,$11_0:null,$1J_0:null,$1a_0:null,$v_0:null,$I_0:null,$l_0:0,$S_0:null,$L_0:null,$1w_0:false,get_isHidden:function(){return this.$1w_0},set_isHidden:function(a){this.$1w_0=a;return a},$0_0:0,get_drawPostType:function(){return this.$0_0},set_drawPostType:function(a){this.$0_0=a;return a},$5_0:null,get_refRootPost:function(){return this.$5_0},set_refRootPost:function(a){this.$5_0=a;return a},$8_0:null,get_threadDivID:function(){return this.$8_0},set_threadDivID:function(a){this.$8_0=a;return a},$3_0:null,get_postIDForDrawPost:function(){return this.$3_0},set_postIDForDrawPost:function(a){this.$3_0=a;return a},$F_0:false,get_isOrphan:function(){return this.$F_0},set_isOrphan:function(a){this.$F_0=a;return a},$1U_0:false,get_drawAsIndentedOrphan:function(){return this.$1U_0},set_drawAsIndentedOrphan:function(a){this.$1U_0=a;return a},$G_0:false,get_isRoot:function(){return this.$G_0},set_isRoot:function(a){this.$G_0=a;return a}};SP.UI.MicroFeed.MicrofeedMenu=function(i,e,b,d,h,c,g,f,a){SP.UI.MicroFeed.MicrofeedMenu.initializeBase(this,[i]);if(!SP.ScriptHelpers.isNullOrEmptyString(b)){this.set_imageSourceOverride(GetThemedImageUrl(b));this.set_imageTitleText(d);!SP.ScriptHelpers.isNullOrEmptyString(a)&&this.set_imageParentClassOverride(a)}!h&&this.set_textOverride("EMPTY_STRING_A2BF7E95-82D5-4055-8451-B0B86C4E973E");this.$t_1=e;this.$3b_1=c;this.$3e_1=g;this.$3c_1=f;this.set_hideIcons(true)};SP.UI.MicroFeed.MicrofeedMenu.prototype={$t_1:"",$3b_1:"",$3e_1:"",$3c_1:"",setStyles:function(){this.set_menuStyle("ms-textLarge ms-headerFont");this.set_controlImageStyle("ms-microfeed-mysitemenu-image");this.set_controlStyle("");this.set_controlElementType("");this.set_controlHeaderStyle("");!SP.ScriptHelpers.isNullOrEmptyString(this.$3b_1)&&this.set_controlStyle(this.$3b_1);!SP.ScriptHelpers.isNullOrEmptyString(this.$t_1)&&this.set_controlElementType(this.$t_1);!SP.ScriptHelpers.isNullOrEmptyString(this.$3e_1)&&this.set_controlImageStyle(this.$3e_1);!SP.ScriptHelpers.isNullOrEmptyString(this.$3c_1)&&this.set_controlHeaderStyle(this.$3c_1)},setOpenedCallback:function(a){this.set_openedCallback(a)},addRootPostDropDownItem:function(b,a){var c=this;this.add(b,null,null,null,function(){a()})},addSeparator:function(){var a=new SP.UI.MySiteCommon.SeparatorMenuItem;this.appendMenuItem(a)}};SP.UI.MicroFeed.MicroFeedDoc=function(){};SP.UI.MicroFeed.MicroFeedDoc.$65=function(a,b){return SP.UI.MicroFeed.MicroFeedDoc.$66(a,SP.UI.MicroFeed.SPMicroFeed.$3p+b,true)};SP.UI.MicroFeed.MicroFeedDoc.$67=function(b,a){return SP.UI.MicroFeed.MicroFeedDoc.$66(b,!a?SP.UI.MicroFeed.SPMicroFeed.$2j:SP.UI.MicroFeed.SPMicroFeed.$2P+a,false)};SP.UI.MicroFeed.MicroFeedDoc.$66=function(e,c,d){var a=document.createElement("div"),b;a.id=c;if(d)a.className=SP.UI.MicroFeed.SPMicroFeed.$3o;b=SP.UI.MicroFeed.MicroFeedDoc.$9E(e,c,d);a.appendChild(b);return a};SP.UI.MicroFeed.MicroFeedDoc.$9E=function(b,i,h){var c,d,g;c=document.createElement("div");c.className="ms-microfeed-attachment";d=document.createElement("div");var e;if(b.get_uri().indexOf("?attachment=true")>0)e='<span class="ms-textSmall">'+STSHtmlEncode(b.get_name())+"</span>";else e=SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("",b.get_name(),"ms-textSmall ms-subtleLink",b.get_uri(),'target="_blank"',true);d.innerHTML='<span class="ms-microfeed-attachment-title">'+e+'</span><span class="ms-microfeed-attachment-url ms-metadata">'+STSHtmlEncode(b.get_contentUri())+"</span>";var a;if(h&&b.get_clickAction()){var f=document.createElement("span");a=document.createElement("a");f.className="ms-microfeed-attachment-action";a.className="ms-secondaryCommandLink";a.style.textDecoration="none";SP.UI.MySiteCommon.CommonUIElements.setElementText(a,SpsClient.ScriptResources.docPreview);f.appendChild(a);d.appendChild(f)}else a=null;g=SP.UI.MicroFeed.MicroFeedDoc.$7G(b,i,a,h);c.appendChild(g);c.appendChild(d);return c};SP.UI.MicroFeed.MicroFeedDoc.$7G=function(b,d,c,j){var a=document.createElement("div"),h=!OffSwitch.IsActive(SP.UI.MySiteCommon.CommonUIElements.encodeAttributeValueKillSwitchID)?STSHtmlEncode(b.get_name()):b.get_name(),e='alt="'+h+'" style="vertical-align:top; margin-bottom:10px;"';e+=" onerror=\"(function(img){img.onerror='';img.src='/_layouts/16/images/lg_icgen.gif';})(this)\"";var f=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.MicroFeedDoc.$7b+d,"",b.get_previewUri(),e);a.id="ms-microfeed-previewAreaDiv_"+d;a.className="ms-microfeed-previewArea";if(j&&null!==b.get_clickAction()){var g=null;switch(b.get_clickAction().get_actionKind()){case 1:c.href="#";c.setAttribute("onclick","return false;");g=function(){var e=document.createElement("iframe");e.id="ms-microfeed-attachment-inlineDocIframe_"+d;e.src=b.get_clickAction().get_actionUri();e.className="ms-microfeed-attachment-inlineDoc";a.parentNode.appendChild(e);a.parentNode.removeChild(a);c.parentNode.removeChild(c)};$addHandler(c,"click",g);break;case 0:c.href=b.get_clickAction().get_actionUri();c.target="_blank"}var i='target="_blank" style="vertical-align:top;"';a.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("ms-microfeed-attachmentDocLink_"+d,f,"",b.get_uri(),i,false)}else a.innerHTML=f;return a};SP.UI.MicroFeed.MicroFeedVideo=function(){};SP.UI.MicroFeed.MicroFeedVideo.$69=function(a,b){return SP.UI.MicroFeed.MicroFeedVideo.$6A(a,SP.UI.MicroFeed.SPMicroFeed.$3p+b,true)};SP.UI.MicroFeed.MicroFeedVideo.$6B=function(b,a){return SP.UI.MicroFeed.MicroFeedVideo.$6A(b,!a?SP.UI.MicroFeed.SPMicroFeed.$2j:SP.UI.MicroFeed.SPMicroFeed.$2P+a,false)};SP.UI.MicroFeed.MicroFeedVideo.$6A=function(e,c,d){var a=document.createElement("div"),b;a.id=c;if(d)a.className=SP.UI.MicroFeed.SPMicroFeed.$3o;b=SP.UI.MicroFeed.MicroFeedVideo.$9M(e,c,d);a.appendChild(b);return a};SP.UI.MicroFeed.MicroFeedVideo.$9M=function(a,j,k){var b,c,i;b=document.createElement("div");b.className="ms-microfeed-attachment";c=document.createElement("div");var e=document.createElement("span");e.className="ms-microfeed-attachment-title";e.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("videoTitle_"+j,a.get_name(),"ms-textSmall ms-subtleLink",a.get_uri(),'target="_blank"',true);c.appendChild(e);var f=a.get_uri().split("/"),g="";if(f.length>=3)g=String.format("{0}//{1}",f[0],f[2]);else g=a.get_uri();var h=document.createElement("span");SP.UI.MySiteCommon.CommonUIElements.setElementText(h,g);h.className="ms-metadata";c.appendChild(h);var d=document.createElement("span");d.className="ms-metadata ms-microfeed-attachment-description";SP.UI.MySiteCommon.CommonUIElements.setElementText(d,null!==a.get_description()?a.get_description():"");c.appendChild(d);i=SP.UI.MicroFeed.MicroFeedVideo.$7G(a,j,k,d);b.appendChild(i);b.appendChild(c);return b};SP.UI.MicroFeed.MicroFeedVideo.$7G=function(a,h,n,i){var b=document.createElement("div"),e='alt="'+a.get_name()+'"',j=120,d=0;if(a.get_width()&&a.get_height()){var m=a.get_height()/a.get_width();d=120*m}else d=67;e+=' width="'+j+'" height="'+d+'"';var k=(d-67)/2,l=String.format("{0}px",k);e+=' style="bottom:'+l+'"';var g=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.MicroFeedVideo.$7c+h,"ms-microfeed-videoThumbnail",a.get_previewUri(),e);b.className="ms-microfeed-previewArea ms-microfeed-videoPreviewArea";if(n&&null!==a.get_clickAction()){var f=null,c=document.createElement("a");c.id="ms-microfeed-attachmentVideoLink_"+h;c.style.verticalAlign="top";switch(a.get_clickAction().get_actionKind()){case 1:c.href="javascript:return false;";f=function(){var c;c=document.createElement("iframe");c.src=a.get_clickAction().get_actionUri();var d=b.parentNode;d.appendChild(c);c.className="ms-microfeed-embeddedVideo";c.style.width=d.clientWidth.toString()+"px";c.style.height=(9*d.clientWidth/16).toString()+"px";d.removeChild(b);i.parentNode.removeChild(i)};$addHandler(c,"click",f);break;case 0:c.href=SP.UI.MySiteCommon.CommonUIElements.encodeSafeURL(a.get_clickAction().get_actionUri());c.target="_blank"}c.innerHTML=g;b.appendChild(c);SP.UI.MicroFeed.MicroFeedVideo.$8T(b,f)}else b.innerHTML=g;SP.UI.MicroFeed.MicroFeedVideo.$8Z(b,a.get_length());return b};SP.UI.MicroFeed.MicroFeedVideo.$8T=function(e,c){var a=document.createElement("div");a.className="ms-microfeed-videoPlay";var b=document.createElement("a");b.href="javascript:return false;";b.title=SpsClient.ScriptResources.videoPlayButtonTitle;var d=document.createElement("span");b.appendChild(d);a.appendChild(b);c&&$addHandler(a,"click",c);e.appendChild(a)};SP.UI.MicroFeed.MicroFeedVideo.$9L=function(g){var b,c,d,e,f,h,a=new Sys.StringBuilder;b=3600;c=60;d=g/b|0;e=g%b/c|0;f=g%c|0;if(h=d>0){a.append(d.toString());a.append(":")}h&&e<10&&a.append("0");a.append(e.toString());a.append(":");f<10&&a.append("0");a.append(f.toString());return a.toString()};SP.UI.MicroFeed.MicroFeedVideo.$8Z=function(c,d){var a=document.createElement("div");a.className="ms-microfeed-videoTime";var b=document.createElement("span");SP.UI.MySiteCommon.CommonUIElements.setElementText(b,SP.UI.MicroFeed.MicroFeedVideo.$9L(d));a.appendChild(b);c.appendChild(a)};SP.UI.MicroFeed.SuggestionQueryManager=function(){this.$26_0={};this.$13_0={};this.$2q_0={}};SP.UI.MicroFeed.SuggestionQueryManager.prototype={$26_0:null,$13_0:null,get_possibleSuggestions:function(){return this.$13_0},lastKnownEmptySuggestion:"",m_loadingAnimationIDForRequest:"",get_loadingAnimationIDForRequest:function(){return this.m_loadingAnimationIDForRequest},m_maxSuggestionsToDisplay:0,$2q_0:null,get_uniqueIDs:function(){return this.$2q_0},$1b_0:false,get_processingRequest:function(){return this.$1b_0},set_processingRequest:function(a){this.$1b_0=a;return a},$24_0:null,get_lastRequest:function(){return this.$24_0},set_lastRequest:function(a){this.$24_0=a;return a},$9b_0:function(a,b){this.getPossibleSuggestions(a,b)},$8Y_0:function(a){if(!this.suggestionsContains(a)){var b=a.$Y_0.substr(0,1).toLowerCase(),c=b in this.$13_0?this.$13_0[b]:[];this.$13_0[b]=a.insertIntoSortedArray(c);this.$2q_0[a.$2_0]=true}},$9J_0:function(c){var b=null,a=c.toLowerCase();if(!(a in this.$13_0))this.$13_0[a]=[];b=this.$13_0[a];return b},suggestionsContains:function(a){return this.suggestionsContainsByID(a.$2_0)},suggestionsContainsByID:function(a){return a in this.$2q_0},isThisPrefixInQueriedForPrefixDictionary:function(a){return a.toLowerCase()in this.$26_0},isThisPrefixAlreadyCoveredInTheCollection:function(b,d){if(this.isThisPrefixInQueriedForPrefixDictionary(b))return true;for(var a=null,c=b.length-1;c>0;c--){a=this.getValueForQueriedPrefix(b.substr(0,c));if(SP.ScriptHelpers.isNullOrEmptyString(a))continue;if(a==="empty"){this.setValueForQueriedPrefix(b,0);return true}if(a==="processing")return true;if(Number.parseInvariant(a)>=this.m_maxSuggestionsToDisplay)return false;if(d)return true}return false},prepareForRequestIfReady:function(c){if(this.$1b_0)return false;if(this.$24_0){var a=new Date,b=a-this.$24_0;if(b<500)return false}this.$1b_0=true;this.$24_0=new Date;this.markPrefixProcessing(c);return true},handleCompletedRequest:function(c,d,e,b){this.$1b_0=false;var a=$get(this.m_loadingAnimationIDForRequest);a&&a.parentNode&&a.parentNode.removeChild(a);if(e){this.setValueForQueriedPrefix(c,d);b&&b()}else{b&&b();this.clearPrefixProcessingOnError(c)}},getValueForQueriedPrefix:function(a){return this.isThisPrefixInQueriedForPrefixDictionary(a)?this.$26_0[a.toLowerCase()]:""},setValueForQueriedPrefix:function(a,b){if(!b)this.$5f_0(a,"empty");else this.$5f_0(a,b.toString())},markPrefixProcessing:function(a){this.$5f_0(a,"processing")},clearPrefixProcessingOnError:function(a){if(this.getValueForQueriedPrefix(a)==="processing")delete this.$26_0[a.toLowerCase()]},$5f_0:function(a,b){this.$26_0[a.toLowerCase()]=b}};SP.UI.MicroFeed.AllUsersSuggestionManager=function(a){SP.UI.MicroFeed.AllUsersSuggestionManager.initializeBase(this);this.m_maxSuggestionsToDisplay=a;this.m_loadingAnimationIDForRequest="ms-microfeed-LoadingCompanyUsersImage"};SP.UI.MicroFeed.AllUsersSuggestionManager.prototype={getPossibleSuggestions:function(b,d){var a=b.toLowerCase(),c=3;if(b.length<c)return;!this.isThisPrefixAlreadyCoveredInTheCollection(a,false)&&this.$9i_1(a,d)},$9o_1:function(b){var a=b.toLowerCase();if(this.lastKnownEmptySuggestion===""||!a.startsWith(this.lastKnownEmptySuggestion))this.lastKnownEmptySuggestion=a},$9U_1:function(a){return SP.ScriptHelpers.isNullOrEmptyString(this.lastKnownEmptySuggestion)?false:a.toLowerCase().startsWith(this.lastKnownEmptySuggestion)},$9i_1:function(a,c){if(!this.prepareForRequestIfReady(a))return;var b=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var e=SP.ClientContext.get_current(),d=new SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters;d.set_allowMultipleEntities(false);d.set_maximumEntitySuggestions(50);d.set_principalType(1);d.set_principalSource(15);d.set_queryString(a);var f=SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.clientPeoplePickerSearchUser(e,d);e.executeQueryAsync(function(){var d=e.parseObjectFromJsonString(f.get_value()),h=0,j="",k="",i="",g=null;if(d){!d.length&&b.$9o_1(a);for(h=0;h<d.length;h++){g=d[h];j=g.Key;k=g.DisplayText;i="";if(g.EntityData)i=g.EntityData.Title;var l=new SP.UI.MicroFeed.TextBoxElement(k,j,0);l.$1u_0=i;b.$8Y_0(l)}b.handleCompletedRequest(a,d.length,true,c)}else b.handleCompletedRequest(a,0,false,c)},function(){b.handleCompletedRequest(a,0,false,null)})})}};SP.UI.MicroFeed.BaseAtMention.registerClass("SP.UI.MicroFeed.BaseAtMention");SP.UI.MicroFeed.AtMention.registerClass("SP.UI.MicroFeed.AtMention",SP.UI.MicroFeed.BaseAtMention);SP.UI.MicroFeed.TextBoxElement.registerClass("SP.UI.MicroFeed.TextBoxElement");SP.UI.MicroFeed.AtMentionMenuOption.registerClass("SP.UI.MicroFeed.AtMentionMenuOption");SP.UI.MicroFeed.OwnerControlState.registerClass("SP.UI.MicroFeed.OwnerControlState");SP.UI.MicroFeed.SocialActorCache.registerClass("SP.UI.MicroFeed.SocialActorCache");SP.UI.MicroFeed.MicrofeedThreadCache.registerClass("SP.UI.MicroFeed.MicrofeedThreadCache");SP.UI.MicroFeed.MicrofeedThreadList.registerClass("SP.UI.MicroFeed.MicrofeedThreadList");SP.UI.MicroFeed.MicroFeedView.registerClass("SP.UI.MicroFeed.MicroFeedView");SP.UI.MicroFeed.AttributePair.registerClass("SP.UI.MicroFeed.AttributePair");SP.UI.MicroFeed.SPMicroFeed.registerClass("SP.UI.MicroFeed.SPMicroFeed");SP.UI.MicroFeed.AllLikerDisplayManager.registerClass("SP.UI.MicroFeed.AllLikerDisplayManager");SP.UI.MicroFeed.MicrofeedEntry.registerClass("SP.UI.MicroFeed.MicrofeedEntry");SP.UI.MicroFeed.MicrofeedMenu.registerClass("SP.UI.MicroFeed.MicrofeedMenu",SP.UI.MySiteCommon.MySiteMenu);SP.UI.MicroFeed.MicroFeedDoc.registerClass("SP.UI.MicroFeed.MicroFeedDoc");SP.UI.MicroFeed.MicroFeedVideo.registerClass("SP.UI.MicroFeed.MicroFeedVideo");SP.UI.MicroFeed.SuggestionQueryManager.registerClass("SP.UI.MicroFeed.SuggestionQueryManager");SP.UI.MicroFeed.AllUsersSuggestionManager.registerClass("SP.UI.MicroFeed.AllUsersSuggestionManager",SP.UI.MicroFeed.SuggestionQueryManager);function sp_ui_microfeed_initialize(){SP.UI.MicroFeed.AtMention.$7X=new RegExp("\x0d\x0a","g");SP.UI.MicroFeed.BaseAtMention.$2h=10;SP.UI.MicroFeed.BaseAtMention.$1M=null;SP.UI.MicroFeed.BaseAtMention.$40=null;SP.UI.MicroFeed.BaseAtMention.$5d="_mentionselectordiv";SP.UI.MicroFeed.BaseAtMention.$1q="ms-mentioncontainerdiv";SP.UI.MicroFeed.BaseAtMention.$W="_atmentiondiv_";SP.UI.MicroFeed.BaseAtMention.$5D="ms-microfeed-LoadingFollowedUsersImage";SP.UI.MicroFeed.BaseAtMention.$49="ms-microfeed-typeAheadElementSelected";SP.UI.MicroFeed.BaseAtMention.$2F="ms-microfeed-typeAheadElementName";SP.UI.MicroFeed.BaseAtMention.$2D="DisplayName";SP.UI.MicroFeed.BaseAtMention.$4E="alias";SP.UI.MicroFeed.BaseAtMention.$1h="TextBoxID";SP.UI.MicroFeed.BaseAtMention.emptyGuid="00000000-0000-0000-0000-000000000000";SP.UI.MicroFeed.BaseAtMention.hashTagsTermSetId="3CEB0050-69A1-40E7-A427-83E2FAC80C27";SP.UI.MicroFeed.BaseAtMention.tagSuggestions=null;SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv=null;SP.UI.MicroFeed.BaseAtMention.disallowedHashTagCharsRegex=new RegExp("[\\u0000-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007F]");SP.UI.MicroFeed.SocialActorCache.$1D=null;SP.UI.MicroFeed.MicrofeedThreadCache.$1D=null;SP.UI.MicroFeed.SPMicroFeed.microfeed=null;SP.UI.MicroFeed.SPMicroFeed.maxResolvedMentions=6;SP.UI.MicroFeed.SPMicroFeed.maxResolvedTags=6;SP.UI.MicroFeed.SPMicroFeed.characterLimit=1e4;SP.UI.MicroFeed.SPMicroFeed.$P=null;SP.UI.MicroFeed.SPMicroFeed.$23=0;SP.UI.MicroFeed.SPMicroFeed.$N=null;SP.UI.MicroFeed.SPMicroFeed.$V=null;SP.UI.MicroFeed.SPMicroFeed.$12=false;SP.UI.MicroFeed.SPMicroFeed.$1f=false;SP.UI.MicroFeed.SPMicroFeed.$46=false;SP.UI.MicroFeed.SPMicroFeed.$2p=false;SP.UI.MicroFeed.SPMicroFeed.$1e=false;SP.UI.MicroFeed.SPMicroFeed.$1d=false;SP.UI.MicroFeed.SPMicroFeed.$41=null;SP.UI.MicroFeed.SPMicroFeed.$5b=false;SP.UI.MicroFeed.SPMicroFeed.$5a=false;SP.UI.MicroFeed.SPMicroFeed.$27=null;SP.UI.MicroFeed.SPMicroFeed.$1N=20;SP.UI.MicroFeed.SPMicroFeed.$7r=20;SP.UI.MicroFeed.SPMicroFeed.$c=false;SP.UI.MicroFeed.SPMicroFeed.$1g=null;SP.UI.MicroFeed.SPMicroFeed.$J=null;SP.UI.MicroFeed.SPMicroFeed.$q=null;SP.UI.MicroFeed.SPMicroFeed.$42=null;SP.UI.MicroFeed.SPMicroFeed.$43=null;SP.UI.MicroFeed.SPMicroFeed.$45=false;SP.UI.MicroFeed.SPMicroFeed.$44=0;SP.UI.MicroFeed.SPMicroFeed.$14=browseris.ie8down||browseris.ie8standard;SP.UI.MicroFeed.SPMicroFeed.$25=null;SP.UI.MicroFeed.SPMicroFeed.$2o=null;SP.UI.MicroFeed.SPMicroFeed.$15="MyThreadLikeCount";SP.UI.MicroFeed.SPMicroFeed.$e="attachId";SP.UI.MicroFeed.SPMicroFeed.$1R="hasLinks";SP.UI.MicroFeed.SPMicroFeed.$2V="hasHover";SP.UI.MicroFeed.SPMicroFeed.$2U="hasFocus";SP.UI.MicroFeed.SPMicroFeed.$16="updatingLinkId";SP.UI.MicroFeed.SPMicroFeed.$3Z="AttachmentImageButton";SP.UI.MicroFeed.SPMicroFeed.$3C="AttachmentFileButton";SP.UI.MicroFeed.SPMicroFeed.$4j="FollowButtonFor";SP.UI.MicroFeed.SPMicroFeed.$32="displayInMyLikesView";SP.UI.MicroFeed.SPMicroFeed.targetAttribute="targetDisplayName";SP.UI.MicroFeed.SPMicroFeed.$22="ms-microfeeddiv";SP.UI.MicroFeed.SPMicroFeed.$7n="ms-microfeed-fullMicrofeedDiv";SP.UI.MicroFeed.SPMicroFeed.$O="ms-microfeed-button";SP.UI.MicroFeed.SPMicroFeed.$7m="ms-microfeed-deleteButton";SP.UI.MicroFeed.SPMicroFeed.$3y="ms-microfeed-deleteButtonImageParent";SP.UI.MicroFeed.SPMicroFeed.$3x="ms-microfeed-deleteButtonImage";SP.UI.MicroFeed.SPMicroFeed.$5X="ms-microfeed-editLinkButton";SP.UI.MicroFeed.SPMicroFeed.$5W="ms-textSmall ms-secondaryCommandLink";SP.UI.MicroFeed.SPMicroFeed.$7p="ms-microfeed-linkSeparator ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$7o="ms-microfeed-rightAlignedDiv";SP.UI.MicroFeed.SPMicroFeed.$3z="ms-floatRight";SP.UI.MicroFeed.SPMicroFeed.$5Y="ms-microfeed-floatLeft";SP.UI.MicroFeed.SPMicroFeed.$5Z="ms-microfeed-greyout";SP.UI.MicroFeed.SPMicroFeed.$7f="ms-microblogdiv";SP.UI.MicroFeed.SPMicroFeed.$7e="ms-microfeed-microblogpart";SP.UI.MicroFeed.SPMicroFeed.$1L="ms-microbloginputbox";SP.UI.MicroFeed.SPMicroFeed.$5P="ms-microfeed-postBox ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$3u="ms-microbloginputboxmentionhighlightdiv";SP.UI.MicroFeed.SPMicroFeed.$7i="ms-microfeed-mentionHighlightDiv";SP.UI.MicroFeed.SPMicroFeed.$2l="ms-helperText";SP.UI.MicroFeed.SPMicroFeed.$5Q="ms-microfeed-defaultTextColor";SP.UI.MicroFeed.SPMicroFeed.$3w="ms-microfeed-rootOrReplyPostBox";SP.UI.MicroFeed.SPMicroFeed.$5T="ms-microblogInputFocus";SP.UI.MicroFeed.SPMicroFeed.$5R="ms-microfeed-focusBox";SP.UI.MicroFeed.SPMicroFeed.$2m="ms-microfeed-focusBoxNoFocus";SP.UI.MicroFeed.SPMicroFeed.$5S="ms-microfeed-focusBoxInFocus";SP.UI.MicroFeed.SPMicroFeed.$1z="ms-microfeed-editLinkDiv";SP.UI.MicroFeed.SPMicroFeed.$2n="ms-microfeed-newAttachment";SP.UI.MicroFeed.SPMicroFeed.$3q="ms-microfeed-attachmentPreviewImage";SP.UI.MicroFeed.SPMicroFeed.$2j="ms-microfeed-attachmentPreviewRich";SP.UI.MicroFeed.SPMicroFeed.$1c="ms-microfeed-attachmentImage_";SP.UI.MicroFeed.SPMicroFeed.$5K="ms-microfeed-attachmentThumbnail_";SP.UI.MicroFeed.SPMicroFeed.$21="ms-microfeed-editLinkTextBox";SP.UI.MicroFeed.SPMicroFeed.$3s="ms-microfeed-editLinkDisplayTextTextBox";SP.UI.MicroFeed.SPMicroFeed.$7g="ms-microfeed-editLinkDiv ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$5O="ms-microfeed-editLinkTextBox";SP.UI.MicroFeed.SPMicroFeed.$3r="ms-microfeed-editLinkButton";SP.UI.MicroFeed.SPMicroFeed.$7h="ms-microfeed-editUrlSpan";SP.UI.MicroFeed.SPMicroFeed.$7d="ms-microfeed-displayLinkAsSpan";SP.UI.MicroFeed.SPMicroFeed.$5N="ms-microfeed-displayLinkAsSpan";SP.UI.MicroFeed.SPMicroFeed.$20="ms-microfeed-editLinkErrorMessage";SP.UI.MicroFeed.SPMicroFeed.$3v="ms-microfeed-revertEditLinkDivLink";SP.UI.MicroFeed.SPMicroFeed.$3t="ms-microfeed-textBoxElements";SP.UI.MicroFeed.SPMicroFeed.$5V="ms-mbRightSpan";SP.UI.MicroFeed.SPMicroFeed.$7k="ms-microfeed-postButtonSpan";SP.UI.MicroFeed.SPMicroFeed.$7l="ms-microfeed-postReplyButtonSpan ms-floatRight";SP.UI.MicroFeed.SPMicroFeed.$b="ms-postbutton";SP.UI.MicroFeed.SPMicroFeed.$5U="ms-microfeed-postButton ms-button-emphasize ms-floatRight";SP.UI.MicroFeed.SPMicroFeed.$1K="ms-microblogcharacterlimitlabel";SP.UI.MicroFeed.SPMicroFeed.$5L="ms-microfeed-characterLimit";SP.UI.MicroFeed.SPMicroFeed.$5M="ms-error";SP.UI.MicroFeed.SPMicroFeed.$2k="ms-soften";SP.UI.MicroFeed.SPMicroFeed.$3n="ms-addImageButton";SP.UI.MicroFeed.SPMicroFeed.$3m="ms-addFileButton";SP.UI.MicroFeed.SPMicroFeed.$2i="ms-microfeed-attachmentButton";SP.UI.MicroFeed.SPMicroFeed.$5I="ms-microfeed-addImageButtonImage";SP.UI.MicroFeed.SPMicroFeed.$5J="ms-microfeed-addImageButtonImageParent";SP.UI.MicroFeed.SPMicroFeed.$5G="ms-microfeed-addFileButtonImage";SP.UI.MicroFeed.SPMicroFeed.$5H="ms-microfeed-addFileButtonImageParent";SP.UI.MicroFeed.SPMicroFeed.$3p="ms-microfeed-attachment_";SP.UI.MicroFeed.SPMicroFeed.$3o="ms-microfeed-attachmentDiv";SP.UI.MicroFeed.SPMicroFeed.$1l="ms-newsfeedpartdiv";SP.UI.MicroFeed.SPMicroFeed.$6o="ms-microfeed-feedPart";SP.UI.MicroFeed.SPMicroFeed.$77="ms-titlebardiv";SP.UI.MicroFeed.SPMicroFeed.$76="ms-microfeed-title";SP.UI.MicroFeed.SPMicroFeed.$3S="ms-currentFeedLabel";SP.UI.MicroFeed.SPMicroFeed.$4y="ms-microfeed-titleViewSelectorPivotParent";SP.UI.MicroFeed.SPMicroFeed.$78="ms-microfeed-titleViewSelectorPivotContainer";SP.UI.MicroFeed.SPMicroFeed.$79="ms-microfeed-titlePivotControl ms-textXLarge";SP.UI.MicroFeed.SPMicroFeed.$4r="ms-microfeed-privacyIcon";SP.UI.MicroFeed.SPMicroFeed.$3I="ms-progressSpan";SP.UI.MicroFeed.SPMicroFeed.$6s="ms-microfeed-processingDiv";SP.UI.MicroFeed.SPMicroFeed.$6u="ms-progressSpinner";SP.UI.MicroFeed.SPMicroFeed.$6t="ms-microfeed-processingImage";SP.UI.MicroFeed.SPMicroFeed.$3B="ms-microfeed-highlightedRefMention";SP.UI.MicroFeed.SPMicroFeed.$51="ms-viewDescription";SP.UI.MicroFeed.SPMicroFeed.$7B="ms-microfeed-viewDescription";SP.UI.MicroFeed.SPMicroFeed.$2I="ms-feeddiv";SP.UI.MicroFeed.SPMicroFeed.$1Q="ms-feedthreadsdiv";SP.UI.MicroFeed.SPMicroFeed.$1k="ms-showMoreThreadsButton";SP.UI.MicroFeed.SPMicroFeed.$4i="ms-showMoreThreadsButtonContainer";SP.UI.MicroFeed.SPMicroFeed.$6l="ms-microfeed-seeMoreThreadsDiv";SP.UI.MicroFeed.SPMicroFeed.$6m="ms-microfeed-seeMoreThreadsDivContainer";SP.UI.MicroFeed.SPMicroFeed.$2K="ms-blankfeeddiv";SP.UI.MicroFeed.SPMicroFeed.$6Z="ms-microfeed-emptyThreadDiv";SP.UI.MicroFeed.SPMicroFeed.$1B="ms-threaddiv_";SP.UI.MicroFeed.SPMicroFeed.$75="ms-microfeed-thread";SP.UI.MicroFeed.SPMicroFeed.$1p="ms-rootpostcontainerdiv_";SP.UI.MicroFeed.SPMicroFeed.$3R="ms-microfeed-rootDiv";SP.UI.MicroFeed.SPMicroFeed.$1A="ms-threadrepliesdiv_";SP.UI.MicroFeed.SPMicroFeed.$2M="ms-post_";SP.UI.MicroFeed.SPMicroFeed.$4m="ms-microfeed-message";SP.UI.MicroFeed.SPMicroFeed.$4p="ms-microfeed-messageError";SP.UI.MicroFeed.SPMicroFeed.$6w="ms-userActivityText_";SP.UI.MicroFeed.SPMicroFeed.$6v="ms-microfeed-activityText ms-metadata";SP.UI.MicroFeed.SPMicroFeed.$4n="ms-content_";SP.UI.MicroFeed.SPMicroFeed.$6q="ms-microfeed-indentedPost";SP.UI.MicroFeed.SPMicroFeed.$4P="ms-deletebutton_";SP.UI.MicroFeed.SPMicroFeed.$4t="ms-replyInputFocus_";SP.UI.MicroFeed.SPMicroFeed.$1m="ms-microfeed-editLinkDiv_";SP.UI.MicroFeed.SPMicroFeed.$2O="ms-microfeed-newAttachment_";SP.UI.MicroFeed.SPMicroFeed.$3L="ms-microfeed-attachmentPreviewImage_";SP.UI.MicroFeed.SPMicroFeed.$2P="ms-microfeed-attachmentPreviewRich_";SP.UI.MicroFeed.SPMicroFeed.$1o="ms-microfeed-editLinkTextBox_";SP.UI.MicroFeed.SPMicroFeed.$3N="ms-microfeed-editLinkDisplayTextTextBox_";SP.UI.MicroFeed.SPMicroFeed.$3M="ms-microfeed-editLinkButton_";SP.UI.MicroFeed.SPMicroFeed.$70="ms-microfeed-editUrlSpan_";SP.UI.MicroFeed.SPMicroFeed.$6z="ms-microfeed-displayLinkAsSpan_";SP.UI.MicroFeed.SPMicroFeed.$1n="ms-microfeed-editLinkErrorMessage_";SP.UI.MicroFeed.SPMicroFeed.$3K="ms-addImageButton_";SP.UI.MicroFeed.SPMicroFeed.$3J="ms-addFileButton_";SP.UI.MicroFeed.SPMicroFeed.$1P="ms-createreplydiv_";SP.UI.MicroFeed.SPMicroFeed.$3O="ms-replyinput_";SP.UI.MicroFeed.SPMicroFeed.$4s="ms-microfeed-postBox ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$3Q="ms-replyinputmentionhighlightdiv_";SP.UI.MicroFeed.SPMicroFeed.$71="ms-microfeed-replyMentionHighlightDiv";SP.UI.MicroFeed.SPMicroFeed.$3P="ms-microfeed-replyBoxIndentDiv";SP.UI.MicroFeed.SPMicroFeed.$6i="ms-footer_";SP.UI.MicroFeed.SPMicroFeed.$6h="ms-microfeed-messageFooter";SP.UI.MicroFeed.SPMicroFeed.$2L=SP.UI.MicroFeed.SPMicroFeed.$O+" "+SP.UI.MicroFeed.SPMicroFeed.$5W+" ms-microfeed-footerButton";SP.UI.MicroFeed.SPMicroFeed.$4b=SP.UI.MicroFeed.SPMicroFeed.$O+" ms-textSmall ms-subtleLink ms-microfeed-expandCollapseButtons";SP.UI.MicroFeed.SPMicroFeed.$4o="ms-microfeed-mysitemenu-control ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$2H="ms-userthumbnailarea_";SP.UI.MicroFeed.SPMicroFeed.$39="newreply_";SP.UI.MicroFeed.SPMicroFeed.$4T="ms-likebutton_";SP.UI.MicroFeed.SPMicroFeed.$6f="ms-lockedspan_";SP.UI.MicroFeed.SPMicroFeed.$6y="ms-replybutton_";SP.UI.MicroFeed.SPMicroFeed.$6a="ms-followbutton_";SP.UI.MicroFeed.SPMicroFeed.$19="ms-postreplybutton_";SP.UI.MicroFeed.SPMicroFeed.$6c="ms-hidedeleteinfodiv_";SP.UI.MicroFeed.SPMicroFeed.$4Q="ms-hiddenelementsdiv_";SP.UI.MicroFeed.SPMicroFeed.$6b="ms-microfeed-deleteDiv";SP.UI.MicroFeed.SPMicroFeed.$4q="ms-PostPreview_";SP.UI.MicroFeed.SPMicroFeed.$6r="ms-PostPreviewContainer_";SP.UI.MicroFeed.SPMicroFeed.$2N="ms-microfeed-replyArea";SP.UI.MicroFeed.SPMicroFeed.$4d="ms-seeMoreReplies_";SP.UI.MicroFeed.SPMicroFeed.$2Q="ms-microfeed-replyBackground";SP.UI.MicroFeed.SPMicroFeed.$4g="ms-microfeed-seeMoreRepliesDiv "+SP.UI.MicroFeed.SPMicroFeed.$2Q;SP.UI.MicroFeed.SPMicroFeed.$6k="ms-microfeed-seeFullThread ms-textSmall "+SP.UI.MicroFeed.SPMicroFeed.$2Q;SP.UI.MicroFeed.SPMicroFeed.$4f="ms-floatLeft ms-secondaryCommandLink ms-microfeed-seeMoreReplies";SP.UI.MicroFeed.SPMicroFeed.$4h="ms-microfeed-moreRepliesImageParent";SP.UI.MicroFeed.SPMicroFeed.$3F="ms-floatLeft ms-microfeed-moreRepliesImageDown";SP.UI.MicroFeed.SPMicroFeed.$4c="ms-floatLeft ms-microfeed-moreRepliesImageUp";SP.UI.MicroFeed.SPMicroFeed.$6j="ms-moreRepliesButton_";SP.UI.MicroFeed.SPMicroFeed.$3E="ms-moreRepliesImageParent_";SP.UI.MicroFeed.SPMicroFeed.$4e="ms-moreRepliesImage_";SP.UI.MicroFeed.SPMicroFeed.$2R="ms-toggleReplies_";SP.UI.MicroFeed.SPMicroFeed.$4z="ms-toggleRepliesButton_";SP.UI.MicroFeed.SPMicroFeed.$3T="ms-toggleRepliesImage_";SP.UI.MicroFeed.SPMicroFeed.$7A="ms-toggleRepliesImageParent_";SP.UI.MicroFeed.SPMicroFeed.$3U="ms-toggleRepliesText_";SP.UI.MicroFeed.SPMicroFeed.$6T="ms-activityImage_";SP.UI.MicroFeed.SPMicroFeed.$6Y="ms-text_";SP.UI.MicroFeed.SPMicroFeed.$6X="ms-microfeed-text";SP.UI.MicroFeed.SPMicroFeed.$4u="ms-likecount_";SP.UI.MicroFeed.SPMicroFeed.$4V="ms-likeimage_";SP.UI.MicroFeed.SPMicroFeed.$4Y="ms-likeimageparent_";SP.UI.MicroFeed.SPMicroFeed.$4X="ms-microfeed-likeImageParent";SP.UI.MicroFeed.SPMicroFeed.$4U="ms-microfeed-likeImage";SP.UI.MicroFeed.SPMicroFeed.$4W="ms-microfeed-likeImageLikedByMe";SP.UI.MicroFeed.SPMicroFeed.$4Z="ms-likeIndicatorSpanID_";SP.UI.MicroFeed.SPMicroFeed.$4S="ms-microfeed-LikerAnchor ms-bold ms-subtleLink";SP.UI.MicroFeed.SPMicroFeed.$4w="ms-replyLikeIndicatorOuterSpanID_";SP.UI.MicroFeed.SPMicroFeed.$73="ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$4a="ms-likesindicator_";SP.UI.MicroFeed.SPMicroFeed.$6d="ms-microfeed-likesIndicatorText ms-metadata ms-link";SP.UI.MicroFeed.SPMicroFeed.$6e="likersListSpan_";SP.UI.MicroFeed.SPMicroFeed.$72="ms-replyLikeCountImageSpanID_";SP.UI.MicroFeed.SPMicroFeed.$4v="ms-ReplyLikeCountImageLinkID_";SP.UI.MicroFeed.SPMicroFeed.$4x="ms-seeAllLikersAnchor_";SP.UI.MicroFeed.SPMicroFeed.$6p="ms-postBody_";SP.UI.MicroFeed.SPMicroFeed.$4l="ms-microfeed-postBody ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$4R="ms-iconimage_";SP.UI.MicroFeed.SPMicroFeed.$74="ms-microfeed-userThumbnailAreaRootPadding";SP.UI.MicroFeed.SPMicroFeed.$6x="ms-microfeed-userThumbnailAreaReplyPadding";SP.UI.MicroFeed.SPMicroFeed.$3D="ms-body_";SP.UI.MicroFeed.SPMicroFeed.$6g="ms-microfeed-messageBody";SP.UI.MicroFeed.SPMicroFeed.$50="ms-microfeed-unsubscribelink";SP.UI.MicroFeed.SPMicroFeed.$3V="ms-microfeed-unsubscribediv";SP.UI.MicroFeed.SPMicroFeed.$3A="ms-getThreadImage_";SP.UI.MicroFeed.SPMicroFeed.$3H="ms-microfeed-pendingImage";SP.UI.MicroFeed.SPMicroFeed.$7t="ms-PersonalSiteChangePhotoLink";SP.UI.MicroFeed.SPMicroFeed.$7u="ms-PersonalSiteConfigureSettingsLink";SP.UI.MicroFeed.SPMicroFeed.$7v="ms-PersonalSiteEditProfileLink";SP.UI.MicroFeed.SPMicroFeed.$7z=SP.UI.MySiteCommon.CommonUIElements.get_profileImagePlaceholder42();SP.UI.MicroFeed.SPMicroFeed.$7R=GetThemedImageUrl("placeholder32x32.png");SP.UI.MicroFeed.SPMicroFeed.$6n="mypeople.aspx";SP.UI.MicroFeed.SPMicroFeed.$8B="_layouts/15/MySite.aspx?MySiteRedirect=AllSites";SP.UI.MicroFeed.AllLikerDisplayManager.$7j="ms-microfeed-LikerCalloutDiv";SP.UI.MicroFeed.AllLikerDisplayManager.$6U="ms-allLiker-CalloutContentID_";SP.UI.MicroFeed.AllLikerDisplayManager.$6V="ms-allLiker-CalloutControlID_";SP.UI.MicroFeed.AllLikerDisplayManager.$6W="ms-allLiker-CalloutTitleID_";SP.UI.MicroFeed.AllLikerDisplayManager.$5j={};SP.UI.MicroFeed.MicrofeedEntry.minShortenedPostLength=500;SP.UI.MicroFeed.MicrofeedEntry.maxShortedPostLength=800;SP.UI.MicroFeed.MicroFeedDoc.$7b="ms-microfeed-attachmentDoc_";SP.UI.MicroFeed.MicroFeedVideo.$7c="ms-microfeed-attachmentVideo_"}sp_ui_microfeed_initialize();RegisterModuleInit("sp.ui,microfeed.js",sp_ui_microfeed_initialize);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("SP.UI.MicroFeed.js");_spApplicationPagesScriptLoaded=true;typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkEnd_SP.UI.MicroFeed.js");